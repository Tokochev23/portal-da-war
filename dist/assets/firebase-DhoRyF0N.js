const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/turnProcessor-nw6N7t0B.js","assets/consumerGoodsCalculator-BzhzLFUc.js"])))=>i.map(i=>d[i]);
import"https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js";import"https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js";import"https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js";import"https://www.gstatic.com/firebasejs/10.12.2/firebase-storage-compat.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function t(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(r){if(r.ep)return;r.ep=!0;const n=t(r);fetch(r.href,n)}})();class _{constructor(){this.createModalContainer()}createModalContainer(){if(document.getElementById("unified-modal-container"))return;const e=document.createElement("div");e.id="unified-modal-container",e.innerHTML=`
            <div id="message-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm hidden" role="dialog" aria-modal="true">
                <div class="w-full max-w-md rounded-2xl bg-bg-soft border border-bg-ring/70 p-6">
                    <h2 id="modal-title" class="text-xl font-bold text-slate-100 mb-4"></h2>
                    <p id="modal-text" class="text-sm text-slate-300 mb-6"></p>
                    <div class="flex gap-3 justify-end">
                        <button id="modal-cancel-btn" class="px-4 py-2 rounded-xl border border-bg-ring/70 text-slate-300 hover:bg-white/5 transition-all" aria-label="Cancelar">Cancelar</button>
                        <button id="modal-ok-btn" class="px-4 py-2 rounded-xl bg-brand-500 text-slate-950 font-semibold hover:bg-brand-400 transition-all" aria-label="Confirmar">OK</button>
                    </div>
                </div>
            </div>`,document.body.appendChild(e)}show(e,t,o=!1){const r=document.getElementById("message-modal"),n=document.getElementById("modal-title"),s=document.getElementById("modal-text"),i=document.getElementById("modal-cancel-btn"),g=document.getElementById("modal-ok-btn");return!r||!n||!s||!i||!g?(console.error("Elementos do modal n√£o encontrados"),Promise.resolve(!1)):(n.textContent=e,s.textContent=t,i.style.display=o?"block":"none",r.classList.remove("hidden"),g.focus(),new Promise(l=>{const p=()=>{r.classList.add("hidden"),g.onclick=null,i.onclick=null,document.removeEventListener("keydown",d)},d=m=>{m.key==="Escape"&&(p(),l(!1))};g.onclick=()=>{p(),l(!0)},i.onclick=()=>{p(),l(!1)},document.addEventListener("keydown",d)}))}}const j=new _;function ce(a,e){return j.show(a,e,!0)}class N{static formatCurrency(e,t="USD",o="pt-BR"){const r=this.parseNumber(e);return isNaN(r)?t==="USD"?"$0":"0":new Intl.NumberFormat(o,{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:0}).format(r)}static parseNumber(e){return typeof e=="number"?e:parseFloat(String(e).replace(/[^-0-9.,]/g,"").replace(",","."))}static formatNumber(e,t="pt-BR"){const o=this.parseNumber(e);return isNaN(o)?"0":new Intl.NumberFormat(t).format(o)}static formatPercent(e,t=1){const o=this.parseNumber(e);return isNaN(o)?"0%":`${o.toFixed(t)}%`}static formatCurrencyCompact(e,t="USD",o="pt-BR"){const r=this.parseNumber(e);return isNaN(r)?t==="USD"?"$0":"0":r<1e12?new Intl.NumberFormat(o,{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:0}).format(r):new Intl.NumberFormat(o,{style:"currency",currency:t,notation:"compact",compactDisplay:"short",minimumFractionDigits:0,maximumFractionDigits:1}).format(r)}}function le(a){return N.formatCurrency(a)}function ue(a){return N.formatCurrencyCompact(a)}class E{static isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}static isStrongPassword(e){const o=/[A-Z]/.test(e),r=/[a-z]/.test(e),n=/\d/.test(e);return e.length>=8&&o&&r&&n}static sanitizeInput(e,t={}){const{allowHTML:o=!1,maxLength:r=null}=t;let n=String(e).trim();return o||(n=n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")),r&&n.length>r&&(n=n.substring(0,r)),n}static validateNumber(e,t=null,o=null){const r=N.parseNumber(e);return isNaN(r)?{valid:!1,error:"Valor deve ser um n√∫mero"}:t!==null&&r<t?{valid:!1,error:`Valor deve ser maior que ${t}`}:o!==null&&r>o?{valid:!1,error:`Valor deve ser menor que ${o}`}:{valid:!0,value:r}}}class U{constructor(){this.cache=new Map,this.timestamps=new Map}set(e,t,o=3e5){this.cache.set(e,t),this.timestamps.set(e,Date.now()+o)}get(e){const t=this.timestamps.get(e);return!t||Date.now()>t?(this.cache.delete(e),this.timestamps.delete(e),null):this.cache.get(e)}has(e){return this.get(e)!==null}clear(){this.cache.clear(),this.timestamps.clear()}async getOrFetch(e,t,o=3e5){let r=this.get(e);if(r===null)try{r=await t(),this.set(e,r,o)}catch(n){throw console.error(`Erro ao buscar dados para cache ${e}:`,n),n}return r}}class c{static levels={ERROR:0,WARN:1,INFO:2,DEBUG:3};static currentLevel=this.levels.INFO;static log(e,t,...o){if(e>this.currentLevel)return;const r=new Date().toISOString(),s=["ERROR","WARN","INFO","DEBUG"][e],i={timestamp:r,level:s,message:t,data:o};console.log(`${["üî¥","üü°","üîµ","üü£"][e]} [${r}] ${s}: ${t}`,...o);try{const l=JSON.parse(localStorage.getItem("war1954_logs")||"[]");l.push(i),l.length>100&&l.splice(0,50),localStorage.setItem("war1954_logs",JSON.stringify(l))}catch(l){console.error("Failed to store log:",l)}}static error(e,...t){this.log(this.levels.ERROR,e,...t)}static warn(e,...t){this.log(this.levels.WARN,e,...t)}static info(e,...t){this.log(this.levels.INFO,e,...t)}static debug(e,...t){this.log(this.levels.DEBUG,e,...t)}static getLogs(){try{return JSON.parse(localStorage.getItem("war1954_logs")||"[]")}catch{return[]}}static clearLogs(){localStorage.removeItem("war1954_logs")}}const w=new U;class D{static animateCounter(e,t,o={}){const{duration:r=1e3,locale:n="pt-BR",onComplete:s=null,easing:i="easeOutQuart"}=o,g=typeof e=="string"?document.getElementById(e):e;if(!g){console.warn(`Elemento n√£o encontrado: ${e}`);return}const l=parseInt(g.textContent.replace(/,/g,""))||0,p=t-l;if(p===0){s?.();return}const d=Date.now(),m={linear:u=>u,easeOutQuart:u=>1-Math.pow(1-u,4),easeInOutCubic:u=>u<.5?4*u*u*u:(u-1)*(2*u-2)*(2*u-2)+1},v=m[i]||m.easeOutQuart,y=()=>{const u=Date.now()-d,L=Math.min(u/r,1),O=v(L),M=l+p*O;g.textContent=Math.round(M).toLocaleString(n),L<1?requestAnimationFrame(y):(g.textContent=Math.round(t).toLocaleString(n),s?.())};requestAnimationFrame(y)}static debounce(e,t,o=!1){let r;return function(...s){const i=()=>{r=null,o||e.apply(this,s)},g=o&&!r;clearTimeout(r),r=setTimeout(i,t),g&&e.apply(this,s)}}static throttle(e,t){let o;return function(...r){o||(e.apply(this,r),o=!0,setTimeout(()=>o=!1,t))}}static lazyLoadImages(e="img[data-src]"){const t=document.querySelectorAll(e),o=new IntersectionObserver(r=>{r.forEach(n=>{if(n.isIntersecting){const s=n.target;s.src=s.dataset.src,s.classList.remove("lazy-load"),o.unobserve(s)}})});t.forEach(r=>o.observe(r))}}function de(a,e){D.animateCounter(a,e)}try{window.DOMUtils=D}catch{}class z{constructor(){this.notifications=new Set,this.maxNotifications=5}show(e,t,o={}){const{duration:r=4e3,closable:n=!0,position:s="top-right",persistent:i=!1}=o,g={success:"bg-emerald-500/10 border-emerald-500/20 text-emerald-400",error:"bg-red-500/10 border-red-500/20 text-red-400",warning:"bg-yellow-500/10 border-yellow-500/20 text-yellow-400",info:"bg-blue-500/10 border-blue-500/20 text-blue-400"},l={success:"‚úì",error:"‚úï",warning:"‚ö†",info:"‚Ñπ"},p={"top-right":"top-4 right-4","top-left":"top-4 left-4","bottom-right":"bottom-4 right-4","bottom-left":"bottom-4 left-4"},d=document.createElement("div");d.className=`fixed ${p[s]} z-50 px-4 py-3 rounded-xl border ${g[e]} animate-slide-up shadow-lg max-w-md`,d.setAttribute("role","alert"),d.setAttribute("aria-live","polite");const m=document.createElement("div");m.className="flex items-start gap-2";const v=document.createElement("span");v.className="text-lg flex-shrink-0",v.textContent=l[e]||l.info;const y=document.createElement("span");if(y.className="flex-1 text-sm",y.textContent=t,m.appendChild(v),m.appendChild(y),n){const u=document.createElement("button");u.className="ml-2 flex-shrink-0 opacity-70 hover:opacity-100 transition-opacity",u.innerHTML="‚úï",u.setAttribute("aria-label","Fechar notifica√ß√£o"),u.onclick=()=>this.remove(d),m.appendChild(u)}if(d.appendChild(m),this.notifications.size>=this.maxNotifications){const u=Array.from(this.notifications)[0];this.remove(u)}return this.notifications.add(d),document.body.appendChild(d),!i&&r>0&&setTimeout(()=>this.remove(d),r),d}remove(e){!e||!this.notifications.has(e)||(e.style.transform="translateX(100%)",e.style.opacity="0",e.style.transition="all 0.3s ease",setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e),this.notifications.delete(e)},300))}clear(){Array.from(this.notifications).forEach(e=>{this.remove(e)})}}const k=new z;function F(a,e,t){return k.show(a,e,t)}const q="modulepreload",V=function(a){return"/War1954-main/"+a},I={},G=function(e,t,o){let r=Promise.resolve();if(t&&t.length>0){let g=function(l){return Promise.all(l.map(p=>Promise.resolve(p).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),i=s?.nonce||s?.getAttribute("nonce");r=g(t.map(l=>{if(l=V(l),l in I)return;I[l]=!0;const p=l.endsWith(".css"),d=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const m=document.createElement("link");if(m.rel=p?"stylesheet":q,p||(m.as="script"),m.crossOrigin="",m.href=l,i&&m.setAttribute("nonce",i),document.head.appendChild(m),p)return new Promise((v,y)=>{m.addEventListener("load",v),m.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${l}`)))})}))}function n(s){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=s,window.dispatchEvent(i),!i.defaultPrevented)throw s}return r.then(s=>{for(const i of s||[])i.status==="rejected"&&n(i.reason);return e().catch(n)})},x={apiKey:window.FIREBASE_API_KEY||"AIzaSyBd-cQsmXqgU9wVDtxYdaeLFQIfIUxv6GE",authDomain:window.FIREBASE_AUTH_DOMAIN||"war-1954-1799c.firebaseapp.com",projectId:window.FIREBASE_PROJECT_ID||"war-1954-1799c",storageBucket:window.FIREBASE_STORAGE_BUCKET||"war-1954-1799c.firebasestorage.app",messagingSenderId:window.FIREBASE_MESSAGING_SENDER_ID||"147967902110",appId:window.FIREBASE_APP_ID||"1:147967902110:web:2e2a54b98ef9474d7a968f",measurementId:window.FIREBASE_MEASUREMENT_ID||"G-LQNDE985RB",databaseURL:window.FIREBASE_DATABASE_URL||void 0};function K(a){const e=["apiKey","authDomain","projectId"];for(const t of e)if(!a[t])throw new Error(`Configura√ß√£o Firebase inv√°lida: ${t} √© obrigat√≥rio`);return a}if(!x.databaseURL&&x.projectId)try{const a=x.projectId;x.databaseURL=`https://${a}-default-rtdb.firebaseio.com/`}catch{}const W=K(x),R={maxLoginAttempts:3,rateLimiting:{windowMs:900*1e3}};let T,P,f,$,h,S=new Map;class b{static getErrorMessage(e){const t={"auth/user-not-found":"Usu√°rio n√£o encontrado. Verifique o email.","auth/wrong-password":"Senha incorreta. Tente novamente.","auth/email-already-in-use":"Este email j√° est√° em uso.","auth/weak-password":"A senha √© muito fraca. Use pelo menos 6 caracteres.","auth/invalid-email":"Email inv√°lido. Verifique o formato.","auth/too-many-requests":"Muitas tentativas. Tente novamente mais tarde.","auth/network-request-failed":"Erro de conex√£o. Verifique sua internet.","permission-denied":"Acesso negado. Verifique suas permiss√µes.",unavailable:"Servi√ßo temporariamente indispon√≠vel.",cancelled:"Opera√ß√£o cancelada.","deadline-exceeded":"Tempo limite excedido. Tente novamente.","not-found":"Documento n√£o encontrado.","already-exists":"Documento j√° existe.","resource-exhausted":"Limite de requisi√ß√µes excedido.","failed-precondition":"Condi√ß√£o pr√©via falhou.",aborted:"Opera√ß√£o abortada.","out-of-range":"Valor fora do intervalo permitido.",unimplemented:"Funcionalidade n√£o implementada.",internal:"Erro interno do servidor.","data-loss":"Perda de dados detectada."},o=e.code||e.message;return t[o]||`Erro: ${e.message||"Erro desconhecido"}`}static handleError(e,t="opera√ß√£o"){const o=this.getErrorMessage(e);return c.error(`Firebase ${t} failed:`,e),F("error",o,{duration:6e3}),{success:!1,error:e,message:o}}}function A(a){const e=Date.now(),o=(S.get(a)||[]).filter(r=>e-r<R.rateLimiting.windowMs);if(o.length>=R.maxLoginAttempts)throw new Error("too-many-requests");o.push(e),S.set(a,o)}try{h=window.firebase,T=h.initializeApp(W),P=h.auth(),f=h.firestore(),$=h.storage(),f.enablePersistence({synchronizeTabs:!0}).catch(a=>c.warn("N√£o foi poss√≠vel habilitar persist√™ncia:",a)),c.info("Firebase inicializado com sucesso")}catch(a){c.error("Erro cr√≠tico ao inicializar Firebase:",a),F("error","Erro cr√≠tico: N√£o foi poss√≠vel conectar ao servidor. Recarregue a p√°gina.",{persistent:!0})}const C=new h.auth.GoogleAuthProvider;C.addScope("profile");C.addScope("email");async function H(a,e,t){try{if(!E.isValidEmail(a))throw new Error("invalid-email");if(!E.isStrongPassword(e))throw new Error("weak-password");const o=E.sanitizeInput(t,{maxLength:100});if(!o||o.length<2)throw new Error("Nome deve ter pelo menos 2 caracteres");A(a.toLowerCase());const n=(await P.createUserWithEmailAndPassword(a.toLowerCase(),e)).user;return await n.updateProfile({displayName:o}),await f.collection("usuarios").doc(n.uid).set({nome:o,email:a.toLowerCase(),papel:"jogador",dataIngresso:h.firestore.Timestamp.now(),ultimoLogin:h.firestore.Timestamp.now(),ativo:!0,versaoTermos:"1.0",configuracoes:{notificacoes:!0,tema:"dark"}}),c.info("Registro realizado com sucesso",{uid:n.uid,email:n.email}),{success:!0,user:n}}catch(o){return b.handleError(o,"registro")}}async function J(a,e){try{if(!E.isValidEmail(a))throw new Error("invalid-email");if(!e||e.length<6)throw new Error("wrong-password");A(a.toLowerCase());const t=await P.signInWithEmailAndPassword(a.toLowerCase(),e);try{await f.collection("usuarios").doc(t.user.uid).update({ultimoLogin:h.firestore.Timestamp.now()})}catch(o){c.warn("N√£o foi poss√≠vel atualizar √∫ltimo login:",o)}return c.info("Login realizado com sucesso",{uid:t.user.uid,email:t.user.email}),{success:!0,user:t.user}}catch(t){return b.handleError(t,"login")}}async function B(a,e=!0){if(!a)return c.warn("checkUserPermissions: userId √© obrigat√≥rio"),{isNarrator:!1,isAdmin:!1,isPlayer:!0};const t=`permissions-${a}`;try{if(e){const n=w.get(t);if(n)return c.debug(`Permiss√µes do usu√°rio ${a} carregadas do cache`),n}const o=await f.collection("usuarios").doc(a).get();let r={isNarrator:!1,isAdmin:!1,isPlayer:!0,role:"jogador"};if(o.exists){const n=o.data(),s=n.papel||"jogador";r={isNarrator:s==="narrador"||s==="admin",isAdmin:s==="admin",isPlayer:s==="jogador"||s==="narrador"||s==="admin",role:s,ativo:n.ativo!==!1}}return w.set(t,r,6e5),c.debug(`Permiss√µes verificadas para ${a}:`,r),r}catch(o){return c.error("Erro ao verificar permiss√µes:",o),{isNarrator:!1,isAdmin:!1,isPlayer:!0,role:"jogador"}}}async function Q(a,e=!0){if(!a)return c.warn("checkPlayerCountry: userId √© obrigat√≥rio"),null;const t=`player-country-${a}`;try{if(e){const n=w.get(t);if(n!==null)return c.debug(`Pa√≠s do jogador ${a} carregado do cache: ${n}`),n}const o=await f.collection("usuarios").doc(a).get();let r=null;return o.exists&&(r=o.data().paisId||null),w.set(t,r,3e5),c.debug(`Pa√≠s do jogador ${a}: ${r||"nenhum"}`),r}catch(o){return c.error("Erro ao verificar pa√≠s do jogador:",o),null}}async function Y(a=!0){const e="all-countries";try{if(a){const n=w.get(e);if(n)return c.debug("Pa√≠ses carregados do cache"),n}const o=await f.collection("paises").get();if(o.empty)return c.warn("Nenhum pa√≠s encontrado na cole√ß√£o"),[];const r=o.docs.map(n=>{const s=n.data(),i={id:n.id,...s,Pais:E.sanitizeInput(s.Pais||"",{maxLength:100}),PIB:Math.max(0,N.parseNumber(s.PIB)||0)};if(i.Carvao===void 0&&(i.Carvao=0),i.PotencialCarvao===void 0)switch(i.Pais){case"Alemanha":i.PotencialCarvao=10;break;case"Reino Unido":i.PotencialCarvao=9;break;case"Brasil":i.PotencialCarvao=4;break;default:i.PotencialCarvao=5}return i.power_plants===void 0&&(i.power_plants=[]),i.PotencialHidreletrico===void 0&&(i.PotencialHidreletrico=5),i});return w.set(e,r,3e5),c.info(`${r.length} pa√≠ses carregados com sucesso`),r}catch(t){return b.handleError(t,"carregamento de pa√≠ses"),[]}}async function X(a,e=!0){if(!a)return c.warn("getCountryData: paisId √© obrigat√≥rio"),null;const t=`country-${a}`;try{if(e){const s=w.get(t);if(s)return c.debug(`Dados do pa√≠s ${a} carregados do cache`),s}const o=await f.collection("paises").doc(a).get();if(!o.exists)return c.warn(`Pa√≠s ${a} n√£o encontrado`),null;const r=o.data(),n={...r,Pais:E.sanitizeInput(r.Pais||"",{maxLength:100}),PIB:Math.max(0,N.parseNumber(r.PIB)||0),Estabilidade:Math.max(0,Math.min(100,N.parseNumber(r.Estabilidade)||0))};return w.set(t,n,18e4),c.debug(`Dados do pa√≠s ${a} carregados com sucesso`),n}catch(o){return b.handleError(o,`carregamento do pa√≠s ${a}`),null}}async function Z(a=!0){const e="game-config";try{if(a){const r=w.get(e);if(r)return c.debug("Configura√ß√£o do jogo carregada do cache"),r}const t=await f.collection("configuracoes").doc("jogo").get();let o=null;return t.exists&&(o=t.data(),o.turnoAtual!==void 0&&(o.turnoAtual=Math.max(0,parseInt(o.turnoAtual)||0))),w.set(e,o,12e4),c.debug("Configura√ß√£o do jogo carregada:",o),o}catch(t){return c.error("Erro ao carregar configura√ß√£o do jogo:",t),null}}async function ee(){try{const a=await f.collection("configuracoes").doc("regrasDinamicas").get();return a.exists?(c.debug("Regras din√¢micas carregadas do Firestore"),a.data()):(c.debug("Nenhum documento de regras din√¢micas encontrado, usando objeto vazio."),{})}catch(a){return b.handleError(a,"carregamento de regras din√¢micas"),{}}}async function te(a,e=null){try{const t=parseInt(a);if(isNaN(t)||t<0)throw new Error("N√∫mero do turno inv√°lido");if(e){const r=await B(e,!1);if(!r.isNarrator&&!r.isAdmin)throw new Error("Acesso negado: apenas narradores podem atualizar turnos")}const o={turnoAtual:t,ultimaAtualizacao:h.firestore.Timestamp.now()};e&&(o.ultimoEditor=e),await f.collection("configuracoes").doc("jogo").set(o,{merge:!0});try{const{default:r}=await G(async()=>{const{default:s}=await import("./turnProcessor-nw6N7t0B.js");return{default:s}},__vite__mapDeps([0,1]));if(await r.isTurnProcessed(t))c.info(`Turno ${t} j√° foi processado anteriormente`);else{c.info(`Iniciando processamento autom√°tico do turno ${t}`);const s=await r.processTurnEnd(t);c.info(`Processamento do turno ${t} conclu√≠do`,s)}}catch(r){c.error("Erro no processamento autom√°tico do turno:",r),console.warn("‚ö†Ô∏è Erro no processamento autom√°tico, mas turno foi atualizado")}return w.clear(),c.info(`Turno atualizado para #${t}`,{userId:e,newTurn:t}),{success:!0,turno:t}}catch(t){return b.handleError(t,"atualiza√ß√£o de turno")}}async function re(){try{A("google-login");const e=(await P.signInWithPopup(C)).user;if(!e.email||!E.isValidEmail(e.email))throw new Error("Email inv√°lido recebido do Google");const t=f.collection("usuarios").doc(e.uid),o=await t.get(),r={nome:E.sanitizeInput(e.displayName||"Usu√°rio",{maxLength:100}),email:e.email.toLowerCase(),photoURL:e.photoURL||null,ultimoLogin:h.firestore.Timestamp.now(),ativo:!0,versaoTermos:"1.0"};return o.exists?(o.data()||{}).papel||(r.papel="jogador"):(r.dataIngresso=h.firestore.Timestamp.now(),r.papel="jogador"),await t.set(r,{merge:!0}),c.info("Login Google (preservando papel) realizado com sucesso",{uid:e.uid,email:e.email}),{success:!0,user:e}}catch(a){return b.handleError(a,"login com Google (preservar papel)")}}async function oe(a,e){if(!a||!e){const t=new Error("userId e paisId s√£o obrigat√≥rios");return b.handleError(t,"vincula√ß√£o jogador-pa√≠s (preservar papel)")}try{const t=await f.collection("paises").doc(e).get();if(!t.exists)throw new Error("Pa√≠s n√£o encontrado");if(t.data().Player)throw new Error("Pa√≠s j√° possui um jogador");return await f.runTransaction(async r=>{r.update(f.collection("paises").doc(e),{Player:a,DataVinculacao:h.firestore.Timestamp.now()}),r.set(f.collection("usuarios").doc(a),{paisId:e,ultimaAtualizacao:h.firestore.Timestamp.now(),ativo:!0},{merge:!0})}),w.clear(),c.info("Jogador vinculado ao pa√≠s (preservando papel) com sucesso",{userId:a,paisId:e}),{success:!0}}catch(t){return b.handleError(t,"vincula√ß√£o jogador-pa√≠s (preservar papel)")}}const me=Object.freeze(Object.defineProperty({__proto__:null,get app(){return T},get auth(){return P},checkPlayerCountry:Q,checkUserPermissions:B,get db(){return f},getAllCountries:Y,getCountryData:X,getCustomRules:ee,getGameConfig:Z,googleProvider:C,registerWithEmailPassword:H,signInWithEmailPassword:J,signInWithGooglePreserveRole:re,get storage(){return $},updateTurn:te,vincularJogadorAoPaisSemRebaixar:oe},Symbol.toStringTag,{value:"Module"}));export{c as L,E as V,G as _,P as a,F as b,J as c,B as d,Z as e,Q as f,Y as g,f as h,X as i,le as j,ue as k,de as l,ce as m,ee as n,me as o,H as r,re as s,te as u,oe as v};
