import{n as p,b as d,h as b}from"./firebase-EZ41UaXc.js";import{C as u}from"./consumerGoodsCalculator-LctIpTpp.js";import"./preload-helper-DnKmFyg5.js";import"https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js";import"https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js";import"https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js";import"https://www.gstatic.com/firebasejs/10.12.2/firebase-storage-compat.js";async function D(){try{if(!await p("Aplicar Efeitos de Bens de Consumo","Esta a√ß√£o ir√° calcular os bens de consumo para todos os pa√≠ses e aplicar os efeitos de estabilidade (+3% at√© -5%). Esta opera√ß√£o pode ser executada a cada turno. Continuar?","Sim, aplicar efeitos","Cancelar")){d("info","Opera√ß√£o cancelada pelo usu√°rio.");return}d("info","Iniciando c√°lculo de bens de consumo..."),console.log("=== CALCULANDO BENS DE CONSUMO E EFEITOS DE ESTABILIDADE ===");const c=await b.collection("paises").get(),l=b.batch(),r=[];let t=0;c.forEach(a=>{const n=a.data(),i=n.Pais||n.Nome||a.id;try{const e=u.calculateConsumerGoods(n),o=u.applyStabilityEffect(n),f=u.generateConsumerGoodsReport(n),E={BensDeConsumo:e.level,Estabilidade:o.newStability,BensDeConsumoCalculado:{timestamp:e.metadata.calculatedAt,production:e.production,demand:e.demand,satisfactionLevel:f.analysis.satisfactionLevel,stabilityEffect:o.stabilityEffect,effectDescription:o.effectDescription}};l.update(a.ref,E),t++,r.push({country:i,consumerGoods:e,stabilityEffect:o,report:f}),console.log(`${i}:`,{bens_de_consumo:`${e.level}%`,nivel_satisfacao:f.analysis.satisfactionLevel,estabilidade_anterior:o.currentStability,efeito_estabilidade:`${o.stabilityEffect>0?"+":""}${o.stabilityEffect}%`,nova_estabilidade:o.newStability,descricao:o.effectDescription,producao_vs_demanda:`${e.production}/${e.demand}`})}catch(e){console.error(`Erro ao calcular bens de consumo para ${i}:`,e)}}),t>0?(await l.commit(),d("success",`Bens de consumo calculados para ${t} pa√≠ses!`),y(r),console.log(`‚úÖ Bens de consumo aplicados com sucesso para ${t} pa√≠ses`)):d("warning","Nenhum pa√≠s foi processado.")}catch(s){console.error("Erro ao aplicar bens de consumo:",s),d("error",`Erro: ${s.message}`)}}function y(s){console.log(`
=== ESTAT√çSTICAS DE BENS DE CONSUMO ===`);const c=s.map(e=>({country:e.country,level:e.consumerGoods.level,stabilityEffect:e.stabilityEffect.stabilityEffect,satisfaction:e.report.analysis.satisfactionLevel})).sort((e,o)=>o.level-e.level);console.log(`
üèÜ TOP 10 MELHORES BENS DE CONSUMO:`),c.slice(0,10).forEach((e,o)=>{console.log(`${o+1}. ${e.country} - ${e.level}% (${e.satisfaction})`)}),console.log(`
üìâ TOP 10 PIORES BENS DE CONSUMO:`),c.slice(-10).reverse().forEach((e,o)=>{console.log(`${o+1}. ${e.country} - ${e.level}% (${e.satisfaction})`)});const l={};s.forEach(e=>{const o=e.report.analysis.satisfactionLevel;l[o]||(l[o]=[]),l[o].push(e)}),console.log(`
üìä PA√çSES POR N√çVEL DE SATISFA√á√ÉO:`),Object.entries(l).forEach(([e,o])=>{const f=Math.round(o.reduce((E,m)=>E+m.consumerGoods.level,0)/o.length);console.log(`${e}: ${o.length} pa√≠ses (m√©dia: ${f}%)`)});const r=s.filter(e=>e.stabilityEffect.stabilityEffect>0).sort((e,o)=>o.stabilityEffect.stabilityEffect-e.stabilityEffect.stabilityEffect),t=s.filter(e=>e.stabilityEffect.stabilityEffect<0).sort((e,o)=>e.stabilityEffect.stabilityEffect-o.stabilityEffect.stabilityEffect);r.length>0&&(console.log(`
‚úÖ PA√çSES COM GANHO DE ESTABILIDADE:`),r.slice(0,10).forEach(e=>{console.log(`${e.country}: +${e.stabilityEffect.stabilityEffect}% (${e.consumerGoods.level}% bens)`)})),t.length>0&&(console.log(`
‚ö†Ô∏è PA√çSES COM PERDA DE ESTABILIDADE:`),t.slice(0,10).forEach(e=>{console.log(`${e.country}: ${e.stabilityEffect.stabilityEffect}% (${e.consumerGoods.level}% bens)`)}));const a=Math.round(s.reduce((e,o)=>e+o.consumerGoods.level,0)/s.length),n=s.filter(e=>e.consumerGoods.level<15).length,i=s.filter(e=>e.consumerGoods.level>=85).length;console.log(`
üìà ESTAT√çSTICAS GERAIS:`),console.log(`N√≠vel m√©dio de bens de consumo: ${a}%`),console.log(`Pa√≠ses em crise (< 15%): ${n}`),console.log(`Pa√≠ses com excel√™ncia (‚â• 85%): ${i}`),console.log(`Efeito estabilidade m√©dio: ${Math.round(s.reduce((e,o)=>e+o.stabilityEffect.stabilityEffect,0)/s.length*100)/100}%`)}async function O(s=5){try{console.log(`
=== SIMULA√á√ÉO DE BENS DE CONSUMO - ${s} TURNOS ===`);const c=await b.collection("paises").get(),l=[];c.forEach(t=>{const a=t.data(),n=a.Pais||a.Nome||t.id;let i=parseFloat(a.Estabilidade)||50;const e={country:n,initialStability:i,turns:[]};for(let o=1;o<=s;o++){const f={...a,Estabilidade:i},E=u.calculateConsumerGoods(f),m=u.applyStabilityEffect(f);i=m.newStability,e.turns.push({turn:o,consumerGoods:E.level,stabilityEffect:m.stabilityEffect,newStability:i})}e.finalStability=i,e.totalChange=i-e.initialStability,l.push(e)});const r=l.sort((t,a)=>Math.abs(a.totalChange)-Math.abs(t.totalChange)).slice(0,10);console.log(`
üìä MAIORES MUDAN√áAS DE ESTABILIDADE EM ${s} TURNOS:`),r.forEach(t=>{const a=t.totalChange>0?`+${t.totalChange.toFixed(1)}`:t.totalChange.toFixed(1);console.log(`${t.country}: ${t.initialStability.toFixed(1)}% ‚Üí ${t.finalStability.toFixed(1)}% (${a}%)`)}),d("success",`Simula√ß√£o conclu√≠da: maiores mudan√ßas de ${Math.abs(r[0]?.totalChange||0).toFixed(1)}%`)}catch(c){console.error("Erro na simula√ß√£o:",c),d("error","Erro na simula√ß√£o: "+c.message)}}export{D as applyConsumerGoodsEffects,O as simulateConsumerGoodsOverTime};
