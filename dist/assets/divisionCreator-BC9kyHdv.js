const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/firebase-ep1w8F7T.js","assets/preload-helper-f85Crcwt.js","assets/utils-DLoRv3re.js"])))=>i.map(i=>d[i]);
import{_ as U}from"./preload-helper-f85Crcwt.js";import{t as y}from"./training_levels-0GuzqOdX.js";import{s as g,a as B}from"./utils-DLoRv3re.js";const w={irregulares:{id:"irregulares",name:"Irregulares",nameEn:"Irregulars",category:"infantry",subcategory:"light",composition:{manpower:1e3,equipment:{small_arms:1e3,light_mg:50}},costs:{production:3e5,maintenance:15e3},stats:{softAttack:15,hardAttack:1,defense:20,breakthrough:8,armor:0,piercing:1,hp:8,organization:50,recovery:.3,reconnaissance:3,suppression:8,weight:.1,combatWidth:2},requirements:{minTechLevel:0,requiredTech:[],incompatibleWith:[]},icon:"assets/division-icons/unit_militia_icon.png",color:"#78716c"},infantaria_linha:{id:"infantaria_linha",name:"Infantaria de Linha",nameEn:"Line Infantry",category:"infantry",subcategory:"standard",composition:{manpower:800,equipment:{small_arms:800,light_mg:80,mortars:12}},costs:{production:6e5,maintenance:3e4},stats:{softAttack:20,hardAttack:2,defense:25,breakthrough:12,armor:0,piercing:1,hp:10,organization:60,recovery:.4,reconnaissance:2,suppression:10,weight:.15,combatWidth:2},requirements:{minTechLevel:1},icon:"assets/division-icons/unit_infantry_icon.png",color:"#4a7c59"},infantaria_leve:{id:"infantaria_leve",name:"Infantaria Leve",nameEn:"Light Infantry",category:"infantry",subcategory:"light",composition:{manpower:800,equipment:{small_arms:800,light_mg:60,mortars:8}},costs:{production:6e5,maintenance:3e4},stats:{softAttack:18,hardAttack:1,defense:22,breakthrough:10,armor:0,piercing:1,hp:9,organization:65,recovery:.45,reconnaissance:4,suppression:8,weight:.12,combatWidth:2},requirements:{minTechLevel:1},icon:"assets/division-icons/unit_marine_commando_icon.png",color:"#6b8e23"},tropa_choque:{id:"tropa_choque",name:"Tropa de Choque",nameEn:"Shock Troops",category:"infantry",subcategory:"elite",composition:{manpower:800,equipment:{small_arms:800,light_mg:100,mortars:16,explosives:400}},costs:{production:8e5,maintenance:4e4},stats:{softAttack:28,hardAttack:4,defense:20,breakthrough:20,armor:0,piercing:2,hp:11,organization:55,recovery:.35,reconnaissance:2,suppression:15,weight:.18,combatWidth:2},requirements:{minTechLevel:2},icon:"assets/division-icons/unit_heavy_infantry_icon.png",color:"#dc2626"},montanhistas:{id:"montanhistas",name:"Montanhistas",nameEn:"Mountain Infantry",category:"infantry",subcategory:"special",composition:{manpower:800,equipment:{small_arms:800,light_mg:70,mortars:10,climbing_gear:800}},costs:{production:8e5,maintenance:4e4},stats:{softAttack:19,hardAttack:2,defense:28,breakthrough:10,armor:0,piercing:1,hp:10,organization:70,recovery:.4,reconnaissance:3,suppression:9,weight:.14,combatWidth:2},requirements:{minTechLevel:2},icon:"assets/division-icons/unit_mountain_icon.png",color:"#8b7355"},paraquedistas:{id:"paraquedistas",name:"Paraquedistas",nameEn:"Paratroopers",category:"infantry",subcategory:"special",composition:{manpower:800,equipment:{small_arms:800,light_mg:80,mortars:12,parachutes:800}},costs:{production:8e5,maintenance:4e4},stats:{softAttack:22,hardAttack:3,defense:23,breakthrough:14,armor:0,piercing:2,hp:10,organization:65,recovery:.42,reconnaissance:4,suppression:11,weight:.13,combatWidth:2},requirements:{minTechLevel:2},icon:"assets/division-icons/unit_paratroop_icon.png",color:"#1e40af"},fuzileiros_navais:{id:"fuzileiros_navais",name:"Fuzileiros Navais",nameEn:"Marines",category:"infantry",subcategory:"special",composition:{manpower:800,equipment:{small_arms:800,light_mg:85,mortars:14,amphibious_gear:800}},costs:{production:8e5,maintenance:4e4},stats:{softAttack:24,hardAttack:3,defense:26,breakthrough:15,armor:0,piercing:2,hp:11,organization:68,recovery:.43,reconnaissance:3,suppression:12,weight:.16,combatWidth:2},requirements:{minTechLevel:2},icon:"assets/division-icons/unit_marine_icon.png",color:"#1e3a8a"},infantaria_motorizada:{id:"infantaria_motorizada",name:"Infantaria Motorizada",nameEn:"Motorized Infantry",category:"motorized",subcategory:"standard",composition:{manpower:800,equipment:{trucks:40,small_arms:800,light_mg:80,mortars:16}},costs:{production:1e6,maintenance:5e4},stats:{softAttack:25,hardAttack:2,defense:30,breakthrough:15,armor:0,piercing:1,hp:10,organization:60,recovery:.4,reconnaissance:2,suppression:12,weight:.8,combatWidth:2},requirements:{minTechLevel:2},icon:"assets/division-icons/unit_motorized_icon.png",color:"#92400e"},carro_armado_irregulares:{id:"carro_armado_irregulares",name:"Carro Armado (Irregulares)",nameEn:"Gun Truck (Irregulars)",category:"motorized",subcategory:"light",composition:{manpower:800,equipment:{utility_vehicles:120,small_arms:800,light_mg:120,heavy_mg:40}},costs:{production:8e5,maintenance:4e4},stats:{softAttack:28,hardAttack:3,defense:22,breakthrough:16,armor:2,piercing:3,hp:9,organization:55,recovery:.38,reconnaissance:4,suppression:14,weight:.6,combatWidth:2},requirements:{minTechLevel:1},icon:"assets/division-icons/unit_mot_militia_icon.png",color:"#78350f"},carro_armado:{id:"carro_armado",name:"Carro Armado",nameEn:"Gun Truck",category:"motorized",subcategory:"standard",composition:{manpower:800,equipment:{utility_vehicles:160,small_arms:800,light_mg:160,heavy_mg:60,autocannons:20}},costs:{production:1e6,maintenance:5e4},stats:{softAttack:32,hardAttack:5,defense:25,breakthrough:18,armor:3,piercing:4,hp:10,organization:58,recovery:.4,reconnaissance:5,suppression:16,weight:.7,combatWidth:2},requirements:{minTechLevel:2},icon:"assets/division-icons/unit_armored_car_icon.png",color:"#a16207"},mecanizada_leve_apc:{id:"mecanizada_leve_apc",name:"Infantaria Mecanizada Leve (APC)",nameEn:"Light Mechanized (APC)",category:"mechanized",subcategory:"apc",composition:{manpower:800,equipment:{apc:100,small_arms:800,light_mg:100}},costs:{production:2e6,maintenance:1e5},stats:{softAttack:30,hardAttack:4,defense:35,breakthrough:20,armor:10,piercing:5,hp:12,organization:65,recovery:.42,reconnaissance:3,suppression:14,weight:1.2,combatWidth:2},requirements:{minTechLevel:3},icon:"assets/division-icons/unit_apc_company_icon.png",color:"#15803d"},mecanizada_ifv:{id:"mecanizada_ifv",name:"Infantaria Mecanizada (IFV)",nameEn:"Mechanized Infantry (IFV)",category:"mechanized",subcategory:"ifv",composition:{manpower:800,equipment:{ifv:100,small_arms:800,autocannons:100,atgm:50}},costs:{production:3e6,maintenance:15e4},stats:{softAttack:38,hardAttack:12,defense:40,breakthrough:25,armor:15,piercing:20,hp:14,organization:68,recovery:.45,reconnaissance:4,suppression:16,weight:1.5,combatWidth:2},requirements:{minTechLevel:4},icon:"assets/division-icons/unit_mechanized_icon.png",color:"#166534"},tanque_leve:{id:"tanque_leve",name:"Tanque Leve",nameEn:"Light Tank",category:"armor",subcategory:"light",composition:{manpower:300,equipment:{light_tanks:60}},costs:{production:4e6,maintenance:2e5},stats:{softAttack:25,hardAttack:20,defense:30,breakthrough:35,armor:30,piercing:40,hp:12,organization:50,recovery:.35,reconnaissance:8,suppression:10,weight:2.5,combatWidth:2},requirements:{minTechLevel:3},icon:"assets/division-icons/unit_light_tank_icon.png",color:"#713f12"},tanque_medio:{id:"tanque_medio",name:"Tanque M√©dio",nameEn:"Medium Tank",category:"armor",subcategory:"medium",composition:{manpower:400,equipment:{medium_tanks:80}},costs:{production:16e5,maintenance:8e4},stats:{softAttack:30,hardAttack:35,defense:40,breakthrough:45,armor:60,piercing:70,hp:15,organization:55,recovery:.38,reconnaissance:6,suppression:12,weight:3.5,combatWidth:2},requirements:{minTechLevel:3},icon:"assets/division-icons/unit_medium_tank_icon.png",color:"#854d0e"},tanque_mbt:{id:"tanque_mbt",name:"Tanque (MBT)",nameEn:"Main Battle Tank",category:"armor",subcategory:"mbt",composition:{manpower:300,equipment:{mbt:60}},costs:{production:6e6,maintenance:3e5},stats:{softAttack:35,hardAttack:50,defense:50,breakthrough:60,armor:90,piercing:100,hp:18,organization:58,recovery:.4,reconnaissance:7,suppression:15,weight:4.5,combatWidth:2},requirements:{minTechLevel:4},icon:"assets/division-icons/unit_mbt_company_icon.png",color:"#a16207"},tanque_anfibio:{id:"tanque_anfibio",name:"Tanque Anf√≠bio",nameEn:"Amphibious Tank",category:"armor",subcategory:"amphibious",composition:{manpower:400,equipment:{amphibious_tanks:60}},costs:{production:4e6,maintenance:2e5},stats:{softAttack:28,hardAttack:25,defense:35,breakthrough:38,armor:40,piercing:50,hp:14,organization:52,recovery:.37,reconnaissance:7,suppression:11,weight:3,combatWidth:2},requirements:{minTechLevel:3},icon:"assets/division-icons/unit_amphibious_tank_icon.png",color:"#0c4a6e"},bateria_antiaerea:{id:"bateria_antiaerea",name:"Bateria Antia√©rea",nameEn:"Anti-Aircraft Battery",category:"artillery",subcategory:"aa",composition:{manpower:400,equipment:{aa_guns:24,trucks:24}},costs:{production:1e6,maintenance:5e4},stats:{softAttack:5,hardAttack:2,defense:15,breakthrough:5,armor:0,piercing:10,hp:8,organization:45,recovery:.3,reconnaissance:1,suppression:5,weight:.6,combatWidth:1},requirements:{minTechLevel:2},icon:"assets/division-icons/unit_anti_air_icon.png",color:"#713f12"},bateria_artilharia:{id:"bateria_artilharia",name:"Bateria de Artilharia",nameEn:"Artillery Battery",category:"artillery",subcategory:"howitzer",composition:{manpower:400,equipment:{artillery:24,trucks:24}},costs:{production:1e6,maintenance:5e4},stats:{softAttack:40,hardAttack:8,defense:12,breakthrough:6,armor:0,piercing:5,hp:8,organization:40,recovery:.3,reconnaissance:1,suppression:8,weight:.8,combatWidth:1},requirements:{minTechLevel:2},icon:"assets/division-icons/unit_art_icon.png",color:"#92400e"},lancador_foguete:{id:"lancador_foguete",name:"Lan√ßador de Foguete",nameEn:"Rocket Launcher",category:"artillery",subcategory:"rocket",composition:{manpower:400,equipment:{rocket_launchers:24,trucks:24}},costs:{production:2e6,maintenance:1e5},stats:{softAttack:50,hardAttack:10,defense:10,breakthrough:8,armor:0,piercing:6,hp:7,organization:38,recovery:.28,reconnaissance:1,suppression:10,weight:.9,combatWidth:1},requirements:{minTechLevel:3},icon:"assets/division-icons/unit_rocket_art_icon.png",color:"#b45309"},grupo_atcms:{id:"grupo_atcms",name:"Grupo de Armas (ATCMS)",nameEn:"ATGM Group",category:"artillery",subcategory:"atgm",composition:{manpower:400,equipment:{atcms:36,trucks:18}},costs:{production:2e6,maintenance:1e5},stats:{softAttack:15,hardAttack:35,defense:18,breakthrough:10,armor:0,piercing:60,hp:8,organization:42,recovery:.32,reconnaissance:2,suppression:6,weight:.7,combatWidth:1},requirements:{minTechLevel:4},icon:"assets/division-icons/unit_at_icon.png",color:"#dc2626"},grupo_manpad:{id:"grupo_manpad",name:"Grupo MANPAD",nameEn:"MANPAD Group",category:"artillery",subcategory:"manpad",composition:{manpower:400,equipment:{manpads:36,trucks:12}},costs:{production:22e5,maintenance:11e4},stats:{softAttack:8,hardAttack:3,defense:16,breakthrough:6,armor:0,piercing:12,hp:7,organization:43,recovery:.31,reconnaissance:2,suppression:5,weight:.5,combatWidth:1},requirements:{minTechLevel:4},icon:"assets/division-icons/unit_mot_anti_air_icon.png",color:"#ef4444"},mlrs:{id:"mlrs",name:"MLRS",nameEn:"Multiple Rocket Launch System",category:"artillery",subcategory:"mlrs",composition:{manpower:400,equipment:{mlrs:32}},costs:{production:1e7,maintenance:5e5},stats:{softAttack:80,hardAttack:15,defense:8,breakthrough:10,armor:5,piercing:10,hp:10,organization:35,recovery:.25,reconnaissance:1,suppression:15,weight:2,combatWidth:2},requirements:{minTechLevel:5},icon:"assets/division-icons/unit_mlrs_icon.png",color:"#991b1b"},spg:{id:"spg",name:"Artilharia Autopropulsada (SPG)",nameEn:"Self-Propelled Gun",category:"artillery",subcategory:"spg",composition:{manpower:400,equipment:{spg:32}},costs:{production:6e6,maintenance:3e5},stats:{softAttack:55,hardAttack:12,defense:20,breakthrough:15,armor:20,piercing:15,hp:12,organization:45,recovery:.35,reconnaissance:2,suppression:12,weight:2.5,combatWidth:2},requirements:{minTechLevel:4},icon:"assets/division-icons/unit_spa_company_icon.png",color:"#a16207"},spaa:{id:"spaa",name:"Artilharia AA Autopropulsada (SPAA)",nameEn:"Self-Propelled Anti-Aircraft",category:"artillery",subcategory:"spaa",composition:{manpower:400,equipment:{spaa:32}},costs:{production:6e6,maintenance:3e5},stats:{softAttack:10,hardAttack:4,defense:25,breakthrough:10,armor:15,piercing:20,hp:11,organization:48,recovery:.36,reconnaissance:2,suppression:8,weight:2.2,combatWidth:2},requirements:{minTechLevel:4},icon:"assets/division-icons/unit_spaa_company_icon.png",color:"#ca8a04"},tropas_aerotransportadas:{id:"tropas_aerotransportadas",name:"Tropas Aerotransportadas",nameEn:"Air Assault",category:"special",subcategory:"airborne",composition:{manpower:800,equipment:{utility_helicopters:40,small_arms:800,light_mg:80,mortars:16}},costs:{production:6e6,maintenance:3e5},stats:{softAttack:26,hardAttack:4,defense:24,breakthrough:18,armor:0,piercing:2,hp:10,organization:70,recovery:.45,reconnaissance:6,suppression:12,weight:.2,combatWidth:2},requirements:{minTechLevel:4},icon:"assets/division-icons/unit_category_helicopter_icon_small.png",color:"#0369a1"},helicoptero_ataque:{id:"helicoptero_ataque",name:"Helic√≥ptero de Ataque",nameEn:"Attack Helicopter",category:"special",subcategory:"attack_heli",composition:{manpower:200,equipment:{attack_helicopters:30}},costs:{production:4e6,maintenance:2e5},stats:{softAttack:35,hardAttack:40,defense:10,breakthrough:25,armor:5,piercing:45,hp:8,organization:40,recovery:.3,reconnaissance:10,suppression:15,weight:.5,combatWidth:1},requirements:{minTechLevel:5},icon:"assets/division-icons/unit_attack_helicopter_icon_small.png",color:"#be123c"},anfibio_mecanizado:{id:"anfibio_mecanizado",name:"Anf√≠bio Mecanizado",nameEn:"Amphibious Mechanized",category:"amphibious",subcategory:"amtrac",composition:{manpower:800,equipment:{amtrac:60,small_arms:800,light_mg:80}},costs:{production:3e6,maintenance:15e4},stats:{softAttack:28,hardAttack:6,defense:32,breakthrough:18,armor:8,piercing:8,hp:12,organization:62,recovery:.4,reconnaissance:4,suppression:13,weight:1.8,combatWidth:2},requirements:{minTechLevel:3},icon:"assets/division-icons/unit_amphibious_mechanized_icon.png",color:"#0891b2"}},k={suporte_helicoptero_ataque:{id:"suporte_helicoptero_ataque",name:"Suporte: Helic√≥ptero de Ataque",nameEn:"Support: Attack Helicopter",category:"air_support",composition:{manpower:80,equipment:{attack_helicopters:12}},costs:{production:1e6,maintenance:5e4},divisionBonuses:{softAttack:15,hardAttack:20,piercing:15,reconnaissance:3},requirements:{minTechLevel:5},icon:"assets/division-icons/unit_attack_helicopter_icon_small.png",color:"#dc2626"},suporte_logistica_aerea:{id:"suporte_logistica_aerea",name:"Suporte: Log√≠stica A√©rea",nameEn:"Support: Air Logistics",category:"air_support",composition:{manpower:1200,equipment:{utility_helicopters:60}},costs:{production:2e6,maintenance:1e5},divisionBonuses:{organization:5,recovery:.05,suppression:3},requirements:{minTechLevel:4},icon:"assets/division-icons/unit_category_helicopter_icon_small.png",color:"#0891b2"},suporte_recon_aereo:{id:"suporte_recon_aereo",name:"Suporte: Reconhecimento A√©reo",nameEn:"Support: Air Reconnaissance",category:"air_support",composition:{manpower:80,equipment:{utility_helicopters:12}},costs:{production:1e6,maintenance:5e4},divisionBonuses:{reconnaissance:8,combatWidth:0},requirements:{minTechLevel:4},icon:"assets/division-icons/support_unit_helicopter_recon.png",color:"#0369a1"},suporte_evacuacao_medica:{id:"suporte_evacuacao_medica",name:"Suporte: Evacua√ß√£o M√©dica A√©rea",nameEn:"Support: Medical Evacuation",category:"air_support",composition:{manpower:200,equipment:{utility_helicopters:24}},costs:{production:3e6,maintenance:15e4},divisionBonuses:{recovery:.1,organization:3,hp:2},requirements:{minTechLevel:4},icon:"assets/division-icons/support_unit_field_hospital_icon.png",color:"#dc2626"},suporte_ifv_aerotrans:{id:"suporte_ifv_aerotrans",name:"Suporte: IFV Aerotransportado",nameEn:"Support: Airborne IFV",category:"airborne_support",composition:{manpower:300,equipment:{ifv:20}},costs:{production:1e6,maintenance:5e4},divisionBonuses:{softAttack:10,hardAttack:8,armor:5,piercing:8},requirements:{minTechLevel:4},icon:"assets/division-icons/support_unit_air_mechanized_icon.png",color:"#16a34a"},suporte_tanque_leve_aerotrans:{id:"suporte_tanque_leve_aerotrans",name:"Suporte: Tanque Leve Aerotransportado",nameEn:"Support: Airborne Light Tank",category:"airborne_support",composition:{manpower:100,equipment:{light_tanks:20}},costs:{production:14e5,maintenance:7e4},divisionBonuses:{hardAttack:12,armor:10,piercing:15,breakthrough:8},requirements:{minTechLevel:4},icon:"assets/division-icons/support_unit_airborne_armored_recon_icon.png",color:"#ca8a04"},suporte_antiaerea:{id:"suporte_antiaerea",name:"Suporte: Antia√©rea",nameEn:"Support: Anti-Aircraft",category:"fire_support",composition:{manpower:200,equipment:{aa_guns:12,trucks:12}},costs:{production:6e5,maintenance:3e4},divisionBonuses:{piercing:5,defense:3},requirements:{minTechLevel:2},icon:"assets/division-icons/support_unit_anti_air_icon.png",color:"#92400e"},suporte_artilharia:{id:"suporte_artilharia",name:"Suporte: Artilharia",nameEn:"Support: Artillery",category:"fire_support",composition:{manpower:200,equipment:{artillery:12,trucks:12}},costs:{production:5e5,maintenance:25e3},divisionBonuses:{softAttack:20,hardAttack:5,defense:5,combatWidth:1},requirements:{minTechLevel:2},icon:"assets/division-icons/support_unit_art_icon.png",color:"#b45309"},suporte_atcms:{id:"suporte_atcms",name:"Suporte: ATCMS",nameEn:"Support: ATGM",category:"fire_support",composition:{manpower:20,equipment:{atcms:12}},costs:{production:1e6,maintenance:5e4},divisionBonuses:{hardAttack:15,piercing:25,defense:4},requirements:{minTechLevel:4},icon:"assets/division-icons/support_unit_at_icon.png",color:"#dc2626"},suporte_manpad:{id:"suporte_manpad",name:"Suporte: MANPAD",nameEn:"Support: MANPAD",category:"fire_support",composition:{manpower:20,equipment:{manpads:12}},costs:{production:1e6,maintenance:5e4},divisionBonuses:{piercing:6,defense:4},requirements:{minTechLevel:4},icon:"assets/division-icons/support_unit_at_icon.png",color:"#ef4444"},suporte_lancador_foguete:{id:"suporte_lancador_foguete",name:"Suporte: Lan√ßadores de Foguete",nameEn:"Support: Rocket Launchers",category:"fire_support",composition:{manpower:200,equipment:{rocket_launchers:12,trucks:12}},costs:{production:1e6,maintenance:5e4},divisionBonuses:{softAttack:25,hardAttack:8,suppression:5,combatWidth:1},requirements:{minTechLevel:3},icon:"assets/division-icons/support_unit_rocket_art_icon.png",color:"#ea580c"},suporte_spg:{id:"suporte_spg",name:"Suporte: Artilharia Autopropulsada",nameEn:"Support: SPG",category:"fire_support",composition:{manpower:200,equipment:{spg:8}},costs:{production:1e6,maintenance:5e4},divisionBonuses:{softAttack:18,hardAttack:6,armor:5,defense:4},requirements:{minTechLevel:4},icon:"assets/division-icons/unit_spa_company_icon.png",color:"#a16207"},suporte_spaa:{id:"suporte_spaa",name:"Suporte: Artilharia AA Autopropulsada",nameEn:"Support: SPAA",category:"fire_support",composition:{manpower:200,equipment:{spaa:8}},costs:{production:1e6,maintenance:5e4},divisionBonuses:{piercing:8,armor:4,defense:5},requirements:{minTechLevel:4},icon:"assets/division-icons/unit_spaa_company_icon.png",color:"#eab308"},suporte_recon_mecanizado:{id:"suporte_recon_mecanizado",name:"Suporte: Reconhecimento Mecanizado",nameEn:"Support: Mechanized Recon",category:"reconnaissance",composition:{manpower:200,equipment:{apc:20}},costs:{production:2e6,maintenance:1e5},divisionBonuses:{reconnaissance:10,armor:3,piercing:3},requirements:{minTechLevel:3},icon:"assets/division-icons/support_unit_armored_recon_icon.png",color:"#15803d"},suporte_recon_tanque_leve:{id:"suporte_recon_tanque_leve",name:"Suporte: Reconhecimento Tanque Leve",nameEn:"Support: Light Tank Recon",category:"reconnaissance",composition:{manpower:100,equipment:{light_tanks:20}},costs:{production:12e5,maintenance:6e4},divisionBonuses:{reconnaissance:12,armor:8,piercing:10,hardAttack:5},requirements:{minTechLevel:3},icon:"assets/division-icons/support_unit_armored_car_recon_icon.png",color:"#ca8a04"},suporte_recon_motorizado:{id:"suporte_recon_motorizado",name:"Suporte: Reconhecimento Motorizado",nameEn:"Support: Motorized Recon",category:"reconnaissance",composition:{manpower:200,equipment:{trucks:20}},costs:{production:4e5,maintenance:2e4},divisionBonuses:{reconnaissance:6},requirements:{minTechLevel:2},icon:"assets/division-icons/support_unit_motorized_recon_icon.png",color:"#92400e"},suporte_recon_desmontado:{id:"suporte_recon_desmontado",name:"Suporte: Reconhecimento Desmontado",nameEn:"Support: Dismounted Recon",category:"reconnaissance",composition:{manpower:200,equipment:{binoculars:200,radios:50}},costs:{production:2e5,maintenance:1e4},divisionBonuses:{reconnaissance:4},requirements:{minTechLevel:1},icon:"assets/division-icons/support_unit_rangers_icon.png",color:"#65a30d"},suporte_engenheiros:{id:"suporte_engenheiros",name:"Suporte: Engenheiros",nameEn:"Support: Engineers",category:"logistics",composition:{manpower:1400,equipment:{trucks:100,engineering_equipment:500}},costs:{production:2e6,maintenance:1e5},divisionBonuses:{defense:8,recovery:.05,organization:4},requirements:{minTechLevel:2},icon:"assets/division-icons/unit_engineer_icon.png",color:"#f59e0b"},suporte_hospital_campo:{id:"suporte_hospital_campo",name:"Suporte: Hospital de Campo",nameEn:"Support: Field Hospital",category:"logistics",composition:{manpower:600,equipment:{trucks:100,medical_equipment:300}},costs:{production:16e5,maintenance:8e4},divisionBonuses:{recovery:.12,hp:3,organization:5},requirements:{minTechLevel:2},icon:"assets/division-icons/support_unit_field_hospital_icon.png",color:"#dc2626"},suporte_logistica_admin:{id:"suporte_logistica_admin",name:"Suporte: Log√≠stica e Administra√ß√£o",nameEn:"Support: Logistics & Admin",category:"logistics",composition:{manpower:800,equipment:{trucks:200,radios:100,computers:50}},costs:{production:2e6,maintenance:1e5},divisionBonuses:{organization:8,recovery:.06,suppression:2},requirements:{minTechLevel:2},icon:"assets/division-icons/support_unit_logistics_company_icon.png",color:"#3b82f6"},suporte_manutencao_reparo:{id:"suporte_manutencao_reparo",name:"Suporte: Manuten√ß√£o e Reparo",nameEn:"Support: Maintenance & Repair",category:"logistics",composition:{manpower:600,equipment:{trucks:200,repair_equipment:400,spare_parts:1e3}},costs:{production:4e6,maintenance:2e5},divisionBonuses:{recovery:.15,organization:6},requirements:{minTechLevel:3},icon:"assets/division-icons/support_unit_maintenance_company_icon.png",color:"#ea580c"},suporte_policia_militar:{id:"suporte_policia_militar",name:"Suporte: Pol√≠cia Militar",nameEn:"Support: Military Police",category:"logistics",composition:{manpower:1e3,equipment:{utility_vehicles:200,dogs:100,small_arms:1e3}},costs:{production:2e6,maintenance:1e5},divisionBonuses:{suppression:15,organization:7,defense:3},requirements:{minTechLevel:2},icon:"assets/division-icons/support_unit_military_police_icon.png",color:"#1e40af"},suporte_comunicacao_sinal:{id:"suporte_comunicacao_sinal",name:"Suporte: Comunica√ß√£o e Sinal",nameEn:"Support: Signal",category:"logistics",composition:{manpower:200,equipment:{trucks:80,radios:200,communication_equipment:100}},costs:{production:2e6,maintenance:1e5},divisionBonuses:{reconnaissance:5,organization:5,recovery:.04},requirements:{minTechLevel:2},icon:"assets/division-icons/support_unit_signal_company_icon.png",color:"#059669"}},E={infantaria_basica:{id:"infantaria_basica",name:"Divis√£o de Infantaria B√°sica",description:"Divis√£o de infantaria padr√£o para combate geral",trainingLevel:"regular",combatUnits:[{unitType:"infantaria_linha"},{unitType:"infantaria_linha"},{unitType:"infantaria_linha"},{unitType:"infantaria_linha"},{unitType:"infantaria_linha"},{unitType:"infantaria_linha"},{unitType:"infantaria_linha"},{unitType:"infantaria_linha"},{unitType:"infantaria_linha"},{unitType:"infantaria_linha"}],supportUnits:[{unitType:"suporte_artilharia"},{unitType:"suporte_engenheiros"},{unitType:"suporte_recon_desmontado"}],category:"infantry",icon:"assets/division-icons/unit_infantry_icon.png"},infantaria_elite:{id:"infantaria_elite",name:"Divis√£o de Infantaria de Elite",description:"Infantaria de alto n√≠vel para opera√ß√µes cr√≠ticas",trainingLevel:"elite",combatUnits:[{unitType:"tropa_choque"},{unitType:"tropa_choque"},{unitType:"tropa_choque"},{unitType:"infantaria_linha"},{unitType:"infantaria_linha"},{unitType:"infantaria_linha"},{unitType:"infantaria_linha"},{unitType:"infantaria_linha"},{unitType:"infantaria_linha"},{unitType:"infantaria_linha"}],supportUnits:[{unitType:"suporte_artilharia"},{unitType:"suporte_engenheiros"},{unitType:"suporte_hospital_campo"},{unitType:"suporte_recon_desmontado"}],category:"infantry",icon:"assets/division-icons/unit_heavy_infantry_icon.png"},infantaria_motorizada:{id:"infantaria_motorizada",name:"Divis√£o Motorizada",description:"Infantaria com alta mobilidade em estradas",trainingLevel:"regular",combatUnits:[{unitType:"infantaria_motorizada"},{unitType:"infantaria_motorizada"},{unitType:"infantaria_motorizada"},{unitType:"infantaria_motorizada"},{unitType:"infantaria_motorizada"},{unitType:"infantaria_motorizada"},{unitType:"infantaria_motorizada"},{unitType:"infantaria_motorizada"},{unitType:"carro_armado"},{unitType:"carro_armado"}],supportUnits:[{unitType:"suporte_artilharia"},{unitType:"suporte_recon_motorizado"},{unitType:"suporte_engenheiros"},{unitType:"suporte_antiaerea"}],category:"motorized",icon:"assets/division-icons/unit_motorized_icon.png"},divisao_mecanizada:{id:"divisao_mecanizada",name:"Divis√£o Mecanizada (IFV)",description:"Divis√£o mecanizada com IFVs para combate moderno",trainingLevel:"regular",combatUnits:[{unitType:"mecanizada_ifv"},{unitType:"mecanizada_ifv"},{unitType:"mecanizada_ifv"},{unitType:"mecanizada_ifv"},{unitType:"mecanizada_ifv"},{unitType:"mecanizada_ifv"},{unitType:"mecanizada_ifv"},{unitType:"mecanizada_ifv"},{unitType:"tanque_mbt"},{unitType:"tanque_mbt"}],supportUnits:[{unitType:"suporte_spg"},{unitType:"suporte_recon_mecanizado"},{unitType:"suporte_engenheiros"},{unitType:"suporte_spaa"},{unitType:"suporte_manutencao_reparo"}],category:"mechanized",icon:"assets/division-icons/unit_mechanized_icon.png"},divisao_blindada:{id:"divisao_blindada",name:"Divis√£o Blindada",description:"Divis√£o de tanques pesados para breakthrough",trainingLevel:"regular",combatUnits:[{unitType:"tanque_mbt"},{unitType:"tanque_mbt"},{unitType:"tanque_mbt"},{unitType:"tanque_mbt"},{unitType:"tanque_mbt"},{unitType:"tanque_mbt"},{unitType:"mecanizada_ifv"},{unitType:"mecanizada_ifv"},{unitType:"mecanizada_ifv"},{unitType:"mecanizada_ifv"}],supportUnits:[{unitType:"suporte_spg"},{unitType:"suporte_recon_tanque_leve"},{unitType:"suporte_spaa"},{unitType:"suporte_manutencao_reparo"},{unitType:"suporte_engenheiros"}],category:"armor",icon:"assets/division-icons/unit_mbt_company_icon.png"},tanques_leves:{id:"tanques_leves",name:"Divis√£o de Tanques Leves",description:"Blindados leves para reconhecimento e flanqueamento",trainingLevel:"regular",combatUnits:[{unitType:"tanque_leve"},{unitType:"tanque_leve"},{unitType:"tanque_leve"},{unitType:"tanque_leve"},{unitType:"tanque_leve"},{unitType:"tanque_leve"},{unitType:"mecanizada_leve_apc"},{unitType:"mecanizada_leve_apc"},{unitType:"mecanizada_leve_apc"},{unitType:"mecanizada_leve_apc"}],supportUnits:[{unitType:"suporte_artilharia"},{unitType:"suporte_recon_tanque_leve"},{unitType:"suporte_antiaerea"},{unitType:"suporte_engenheiros"}],category:"armor",icon:"assets/division-icons/unit_light_tank_icon.png"},paraquedistas:{id:"paraquedistas",name:"Divis√£o Paraquedista",description:"For√ßas aerotransportadas para opera√ß√µes especiais",trainingLevel:"elite",combatUnits:[{unitType:"paraquedistas"},{unitType:"paraquedistas"},{unitType:"paraquedistas"},{unitType:"paraquedistas"},{unitType:"paraquedistas"},{unitType:"paraquedistas"},{unitType:"paraquedistas"},{unitType:"paraquedistas"},{unitType:"infantaria_leve"},{unitType:"infantaria_leve"}],supportUnits:[{unitType:"suporte_tanque_leve_aerotrans"},{unitType:"suporte_ifv_aerotrans"},{unitType:"suporte_artilharia"},{unitType:"suporte_engenheiros"}],category:"special",icon:"assets/division-icons/unit_paratroop_icon.png"},fuzileiros_navais:{id:"fuzileiros_navais",name:"Divis√£o de Fuzileiros Navais",description:"Infantaria naval para assaltos anf√≠bios",trainingLevel:"elite",combatUnits:[{unitType:"fuzileiros_navais"},{unitType:"fuzileiros_navais"},{unitType:"fuzileiros_navais"},{unitType:"fuzileiros_navais"},{unitType:"fuzileiros_navais"},{unitType:"fuzileiros_navais"},{unitType:"anfibio_mecanizado"},{unitType:"anfibio_mecanizado"},{unitType:"tanque_anfibio"},{unitType:"tanque_anfibio"}],supportUnits:[{unitType:"suporte_artilharia"},{unitType:"suporte_engenheiros"},{unitType:"suporte_hospital_campo"},{unitType:"suporte_antiaerea"}],category:"special",icon:"assets/division-icons/unit_marine_icon.png"},montanhistas:{id:"montanhistas",name:"Divis√£o de Montanha",description:"Especializada em combate em terreno montanhoso",trainingLevel:"elite",combatUnits:[{unitType:"montanhistas"},{unitType:"montanhistas"},{unitType:"montanhistas"},{unitType:"montanhistas"},{unitType:"montanhistas"},{unitType:"montanhistas"},{unitType:"montanhistas"},{unitType:"montanhistas"},{unitType:"infantaria_leve"},{unitType:"infantaria_leve"}],supportUnits:[{unitType:"suporte_artilharia"},{unitType:"suporte_engenheiros"},{unitType:"suporte_recon_desmontado"},{unitType:"suporte_hospital_campo"}],category:"special",icon:"assets/division-icons/unit_mountain_icon.png"},artilharia_pesada:{id:"artilharia_pesada",name:"Divis√£o de Artilharia Pesada",description:"Suporte de fogo massivo de longo alcance",trainingLevel:"regular",combatUnits:[{unitType:"spg"},{unitType:"spg"},{unitType:"spg"},{unitType:"spg"},{unitType:"mlrs"},{unitType:"mlrs"},{unitType:"bateria_artilharia"},{unitType:"bateria_artilharia"},{unitType:"bateria_artilharia"},{unitType:"bateria_artilharia"}],supportUnits:[{unitType:"suporte_recon_motorizado"},{unitType:"suporte_spaa"},{unitType:"suporte_engenheiros"},{unitType:"suporte_manutencao_reparo"}],category:"artillery",icon:"assets/division-icons/unit_spa_company_icon.png"},defesa_antiaerea:{id:"defesa_antiaerea",name:"Divis√£o Antia√©rea",description:"Especializada em defesa a√©rea",trainingLevel:"regular",combatUnits:[{unitType:"spaa"},{unitType:"spaa"},{unitType:"spaa"},{unitType:"bateria_antiaerea"},{unitType:"bateria_antiaerea"},{unitType:"bateria_antiaerea"},{unitType:"grupo_manpad"},{unitType:"grupo_manpad"},{unitType:"infantaria_motorizada"},{unitType:"infantaria_motorizada"}],supportUnits:[{unitType:"suporte_spaa"},{unitType:"suporte_antiaerea"},{unitType:"suporte_recon_motorizado"},{unitType:"suporte_comunicacao_sinal"}],category:"artillery",icon:"assets/division-icons/unit_spaa_company_icon.png"},forca_tarefa_combinada:{id:"forca_tarefa_combinada",name:"For√ßa-Tarefa Combinada",description:"Divis√£o balanceada com m√∫ltiplos tipos de unidades",trainingLevel:"regular",combatUnits:[{unitType:"tanque_mbt"},{unitType:"tanque_mbt"},{unitType:"tanque_mbt"},{unitType:"mecanizada_ifv"},{unitType:"mecanizada_ifv"},{unitType:"mecanizada_ifv"},{unitType:"spg"},{unitType:"spaa"},{unitType:"helicoptero_ataque"},{unitType:"helicoptero_ataque"}],supportUnits:[{unitType:"suporte_recon_mecanizado"},{unitType:"suporte_engenheiros"},{unitType:"suporte_hospital_campo"},{unitType:"suporte_manutencao_reparo"},{unitType:"suporte_comunicacao_sinal"}],category:"combined",icon:"assets/division-icons/unit_mbt_company_icon.png"}};class M{static calculateDivisionStats(e,t,n,a){const c=(a[e.trainingLevel]||a.regular).modifiers;let r={manpower:{combat:0,support:0,total:0},equipment:{},costs:{production:0,maintenance:0},combatStats:{softAttack:0,hardAttack:0,defense:0,breakthrough:0,armor:0,piercing:0,hp:0,organization:0,recovery:0,reconnaissance:0,suppression:0,weight:0,combatWidth:0}};return e.combatUnits&&Array.isArray(e.combatUnits)&&e.combatUnits.forEach(d=>{const p=t[d.unitType];if(!p){console.warn(`Unidade de combate n√£o encontrada: ${d.unitType}`);return}r.manpower.combat+=p.composition.manpower,this.mergeEquipment(r.equipment,p.composition.equipment),r.costs.production+=p.costs.production*c.costs.production,r.costs.maintenance+=p.costs.maintenance*c.costs.maintenance,Object.keys(r.combatStats).forEach(u=>{const l=p.stats[u]||0,m=c.stats[u]||1;r.combatStats[u]+=l*m})}),e.supportUnits&&Array.isArray(e.supportUnits)&&e.supportUnits.forEach(d=>{const p=n[d.unitType];if(!p){console.warn(`Unidade de suporte n√£o encontrada: ${d.unitType}`);return}r.manpower.support+=p.composition.manpower,this.mergeEquipment(r.equipment,p.composition.equipment),r.costs.production+=p.costs.production,r.costs.maintenance+=p.costs.maintenance,p.divisionBonuses&&Object.keys(p.divisionBonuses).forEach(u=>{const l=p.divisionBonuses[u],_=["softAttack","hardAttack","defense","breakthrough","reconnaissance"].includes(u)&&c.stats[u]||1;r.combatStats[u]+=l*_})}),r.manpower.total=r.manpower.combat+r.manpower.support,r=this.roundStats(r),r}static mergeEquipment(e,t){t&&Object.keys(t).forEach(n=>{e[n]=(e[n]||0)+t[n]})}static roundStats(e){return e.manpower.combat=Math.round(e.manpower.combat),e.manpower.support=Math.round(e.manpower.support),e.manpower.total=Math.round(e.manpower.total),Object.keys(e.equipment).forEach(t=>{e.equipment[t]=Math.round(e.equipment[t])}),e.costs.production=Math.round(e.costs.production*100)/100,e.costs.maintenance=Math.round(e.costs.maintenance*100)/100,Object.keys(e.combatStats).forEach(t=>{e.combatStats[t]=Math.round(e.combatStats[t]*10)/10}),e}static categorizeEquipment(e){return{vehicles:{trucks:e.trucks||0,utility_vehicles:e.utility_vehicles||0,apc:e.apc||0,ifv:e.ifv||0,amtrac:e.amtrac||0},tanks:{light_tanks:e.light_tanks||0,medium_tanks:e.medium_tanks||0,mbt:e.mbt||0,amphibious_tanks:e.amphibious_tanks||0},artillery:{artillery:e.artillery||0,aa_guns:e.aa_guns||0,rocket_launchers:e.rocket_launchers||0,spg:e.spg||0,spaa:e.spaa||0,mlrs:e.mlrs||0},missiles:{atcms:e.atcms||0,manpads:e.manpads||0},aircraft:{attack_helicopters:e.attack_helicopters||0,utility_helicopters:e.utility_helicopters||0},infantry:{small_arms:e.small_arms||0,light_mg:e.light_mg||0,heavy_mg:e.heavy_mg||0,mortars:e.mortars||0,autocannons:e.autocannons||0,atgm:e.atgm||0}}}static calculateEffectiveness(e){const t=e.combatStats,n=(t.softAttack+t.hardAttack+t.breakthrough)/3,a=(t.defense+t.armor+t.hp)/3,o=(t.reconnaissance+t.suppression+t.organization)/3,c=n*.4+a*.4+o*.2;return Math.min(100,Math.round(c))}static calculateCostPerManpower(e){return e.manpower.total===0?0:Math.round(e.costs.production/e.manpower.total)}static getWidthClassification(e){const t=e.combatStats.combatWidth;return t<=10?"Muito Estreita":t<=20?"Estreita":t<=30?"M√©dia":t<=40?"Larga":"Muito Larga"}static analyzeDivision(e){const t=e.combatStats,n=[],a=[];return t.softAttack>200?n.push("Alto ataque contra infantaria"):t.softAttack<50&&a.push("Baixo ataque contra infantaria"),t.hardAttack>200?n.push("Alto ataque contra blindados"):t.hardAttack<20&&a.push("Baixo ataque contra blindados"),t.defense>200?n.push("Alta defesa"):t.defense<50&&a.push("Baixa defesa"),t.armor>50?n.push("Boa prote√ß√£o blindada"):t.armor<10&&a.push("Pouca prote√ß√£o blindada"),t.reconnaissance>15?n.push("Excelente reconhecimento"):t.reconnaissance<5&&a.push("Reconhecimento limitado"),t.organization>60?n.push("Alta organiza√ß√£o"):t.organization<40&&a.push("Baixa organiza√ß√£o"),t.combatWidth>40?a.push("Largura de combate muito alta"):t.combatWidth<10&&a.push("Largura de combate muito baixa"),{strengths:n,weaknesses:a,overallRating:this.calculateEffectiveness(e)}}}class b{static validate(e,t,n,a){const o=[],c=[];if(this.validateMetadata(e,o),this.validateCombatUnits(e,t,o,c),this.validateSupportUnits(e,n,o,c),o.length===0){const r=M.calculateDivisionStats(e,t,n,a);this.validateStats(r,o,c)}return{valid:o.length===0,errors:o,warnings:c}}static validateMetadata(e,t){!e.name||typeof e.name!="string"?t.push("Nome da divis√£o √© obrigat√≥rio"):e.name.trim()===""?t.push("Nome da divis√£o n√£o pode ser vazio"):e.name.length>50&&t.push("Nome da divis√£o muito longo (m√°ximo 50 caracteres)"),["conscript","regular","elite"].includes(e.trainingLevel)||t.push("N√≠vel de treinamento inv√°lido")}static validateCombatUnits(e,t,n,a){if(!e.combatUnits||!Array.isArray(e.combatUnits)){n.push("Lista de unidades de combate inv√°lida");return}const o=e.combatUnits;o.length===0&&n.push("A divis√£o deve ter pelo menos uma unidade de combate"),o.length>25&&n.push("M√°ximo de 25 unidades de combate permitidas"),o.forEach((p,u)=>{if(!p.unitType||!p.id){n.push(`Unidade de combate #${u+1} com estrutura inv√°lida`);return}t[p.unitType]||n.push(`Tipo de unidade de combate n√£o encontrado: ${p.unitType}`)}),o.length<5&&a.push("Divis√£o muito pequena (menos de 5 batalh√µes). Considere adicionar mais unidades.");const c=o.map(p=>p.unitType);new Set(c).size/c.length<.3&&o.length>5&&a.push("Pouca variedade de tipos de unidade. Considere diversificar a composi√ß√£o.")}static validateSupportUnits(e,t,n,a){if(!e.supportUnits||!Array.isArray(e.supportUnits)){n.push("Lista de unidades de suporte inv√°lida");return}const o=e.supportUnits;o.length>5&&n.push("M√°ximo de 5 unidades de suporte permitidas"),o.forEach((d,p)=>{if(!d.unitType||!d.id){n.push(`Unidade de suporte #${p+1} com estrutura inv√°lida`);return}t[d.unitType]||n.push(`Tipo de unidade de suporte n√£o encontrado: ${d.unitType}`)});const c=o.map(d=>d.unitType),r=new Set(c);if(c.length>r.size){const d=c.filter((p,u)=>c.indexOf(p)!==u);a.push(`Unidades de suporte duplicadas (${[...new Set(d)].join(", ")}). Duplicatas n√£o fornecem benef√≠cios adicionais.`)}o.length===0&&e.combatUnits&&e.combatUnits.length>5&&a.push("Divis√£o sem unidades de suporte. Considere adicionar suporte para melhorar desempenho.")}static validateStats(e,t,n){const a=e.combatStats;a.combatWidth>40&&n.push(`Largura de combate muito alta (${a.combatWidth}). Divis√µes largas s√£o menos eficientes em terrenos dif√≠ceis. Recomendado: ‚â§40`),a.combatWidth<10&&n.push(`Largura de combate muito baixa (${a.combatWidth}). Divis√µes estreitas podem n√£o aproveitar todo o front. Recomendado: ‚â•10`),a.organization<20&&n.push("Organiza√ß√£o muito baixa (<20). A divis√£o pode quebrar rapidamente em combate."),a.organization<10&&t.push("Organiza√ß√£o cr√≠tica (<10). Divis√£o invi√°vel para combate."),a.hp<5&&t.push("HP muito baixo (<5). Divis√£o n√£o sobreviveria a combate."),a.hp<10&&n.push("HP baixo (<10). Considere adicionar mais unidades ou melhorar treinamento."),a.softAttack<10&&a.hardAttack<10&&n.push("Capacidade ofensiva muito baixa. Divis√£o ter√° dificuldade em causar dano ao inimigo."),a.weight>5&&n.push(`Divis√£o muito pesada (${a.weight.toFixed(1)} ton). Mobilidade reduzida e maior consumo de combust√≠vel.`);const o=M.calculateCostPerManpower(e);o>1e4&&n.push(`Custo por soldado muito alto ($${(o/1e3).toFixed(1)}k). Considere otimizar composi√ß√£o.`),e.manpower.total<500&&n.push("Divis√£o muito pequena (<500 MP). Pode n√£o ser efetiva em combate."),e.manpower.total>25e3&&n.push("Divis√£o muito grande (>25k MP). Dif√≠cil de manter e suprir.")}static validateResources(e,t,n,a,o){if(!n)return;const c=n.Orcamento||0;t.costs.production>c&&a.push(`Custo de produ√ß√£o ($${(t.costs.production/1e6).toFixed(1)}M) excede or√ßamento dispon√≠vel ($${(c/1e6).toFixed(1)}M)`),t.costs.production>c*.8&&o.push(`Custo de produ√ß√£o muito alto (${(t.costs.production/c*100).toFixed(0)}% do or√ßamento)`);const r=n.ManpowerDisponivel||0;t.manpower.total>r&&a.push(`Manpower necess√°rio (${t.manpower.total}) excede dispon√≠vel (${r})`);const d=n.CapacidadeProducaoVeiculos||0;this.estimateEquipmentValue(t.equipment)>d&&o.push("Equipamentos requeridos excedem capacidade de produ√ß√£o militar. Produ√ß√£o pode levar m√∫ltiplos turnos.")}static estimateEquipmentValue(e){const t={mbt:1e5,medium_tanks:2e4,light_tanks:67e3,ifv:3e4,apc:2e4,spg:187500,spaa:187500,mlrs:312500,artillery:41667,aa_guns:41667,attack_helicopters:133333,utility_helicopters:33333};let n=0;return Object.keys(e).forEach(a=>{t[a]&&(n+=e[a]*t[a])}),n}static validateCompatibility(e,t,n,a){const o=e.combatUnits||[],c=e.supportUnits||[],r=o.some(l=>{const m=t[l.unitType];return m&&m.category==="special"&&m.subcategory==="airborne"}),d=c.some(l=>{const m=n[l.unitType];return m&&m.category==="air_support"});r&&!d&&a.push("Divis√£o tem unidades aerotransportadas mas n√£o tem suporte a√©reo. Considere adicionar suporte de helic√≥pteros.");const p=o.filter(l=>{const m=t[l.unitType];return m&&m.category==="armor"}).length,u=c.some(l=>l.unitType==="suporte_manutencao_reparo");p>3&&!u&&a.push("Muitas unidades blindadas sem suporte de manuten√ß√£o. Considere adicionar Suporte: Manuten√ß√£o e Reparo.")}static generateReport(e){let t=[];return e.errors.length>0&&(t.push("‚ùå ERROS:"),e.errors.forEach(n=>{t.push(`  ‚Ä¢ ${n}`)})),e.warnings.length>0&&(t.length>0&&t.push(""),t.push("‚ö†Ô∏è AVISOS:"),e.warnings.forEach(n=>{t.push(`  ‚Ä¢ ${n}`)})),e.valid&&e.warnings.length===0&&t.push("‚úÖ Divis√£o v√°lida e otimizada!"),t.join(`
`)}}let s={id:null,name:"Nova Divis√£o",countryId:null,trainingLevel:"regular",combatUnits:[],supportUnits:[],calculatedStats:null,createdAt:null,updatedAt:null},$=null,h=null,v=null,z=[];function A(){return window.db}async function le(i){try{console.log("üéñÔ∏è Inicializando Division Designer..."),$=i;const{checkUserPermissions:e}=await U(async()=>{const{checkUserPermissions:a}=await import("./firebase-ep1w8F7T.js");return{checkUserPermissions:a}},__vite__mapDeps([0,1,2]));v=await e($.uid),console.log("üîë Permiss√µes do usu√°rio:",v),(v.isNarrator||v.isAdmin)&&await G(),await K();const n=new URLSearchParams(window.location.search).get("id");n&&await J(n),await Q(),x(),ce(),console.log("‚úÖ Division Designer inicializado com sucesso")}catch(e){console.error("‚ùå Erro ao inicializar Division Designer:",e),g("error","Erro ao carregar Division Designer: "+e.message)}}async function G(){try{const{getAllCountries:i}=await U(async()=>{const{getAllCountries:t}=await import("./firebase-ep1w8F7T.js");return{getAllCountries:t}},__vite__mapDeps([0,1,2]));z=(await i()).map(t=>({id:t.id,name:t.Pais,flag:t.Flag})).sort((t,n)=>t.name.localeCompare(n.name)),console.log(`‚úÖ ${z.length} pa√≠ses carregados para sele√ß√£o`)}catch(i){throw console.error("Erro ao carregar pa√≠ses:",i),i}}async function K(){try{const{checkPlayerCountry:i,getCountryData:e}=await U(async()=>{const{checkPlayerCountry:n,getCountryData:a}=await import("./firebase-ep1w8F7T.js");return{checkPlayerCountry:n,getCountryData:a}},__vite__mapDeps([0,1,2])),t=await i($.uid);if(!t){if(v?.isNarrator||v?.isAdmin){console.log("‚ö†Ô∏è Narrador/Admin sem pa√≠s vinculado - poder√° selecionar pa√≠s manualmente");return}throw new Error("Usu√°rio n√£o est√° vinculado a um pa√≠s")}h=await e(t),h.id=t,s.countryId=t,console.log(`‚úÖ Pa√≠s carregado: ${h.Pais}`)}catch(i){throw console.error("Erro ao carregar pa√≠s:",i),i}}async function J(i){try{if(!h||!h.id)throw new Error("Pa√≠s do usu√°rio n√£o carregado. N√£o √© poss√≠vel carregar a divis√£o.");const t=await A().collection("inventory").doc(h.id).get();if(!t.exists)throw new Error("Invent√°rio do pa√≠s n√£o encontrado.");const a=(t.data().divisions||[]).find(o=>o.id===i);if(!a)throw new Error("Divis√£o n√£o encontrada no invent√°rio.");s={...s,...a,id:i},console.log(`‚úÖ Divis√£o carregada: ${s.name}`)}catch(e){console.error("Erro ao carregar divis√£o:",e),g("error","Erro ao carregar divis√£o: "+e.message)}}async function Q(){(v?.isNarrator||v?.isAdmin)&&X(),S(),q(),L(),ae(),await O()}function X(){const i=document.getElementById("country-selector-container"),e=document.getElementById("country-selector");!i||!e||(i.classList.remove("hidden"),e.innerHTML=`
    <option value="">Selecione um pa√≠s...</option>
    ${z.map(t=>`
      <option value="${t.id}" ${s.countryId===t.id?"selected":""}>
        ${t.flag||"üè≥Ô∏è"} ${t.name}
      </option>
    `).join("")}
  `,e.addEventListener("change",t=>{const n=t.target.value;n&&(s.countryId=n,console.log(`üåç Pa√≠s selecionado: ${n}`))}),console.log("‚úÖ Seletor de pa√≠s renderizado"))}function S(){const i=document.getElementById("training-selector"),e=[{id:"conscript",...y.conscript},{id:"regular",...y.regular},{id:"elite",...y.elite}];i.innerHTML=e.map(t=>{const n=(t.modifiers.costs.production-1)*100;return`
      <button
        class="training-badge flex-1 px-4 py-3 rounded-lg border-2 transition-all ${s.trainingLevel===t.id?"border-brand-500 bg-brand-500/20 text-brand-400":"border-bg-ring bg-bg hover:border-slate-600"}"
        data-training="${t.id}"
        onclick="window.selectTrainingLevel('${t.id}')"
        title="${Y(t)}"
      >
        <div class="text-2xl mb-1">${t.icon}</div>
        <div class="text-xs font-bold mb-1">${t.name}</div>
        <div class="text-xs text-slate-400">${t.modifiers.recruitmentTurns} turno${t.modifiers.recruitmentTurns>1?"s":""}</div>
        <div class="text-xs font-semibold ${n<0?"text-green-400":n>0?"text-red-400":"text-slate-400"}">
          ${n>=0?"+":""}${n.toFixed(0)}% $
        </div>
      </button>
    `}).join("")}function Y(i){const e=(i.modifiers.costs.production-1)*100,t=(i.modifiers.stats.softAttack-1)*100,n=i.modifiers.recruitmentTurns;let a=`${i.name}
${i.description}

`;if(a+=`üí∞ Custo: ${e>=0?"+":""}${e.toFixed(0)}%
`,a+=`‚öîÔ∏è Stats: ${t>=0?"+":""}${t.toFixed(0)}%
`,a+=`‚è±Ô∏è Recrutamento: ${n} turno${n>1?"s":""}`,n>1){const o=(i.modifiers.recruitmentProgress*100).toFixed(1);a+=` (${o}% por turno)`}return a}window.selectTrainingLevel=function(i){s.trainingLevel=i,S(),x()};function q(){const i=document.getElementById("support-grid"),e=5;i.innerHTML="";for(let t=0;t<e;t++){const n=s.supportUnits[t],a=P(t,"support",n);i.appendChild(a)}j()}function L(){const i=document.getElementById("combat-grid"),e=25;i.innerHTML="";for(let t=0;t<e;t++){const n=s.combatUnits[t],a=P(t,"combat",n);i.appendChild(a)}j()}function P(i,e,t){const n=document.createElement("div");if(t){const a=e==="combat"?w[t.unitType]:k[t.unitType];n.className="unit-slot filled rounded-lg p-2 cursor-pointer flex flex-col items-center justify-center relative group";const c=a.icon.endsWith(".png")?`<img src="${a.icon}" alt="${a.name}" class="w-12 h-12 object-contain mb-1" />`:`<div class="text-3xl mb-1">${a.icon}</div>`;n.innerHTML=`
      ${c}
      <div class="text-[10px] font-medium text-center line-clamp-2 text-slate-300">${a.name.split(" ")[0]}</div>
      <div class="absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity">
        <button
          onclick="window.removeUnit(${i}, '${e}')"
          class="w-5 h-5 rounded-full bg-red-600 hover:bg-red-700 flex items-center justify-center text-white text-xs"
        >√ó</button>
      </div>
    `,n.addEventListener("mouseenter",r=>pe(r,a,e)),n.addEventListener("mouseleave",T),n.addEventListener("click",r=>{r.target.closest("button")||T()})}else n.className="unit-slot empty rounded-lg flex items-center justify-center cursor-pointer hover:border-brand-500",n.innerHTML=`
      <div class="text-2xl text-slate-600 group-hover:text-brand-500 transition-colors">+</div>
    `,n.onclick=()=>Z(i,e);return n}window.removeUnit=function(i,e){e==="combat"?(s.combatUnits.splice(i,1),L()):(s.supportUnits.splice(i,1),q()),x()};function Z(i,e){const t=e==="combat"?w:k,n=e==="combat"?"Unidade de Combate":"Unidade de Suporte",a=e==="combat"?25:5;if((e==="combat"?s.combatUnits.length:s.supportUnits.length)>=a){g("warning",`M√°ximo de ${a} unidades ${e==="combat"?"de combate":"de suporte"} atingido`);return}const c=`
    <div class="modal-backdrop fixed inset-0 z-50 flex items-center justify-center p-4" onclick="window.closeModal(event)">
      <div class="bg-bg-soft border border-bg-ring rounded-2xl max-w-4xl w-full max-h-[80vh] flex flex-col" onclick="event.stopPropagation()">
        <!-- Header -->
        <div class="border-b border-bg-ring p-6">
          <div class="flex items-center justify-between">
            <h2 class="text-2xl font-bold text-brand-500">Selecionar ${n}</h2>
            <button onclick="window.closeModal()" class="text-slate-400 hover:text-slate-200 text-2xl leading-none">√ó</button>
          </div>
        </div>

        <!-- Filters -->
        <div class="border-b border-bg-ring p-4">
          <div id="category-filters" class="flex gap-2 flex-wrap">
            ${te(t)}
          </div>
        </div>

        <!-- Units List -->
        <div class="flex-1 overflow-y-auto p-6">
          <div id="units-list" class="grid grid-cols-1 md:grid-cols-2 gap-3">
            ${R(t,i,e)}
          </div>
        </div>
      </div>
    </div>
  `,r=document.getElementById("modal-container");r.innerHTML=c,ie(t,i,e);const d=r.querySelector(".modal-backdrop > div > div");d&&d.addEventListener("scroll",()=>{T(!0)});const p=r.querySelector(".modal-backdrop");p&&p.addEventListener("mousemove",u=>{const l=p.querySelector(".modal-backdrop > div");l&&!l.contains(u.target)&&T(!0)})}function ee(i){return{air_support:"Suporte A√©reo",airborne_support:"Aerotransportado",fire_support:"Suporte de Fogo",reconnaissance:"Reconhecimento",logistics:"Log√≠stica",infantry:"Infantaria",motorized:"Motorizada",mechanized:"Mecanizada",armor:"Blindados",artillery:"Artilharia",special:"For√ßas Especiais",amphibious:"Anf√≠bios"}[i]||i.charAt(0).toUpperCase()+i.slice(1)}function te(i,e){const t=new Set;return Object.values(i).forEach(a=>t.add(a.category)),["Todas",...Array.from(t)].map(a=>`
    <button
      class="category-filter px-4 py-2 rounded-lg border transition-colors ${a==="Todas"?"border-brand-500 bg-brand-500/20 text-brand-400":"border-bg-ring bg-bg hover:border-slate-600"}"
      data-category="${a}"
    >
      ${a==="Todas"?"Todas":ee(a)}
    </button>
  `).join("")}function ie(i,e,t){const n=document.querySelectorAll(".category-filter");n.forEach(a=>{a.addEventListener("click",()=>{const o=a.dataset.category;n.forEach(r=>{r.classList.remove("border-brand-500","bg-brand-500/20","text-brand-400"),r.classList.add("border-bg-ring","bg-bg")}),a.classList.add("border-brand-500","bg-brand-500/20","text-brand-400"),a.classList.remove("border-bg-ring","bg-bg");const c=o==="Todas"?i:Object.fromEntries(Object.entries(i).filter(([r,d])=>d.category===o));document.getElementById("units-list").innerHTML=R(c,e,t)})})}function R(i,e,t){return Object.entries(i).map(([n,a])=>{const c=a.icon.endsWith(".png")?`<img src="${a.icon}" alt="${a.name}" class="w-16 h-16 object-contain" />`:`<div class="text-4xl">${a.icon}</div>`;return`
      <div
        class="unit-card bg-bg border border-bg-ring rounded-lg p-4 hover:shadow-lg transition-all"
        onclick="window.selectUnit('${n}', ${e}, '${t}')"
      >
        <div class="flex items-start gap-3">
          ${c}
          <div class="flex-1 min-w-0">
            <h3 class="font-bold text-slate-100 mb-1">${a.name}</h3>
            <div class="text-xs text-slate-400 space-y-1">
              <div>${a.composition.manpower} MP</div>
              <div class="text-green-400">$${(a.costs.production/1e6).toFixed(1)}M</div>
            </div>
          </div>
          <div class="text-right text-xs text-slate-500">
            <div>${a.category}</div>
          </div>
        </div>
      </div>
    `}).join("")}window.selectUnit=function(i,e,t){const n={id:I(),unitType:i,position:e};t==="combat"?(s.combatUnits.push(n),L()):(s.supportUnits.push(n),q()),closeModal(),x()};window.closeModal=function(i){(!i||i.target.classList.contains("modal-backdrop"))&&(T(!0),document.getElementById("modal-container").innerHTML="")};function j(){document.getElementById("combat-count").textContent=`${s.combatUnits.length}/25`,document.getElementById("support-count").textContent=`${s.supportUnits.length}/5`}function x(){const i=M.calculateDivisionStats(s,w,k,y);s.calculatedStats=i,document.querySelectorAll(".stat-value").forEach(n=>{n.classList.add("stat-updating"),setTimeout(()=>n.classList.remove("stat-updating"),400)});const t=i.combatStats.softAttack+i.combatStats.hardAttack;document.getElementById("stat-firepower").textContent=t.toFixed(0),document.getElementById("stat-defense").textContent=i.combatStats.defense.toFixed(0),document.getElementById("stat-organization").textContent=i.combatStats.organization.toFixed(0),document.getElementById("stat-hp").textContent=i.combatStats.hp.toFixed(0),document.getElementById("stat-width").textContent=i.combatStats.combatWidth.toFixed(0),document.getElementById("stat-manpower").textContent=i.manpower.total.toLocaleString(),document.getElementById("cost-production").textContent="$"+(i.costs.production/1e6).toFixed(2)+"M",document.getElementById("cost-maintenance").textContent="$"+(i.costs.maintenance/1e3).toFixed(0)+"k",ne(i.equipment)}function ne(i){const e=document.getElementById("equipment-list");if(Object.keys(i).length===0){e.innerHTML='<p class="text-slate-500 text-center py-4">Nenhuma unidade adicionada</p>';return}const t=Object.entries(i).filter(([n,a])=>a>0).sort((n,a)=>a[1]-n[1]).map(([n,a])=>`
      <div class="flex justify-between items-center py-1">
        <span class="text-slate-400">${W(n)}:</span>
        <span class="font-bold text-slate-200">${a}</span>
      </div>
    `).join("");e.innerHTML=t}function W(i){return{trucks:"Caminh√µes",utility_vehicles:"Utilit√°rios",apc:"APC",ifv:"IFV",light_tanks:"Tanques Leves",medium_tanks:"Tanques M√©dios",mbt:"MBT",artillery:"Artilharia",aa_guns:"AA",spg:"SPG",spaa:"SPAA",mlrs:"MLRS",atcms:"ATCMS",manpads:"MANPADS",attack_helicopters:"Helic√≥pteros Ataque",utility_helicopters:"Helic√≥pteros Utilit√°rios",small_arms:"Armas Pequenas",amtrac:"AMTRAC"}[i]||i}function ae(){const i=document.getElementById("division-name");i.value=s.name,i.addEventListener("input",a=>{s.name=a.target.value}),document.getElementById("btn-reset").addEventListener("click",H),document.getElementById("btn-validate").addEventListener("click",F),document.getElementById("btn-save").addEventListener("click",N);const e=document.getElementById("btn-save-template");e&&e.addEventListener("click",re);const t=document.getElementById("btn-duplicate");t&&t.addEventListener("click",duplicateDivision);const n=document.getElementById("templates-dropdown");n&&n.addEventListener("change",a=>{window.loadTemplate(a.target.value)}),oe()}function oe(){document.addEventListener("keydown",i=>{(i.ctrlKey||i.metaKey)&&i.key==="s"&&(i.preventDefault(),N(),g("info","üíæ Salvando divis√£o...")),(i.ctrlKey||i.metaKey)&&i.key==="r"&&(i.preventDefault(),H()),(i.ctrlKey||i.metaKey)&&i.key==="v"&&(i.preventDefault(),F()),(i.ctrlKey||i.metaKey)&&i.key==="d"&&(i.preventDefault(),duplicateDivision()),i.key==="Escape"&&window.closeModal(),i.key==="?"&&!i.target.matches("input, textarea")&&(i.preventDefault(),showKeyboardShortcutsHelp())})}window.showKeyboardShortcutsHelp=function(){const i=`
    <div class="modal-backdrop fixed inset-0 z-50 flex items-center justify-center p-4" onclick="window.closeModal(event)">
      <div class="bg-bg-soft border border-bg-ring rounded-2xl max-w-md w-full p-6" onclick="event.stopPropagation()">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-2xl font-bold text-brand-500">‚å®Ô∏è Atalhos de Teclado</h2>
          <button onclick="window.closeModal()" class="text-slate-400 hover:text-slate-200 text-2xl">√ó</button>
        </div>

        <div class="space-y-3 text-sm">
          <div class="flex justify-between items-center py-2 border-b border-bg-ring">
            <span class="text-slate-300">Salvar Divis√£o</span>
            <kbd class="px-2 py-1 bg-bg rounded font-mono text-brand-400">Ctrl + S</kbd>
          </div>
          <div class="flex justify-between items-center py-2 border-b border-bg-ring">
            <span class="text-slate-300">Validar Divis√£o</span>
            <kbd class="px-2 py-1 bg-bg rounded font-mono text-brand-400">Ctrl + V</kbd>
          </div>
          <div class="flex justify-between items-center py-2 border-b border-bg-ring">
            <span class="text-slate-300">Resetar Divis√£o</span>
            <kbd class="px-2 py-1 bg-bg rounded font-mono text-brand-400">Ctrl + R</kbd>
          </div>
          <div class="flex justify-between items-center py-2 border-b border-bg-ring">
            <span class="text-slate-300">Duplicar Divis√£o</span>
            <kbd class="px-2 py-1 bg-bg rounded font-mono text-brand-400">Ctrl + D</kbd>
          </div>
          <div class="flex justify-between items-center py-2 border-b border-bg-ring">
            <span class="text-slate-300">Fechar Modal</span>
            <kbd class="px-2 py-1 bg-bg rounded font-mono text-brand-400">Esc</kbd>
          </div>
          <div class="flex justify-between items-center py-2">
            <span class="text-slate-300">Mostrar Atalhos</span>
            <kbd class="px-2 py-1 bg-bg rounded font-mono text-brand-400">?</kbd>
          </div>
        </div>

        <div class="mt-6 text-center">
          <button onclick="window.closeModal()" class="px-6 py-2 bg-brand-500 hover:bg-brand-600 rounded-lg font-medium transition-colors">
            Entendido
          </button>
        </div>
      </div>
    </div>
  `;document.getElementById("modal-container").innerHTML=i};async function H(){await B("Resetar Divis√£o","Tem certeza que deseja limpar toda a divis√£o?")&&(s.combatUnits=[],s.supportUnits=[],s.name="Nova Divis√£o",s.trainingLevel="regular",document.getElementById("division-name").value="Nova Divis√£o",S(),L(),q(),x(),g("success","Divis√£o resetada"))}function F(){const i=b.validate(s,w,k,y),e=b.generateReport(i),t=document.getElementById("division-name");t.classList.remove("border-red-500","border-yellow-500","border-green-500"),i.valid?i.warnings.length>0?(t.classList.add("border-yellow-500"),g("warning",`Divis√£o v√°lida com avisos:

`+e)):(t.classList.add("border-green-500"),g("success",`Divis√£o v√°lida!

`+e)):(t.classList.add("border-red-500"),g("error",`Divis√£o inv√°lida:

`+e),se()),setTimeout(()=>{t.classList.remove("border-red-500","border-yellow-500","border-green-500")},3e3)}function se(i){if(s.calculatedStats){const e=s.calculatedStats.combatStats;if(e.combatWidth>40){const t=document.getElementById("stat-width");t.classList.add("text-red-400","font-bold"),setTimeout(()=>t.classList.remove("text-red-400","font-bold"),3e3)}if(e.organization<20){const t=document.getElementById("stat-organization");t.classList.add("text-red-400","font-bold"),setTimeout(()=>t.classList.remove("text-red-400","font-bold"),3e3)}}}async function N(){const i=document.getElementById("btn-save"),e=i.textContent;try{const t=b.validate(s,w,k,y);if(!t.valid){const m=b.generateReport(t);g("error",`N√£o √© poss√≠vel salvar divis√£o inv√°lida:

`+m);return}if(t.warnings.length>0){const m=b.generateReport(t);if(!await B("Avisos de Valida√ß√£o",m+`

Deseja continuar mesmo assim?`,"Sim, salvar","Cancelar"))return}if(i.disabled=!0,i.innerHTML=`
      <svg class="animate-spin h-4 w-4 inline-block mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
      </svg>
      Salvando...
    `,!window.db)throw new Error("Firestore n√£o est√° inicializado. Recarregue a p√°gina.");let n;if(v?.isNarrator||v?.isAdmin){if(n=s.countryId,!n)throw new Error("Selecione um pa√≠s para salvar a divis√£o.")}else{if(!h||!h.id)throw new Error("Pa√≠s do usu√°rio n√£o est√° carregado. Recarregue a p√°gina.");n=h.id}const a=!s.id;a&&(s.id=`div_${Date.now()}_${Math.random().toString(36).substr(2,9)}`);const o=y[s.trainingLevel],c=o.modifiers.recruitmentTurns,r=o.modifiers.recruitmentProgress,d={id:s.id,name:s.name,countryId:s.countryId,trainingLevel:s.trainingLevel,combatUnits:s.combatUnits,supportUnits:s.supportUnits,calculatedStats:s.calculatedStats,updatedAt:new Date().toISOString(),recruitmentStatus:s.recruitmentStatus||"recruiting",recruitment:s.recruitment||{totalTurns:c,currentTurn:0,progressPerTurn:r,progress:0,startedAt:new Date().toISOString(),trainingLevel:s.trainingLevel}};a?d.createdAt=new Date().toISOString():d.createdAt=s.createdAt,console.log("üì¶ Salvando divis√£o no invent√°rio (compat):",n);const p=A().collection("inventory").doc(n);console.log("üìñ Tentando obter inventoryDoc com .get()...");const u=await p.get();if(console.log("‚úÖ inventoryDoc obtido, exists:",u.exists),!u.exists)console.log("‚ûï Criando novo invent√°rio com .set()"),await p.set({country_id:n,divisions:[d]}),console.log("‚úÖ Invent√°rio criado com sucesso");else{console.log("üîÑ Atualizando invent√°rio existente");let _=u.data().divisions||[];if(a)console.log("‚ûï Adicionando nova divis√£o"),_.push(d);else{console.log("üîÑ Atualizando divis√£o existente");const C=_.findIndex(V=>V.id===s.id);C!==-1?_[C]=d:_.push(d)}console.log("üíæ Tentando atualizar com .update()..."),await p.update({divisions:_}),console.log("‚úÖ Invent√°rio atualizado com sucesso")}i.innerHTML=`
      <svg class="h-4 w-4 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
      </svg>
      Salvo!
    `;let l="‚úÖ Divis√£o salva com sucesso!";(v?.isNarrator||v?.isAdmin)&&(l=`‚úÖ Divis√£o salva para ${z.find(_=>_.id===n)?.name||n}!`),g("success",l),setTimeout(()=>{i.disabled=!1,i.textContent=e},2e3)}catch(t){console.error("Erro ao salvar divis√£o:",t),g("error","Erro ao salvar: "+t.message),i.disabled=!1,i.textContent=e}}async function re(){try{if(!b.validate(s,w,k,y).valid){g("error","N√£o √© poss√≠vel salvar template de divis√£o inv√°lida");return}const e=prompt("Nome do template:",s.name+" (Template)");if(!e)return;const t=A().collection("division_templates"),n={name:e,countryId:h.id,isPublic:!1,trainingLevel:s.trainingLevel,combatUnits:s.combatUnits.map(o=>({unitType:o.unitType})),supportUnits:s.supportUnits.map(o=>({unitType:o.unitType})),createdAt:new Date().toISOString()},a=await t.add(n);g("success","‚úÖ Template salvo com sucesso!"),await O()}catch(i){console.error("Erro ao salvar template:",i),g("error","Erro ao salvar template: "+i.message)}}async function O(){try{const i=Object.values(E);if(h&&h.id)try{(await A().collection("division_templates").where("countryId","==",h.id).orderBy("createdAt","desc").get()).forEach(a=>{i.push({id:a.id,...a.data(),isCustom:!0})})}catch(e){console.warn("Erro ao carregar templates customizados:",e)}return D(i),i}catch(i){console.error("Erro ao carregar templates:",i);const e=Object.values(E);return D(e),e}}function D(i){const e=document.getElementById("templates-dropdown");if(!e){console.warn("Elemento templates-dropdown n√£o encontrado");return}if(!i||i.length===0){e.innerHTML='<option value="">Nenhum template dispon√≠vel</option>';return}const t=i.filter(o=>!o.isCustom),n=i.filter(o=>o.isCustom);let a='<option value="">Selecione um template...</option>';t.length>0&&(a+='<optgroup label="üìã Templates B√°sicos">',a+=t.map(o=>`<option value="${o.id}">${o.name}</option>`).join(""),a+="</optgroup>"),n.length>0&&(a+='<optgroup label="‚≠ê Meus Templates">',a+=n.map(o=>`<option value="${o.id}">${o.name}</option>`).join(""),a+="</optgroup>"),e.innerHTML=a}window.loadTemplate=async function(i){if(i)try{let e=null;if(E[i])e=E[i],console.log("Carregando template b√°sico:",e.name);else{const n=await A().collection("division_templates").doc(i).get();if(!n.exists){g("error","Template n√£o encontrado");return}e=n.data(),console.log("Carregando template customizado:",e.name)}s.name=e.name.replace(" (Template)",""),s.trainingLevel=e.trainingLevel,s.combatUnits=e.combatUnits.map((t,n)=>({id:I(),unitType:t.unitType,position:n})),s.supportUnits=e.supportUnits.map((t,n)=>({id:I(),unitType:t.unitType,position:n})),document.getElementById("division-name").value=s.name,S(),L(),q(),x(),g("success",`‚úÖ Template "${e.name}" carregado!`)}catch(e){console.error("Erro ao carregar template:",e),g("error","Erro ao carregar template: "+e.message)}};window.duplicateDivision=async function(i){try{const e=window.db.collection("inventory").doc(h.id),t=await e.get();if(!t.exists)throw new Error("Invent√°rio do pa√≠s n√£o encontrado.");const n=t.data().divisions||[],a=n.find(r=>r.id===i);if(!a){g("error","Divis√£o n√£o encontrada para duplicar.");return}const o={...a,id:`div_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:a.name+" (C√≥pia)",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},c=[...n,o];await e.update({divisions:c}),g("success","‚úÖ Divis√£o duplicada!"),await loadDivisions()}catch(e){console.error("Erro ao duplicar divis√£o:",e),g("error","Erro ao duplicar: "+e.message)}};function I(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}function ce(){const i=document.getElementById("initial-loading");i&&(i.style.opacity="0",setTimeout(()=>i.style.display="none",500))}let f=null;function pe(i,e,t){f&&(clearTimeout(f),f=null),T(!0);const n=document.createElement("div");n.id="unit-tooltip",n.className="fixed z-[100] bg-bg-soft border-2 border-brand-500 rounded-lg p-4 shadow-2xl max-w-sm pointer-events-none";let c=`
    <div class="space-y-3">
      <div class="flex items-center gap-3 border-b border-bg-ring pb-2">
        ${e.icon.endsWith(".png")?`<img src="${e.icon}" alt="${e.name}" class="w-16 h-16 object-contain" />`:`<div class="text-4xl">${e.icon}</div>`}
        <div>
          <h3 class="font-bold text-brand-400 text-lg">${e.name}</h3>
          <p class="text-xs text-slate-400">${e.category}</p>
        </div>
      </div>

      <div class="grid grid-cols-2 gap-2 text-xs">
        <div class="bg-bg rounded p-2">
          <p class="text-slate-500">Manpower</p>
          <p class="font-bold text-slate-100">${e.composition.manpower.toLocaleString()}</p>
        </div>
        <div class="bg-bg rounded p-2">
          <p class="text-slate-500">Produ√ß√£o</p>
          <p class="font-bold text-green-400">$${(e.costs.production/1e6).toFixed(1)}M</p>
        </div>
      </div>
  `;t==="combat"&&e.stats?c+=`
      <div class="border-t border-bg-ring pt-2">
        <p class="text-xs font-bold text-slate-300 mb-2">Combat Stats:</p>
        <div class="grid grid-cols-2 gap-x-4 gap-y-1 text-xs">
          ${e.stats.softAttack?`<div><span class="text-slate-500">Soft Attack:</span> <span class="text-slate-200">${e.stats.softAttack}</span></div>`:""}
          ${e.stats.hardAttack?`<div><span class="text-slate-500">Hard Attack:</span> <span class="text-slate-200">${e.stats.hardAttack}</span></div>`:""}
          ${e.stats.defense?`<div><span class="text-slate-500">Defense:</span> <span class="text-slate-200">${e.stats.defense}</span></div>`:""}
          ${e.stats.breakthrough?`<div><span class="text-slate-500">Breakthrough:</span> <span class="text-slate-200">${e.stats.breakthrough}</span></div>`:""}
          ${e.stats.organization?`<div><span class="text-slate-500">Organization:</span> <span class="text-slate-200">${e.stats.organization}</span></div>`:""}
          ${e.stats.combatWidth?`<div><span class="text-slate-500">Width:</span> <span class="text-slate-200">${e.stats.combatWidth}</span></div>`:""}
        </div>
      </div>
    `:t==="support"&&e.divisionBonuses&&(c+=`
      <div class="border-t border-bg-ring pt-2">
        <p class="text-xs font-bold text-brand-400 mb-2">Division Bonuses:</p>
        <div class="grid grid-cols-2 gap-x-4 gap-y-1 text-xs">
          ${Object.entries(e.divisionBonuses).map(([l,m])=>`
            <div><span class="text-slate-500">${l}:</span> <span class="text-green-400">+${m}</span></div>
          `).join("")}
        </div>
      </div>
    `),e.composition.equipment&&Object.keys(e.composition.equipment).length>0&&(c+=`
      <div class="border-t border-bg-ring pt-2">
        <p class="text-xs font-bold text-slate-300 mb-2">Equipment:</p>
        <div class="space-y-1 text-xs">
          ${Object.entries(e.composition.equipment).map(([l,m])=>`
            <div class="flex justify-between">
              <span class="text-slate-400">${W(l)}</span>
              <span class="text-slate-200">${m}</span>
            </div>
          `).join("")}
        </div>
      </div>
    `),c+="</div>",n.innerHTML=c,document.body.appendChild(n);const r=i.currentTarget.getBoundingClientRect(),d=n.getBoundingClientRect();let p=r.right+10,u=r.top;p+d.width>window.innerWidth&&(p=r.left-d.width-10),u+d.height>window.innerHeight&&(u=window.innerHeight-d.height-10),n.style.left=p+"px",n.style.top=u+"px",n.style.opacity="0",f=setTimeout(()=>{n.parentElement&&(n.style.transition="opacity 0.2s",n.style.opacity="1")},100)}function T(i=!1){f&&(clearTimeout(f),f=null);const e=document.getElementById("unit-tooltip");e&&(i?e.remove():(e.style.opacity="0",f=setTimeout(()=>{e.parentElement&&e.remove()},200)))}export{le as initDivisionCreator};
