import{db as b}from"./firebase-BN3MSMQD.js";import{a as p,s as d}from"./utils-DLoRv3re.js";import{C as m}from"./consumerGoodsCalculator-RQh-OK8I.js";import"./preload-helper-f85Crcwt.js";import"https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js";import"https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js";import"https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js";import"https://www.gstatic.com/firebasejs/10.12.2/firebase-storage-compat.js";import"https://www.gstatic.com/firebasejs/10.12.2/firebase-functions-compat.js";async function N(){try{if(!await p("Aplicar Efeitos de Bens de Consumo","Esta a√ß√£o ir√° calcular os bens de consumo para todos os pa√≠ses e aplicar os efeitos de estabilidade (+3% at√© -5%). Esta opera√ß√£o pode ser executada a cada turno. Continuar?","Sim, aplicar efeitos","Cancelar")){d("info","Opera√ß√£o cancelada pelo usu√°rio.");return}d("info","Iniciando c√°lculo de bens de consumo..."),console.log("=== CALCULANDO BENS DE CONSUMO E EFEITOS DE ESTABILIDADE ===");const c=await b.collection("paises").get(),l=b.batch(),r=[];let t=0;c.forEach(a=>{const n=a.data(),i=n.Pais||n.Nome||a.id;try{const o=m.calculateConsumerGoods(n),e=m.applyStabilityEffect(n),f=m.generateConsumerGoodsReport(n),E={BensDeConsumo:o.level,Estabilidade:e.newStability,BensDeConsumoCalculado:{timestamp:o.metadata.calculatedAt,production:o.production,demand:o.demand,satisfactionLevel:f.analysis.satisfactionLevel,stabilityEffect:e.stabilityEffect,effectDescription:e.effectDescription}};l.update(a.ref,E),t++,r.push({country:i,consumerGoods:o,stabilityEffect:e,report:f}),console.log(`${i}:`,{bens_de_consumo:`${o.level}%`,nivel_satisfacao:f.analysis.satisfactionLevel,estabilidade_anterior:e.currentStability,efeito_estabilidade:`${e.stabilityEffect>0?"+":""}${e.stabilityEffect}%`,nova_estabilidade:e.newStability,descricao:e.effectDescription,producao_vs_demanda:`${o.production}/${o.demand}`})}catch(o){console.error(`Erro ao calcular bens de consumo para ${i}:`,o)}}),t>0?(await l.commit(),d("success",`Bens de consumo calculados para ${t} pa√≠ses!`),y(r),console.log(`‚úÖ Bens de consumo aplicados com sucesso para ${t} pa√≠ses`)):d("warning","Nenhum pa√≠s foi processado.")}catch(s){console.error("Erro ao aplicar bens de consumo:",s),d("error",`Erro: ${s.message}`)}}function y(s){console.log(`
=== ESTAT√çSTICAS DE BENS DE CONSUMO ===`);const c=s.map(o=>({country:o.country,level:o.consumerGoods.level,stabilityEffect:o.stabilityEffect.stabilityEffect,satisfaction:o.report.analysis.satisfactionLevel})).sort((o,e)=>e.level-o.level);console.log(`
üèÜ TOP 10 MELHORES BENS DE CONSUMO:`),c.slice(0,10).forEach((o,e)=>{console.log(`${e+1}. ${o.country} - ${o.level}% (${o.satisfaction})`)}),console.log(`
üìâ TOP 10 PIORES BENS DE CONSUMO:`),c.slice(-10).reverse().forEach((o,e)=>{console.log(`${e+1}. ${o.country} - ${o.level}% (${o.satisfaction})`)});const l={};s.forEach(o=>{const e=o.report.analysis.satisfactionLevel;l[e]||(l[e]=[]),l[e].push(o)}),console.log(`
üìä PA√çSES POR N√çVEL DE SATISFA√á√ÉO:`),Object.entries(l).forEach(([o,e])=>{const f=Math.round(e.reduce((E,u)=>E+u.consumerGoods.level,0)/e.length);console.log(`${o}: ${e.length} pa√≠ses (m√©dia: ${f}%)`)});const r=s.filter(o=>o.stabilityEffect.stabilityEffect>0).sort((o,e)=>e.stabilityEffect.stabilityEffect-o.stabilityEffect.stabilityEffect),t=s.filter(o=>o.stabilityEffect.stabilityEffect<0).sort((o,e)=>o.stabilityEffect.stabilityEffect-e.stabilityEffect.stabilityEffect);r.length>0&&(console.log(`
‚úÖ PA√çSES COM GANHO DE ESTABILIDADE:`),r.slice(0,10).forEach(o=>{console.log(`${o.country}: +${o.stabilityEffect.stabilityEffect}% (${o.consumerGoods.level}% bens)`)})),t.length>0&&(console.log(`
‚ö†Ô∏è PA√çSES COM PERDA DE ESTABILIDADE:`),t.slice(0,10).forEach(o=>{console.log(`${o.country}: ${o.stabilityEffect.stabilityEffect}% (${o.consumerGoods.level}% bens)`)}));const a=Math.round(s.reduce((o,e)=>o+e.consumerGoods.level,0)/s.length),n=s.filter(o=>o.consumerGoods.level<15).length,i=s.filter(o=>o.consumerGoods.level>=85).length;console.log(`
üìà ESTAT√çSTICAS GERAIS:`),console.log(`N√≠vel m√©dio de bens de consumo: ${a}%`),console.log(`Pa√≠ses em crise (< 15%): ${n}`),console.log(`Pa√≠ses com excel√™ncia (‚â• 85%): ${i}`),console.log(`Efeito estabilidade m√©dio: ${Math.round(s.reduce((o,e)=>o+e.stabilityEffect.stabilityEffect,0)/s.length*100)/100}%`)}async function G(s=5){try{console.log(`
=== SIMULA√á√ÉO DE BENS DE CONSUMO - ${s} TURNOS ===`);const c=await b.collection("paises").get(),l=[];c.forEach(t=>{const a=t.data(),n=a.Pais||a.Nome||t.id;let i=parseFloat(a.Estabilidade)||50;const o={country:n,initialStability:i,turns:[]};for(let e=1;e<=s;e++){const f={...a,Estabilidade:i},E=m.calculateConsumerGoods(f),u=m.applyStabilityEffect(f);i=u.newStability,o.turns.push({turn:e,consumerGoods:E.level,stabilityEffect:u.stabilityEffect,newStability:i})}o.finalStability=i,o.totalChange=i-o.initialStability,l.push(o)});const r=l.sort((t,a)=>Math.abs(a.totalChange)-Math.abs(t.totalChange)).slice(0,10);console.log(`
üìä MAIORES MUDAN√áAS DE ESTABILIDADE EM ${s} TURNOS:`),r.forEach(t=>{const a=t.totalChange>0?`+${t.totalChange.toFixed(1)}`:t.totalChange.toFixed(1);console.log(`${t.country}: ${t.initialStability.toFixed(1)}% ‚Üí ${t.finalStability.toFixed(1)}% (${a}%)`)}),d("success",`Simula√ß√£o conclu√≠da: maiores mudan√ßas de ${Math.abs(r[0]?.totalChange||0).toFixed(1)}%`)}catch(c){console.error("Erro na simula√ß√£o:",c),d("error","Erro na simula√ß√£o: "+c.message)}}export{N as applyConsumerGoodsEffects,G as simulateConsumerGoodsOverTime};
