const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/firebase-BN3MSMQD.js","assets/preload-helper-f85Crcwt.js","assets/utils-DLoRv3re.js"])))=>i.map(i=>d[i]);
import{_ as f}from"./preload-helper-f85Crcwt.js";import{t as h}from"./training_levels-0GuzqOdX.js";import{s as u,a as S}from"./utils-DLoRv3re.js";const y={irregulares:{id:"irregulares",name:"Irregulares",nameEn:"Irregulars",category:"infantry",subcategory:"light",composition:{manpower:1e3,equipment:{small_arms:1e3,light_mg:50}},costs:{production:3e5,maintenance:15e3},stats:{softAttack:15,hardAttack:1,defense:20,breakthrough:8,armor:0,piercing:1,hp:8,organization:50,recovery:.3,reconnaissance:3,suppression:8,weight:.1,combatWidth:2},requirements:{minTechLevel:0,requiredTech:[],incompatibleWith:[]},icon:"üéñÔ∏è",color:"#78716c"},infantaria_linha:{id:"infantaria_linha",name:"Infantaria de Linha",nameEn:"Line Infantry",category:"infantry",subcategory:"standard",composition:{manpower:800,equipment:{small_arms:800,light_mg:80,mortars:12}},costs:{production:6e5,maintenance:3e4},stats:{softAttack:20,hardAttack:2,defense:25,breakthrough:12,armor:0,piercing:1,hp:10,organization:60,recovery:.4,reconnaissance:2,suppression:10,weight:.15,combatWidth:2},requirements:{minTechLevel:1},icon:"ü™ñ",color:"#4a7c59"},infantaria_leve:{id:"infantaria_leve",name:"Infantaria Leve",nameEn:"Light Infantry",category:"infantry",subcategory:"light",composition:{manpower:800,equipment:{small_arms:800,light_mg:60,mortars:8}},costs:{production:6e5,maintenance:3e4},stats:{softAttack:18,hardAttack:1,defense:22,breakthrough:10,armor:0,piercing:1,hp:9,organization:65,recovery:.45,reconnaissance:4,suppression:8,weight:.12,combatWidth:2},requirements:{minTechLevel:1},icon:"üéØ",color:"#6b8e23"},tropa_choque:{id:"tropa_choque",name:"Tropa de Choque",nameEn:"Shock Troops",category:"infantry",subcategory:"elite",composition:{manpower:800,equipment:{small_arms:800,light_mg:100,mortars:16,explosives:400}},costs:{production:8e5,maintenance:4e4},stats:{softAttack:28,hardAttack:4,defense:20,breakthrough:20,armor:0,piercing:2,hp:11,organization:55,recovery:.35,reconnaissance:2,suppression:15,weight:.18,combatWidth:2},requirements:{minTechLevel:2},icon:"üí•",color:"#dc2626"},montanhistas:{id:"montanhistas",name:"Montanhistas",nameEn:"Mountain Infantry",category:"infantry",subcategory:"special",composition:{manpower:800,equipment:{small_arms:800,light_mg:70,mortars:10,climbing_gear:800}},costs:{production:8e5,maintenance:4e4},stats:{softAttack:19,hardAttack:2,defense:28,breakthrough:10,armor:0,piercing:1,hp:10,organization:70,recovery:.4,reconnaissance:3,suppression:9,weight:.14,combatWidth:2},requirements:{minTechLevel:2},icon:"‚õ∞Ô∏è",color:"#8b7355"},paraquedistas:{id:"paraquedistas",name:"Paraquedistas",nameEn:"Paratroopers",category:"infantry",subcategory:"special",composition:{manpower:800,equipment:{small_arms:800,light_mg:80,mortars:12,parachutes:800}},costs:{production:8e5,maintenance:4e4},stats:{softAttack:22,hardAttack:3,defense:23,breakthrough:14,armor:0,piercing:2,hp:10,organization:65,recovery:.42,reconnaissance:4,suppression:11,weight:.13,combatWidth:2},requirements:{minTechLevel:2},icon:"ü™Ç",color:"#1e40af"},fuzileiros_navais:{id:"fuzileiros_navais",name:"Fuzileiros Navais",nameEn:"Marines",category:"infantry",subcategory:"special",composition:{manpower:800,equipment:{small_arms:800,light_mg:85,mortars:14,amphibious_gear:800}},costs:{production:8e5,maintenance:4e4},stats:{softAttack:24,hardAttack:3,defense:26,breakthrough:15,armor:0,piercing:2,hp:11,organization:68,recovery:.43,reconnaissance:3,suppression:12,weight:.16,combatWidth:2},requirements:{minTechLevel:2},icon:"‚öì",color:"#1e3a8a"},infantaria_motorizada:{id:"infantaria_motorizada",name:"Infantaria Motorizada",nameEn:"Motorized Infantry",category:"motorized",subcategory:"standard",composition:{manpower:800,equipment:{trucks:40,small_arms:800,light_mg:80,mortars:16}},costs:{production:1e6,maintenance:5e4},stats:{softAttack:25,hardAttack:2,defense:30,breakthrough:15,armor:0,piercing:1,hp:10,organization:60,recovery:.4,reconnaissance:2,suppression:12,weight:.8,combatWidth:2},requirements:{minTechLevel:2},icon:"üöõ",color:"#92400e"},carro_armado_irregulares:{id:"carro_armado_irregulares",name:"Carro Armado (Irregulares)",nameEn:"Gun Truck (Irregulars)",category:"motorized",subcategory:"light",composition:{manpower:800,equipment:{utility_vehicles:120,small_arms:800,light_mg:120,heavy_mg:40}},costs:{production:8e5,maintenance:4e4},stats:{softAttack:28,hardAttack:3,defense:22,breakthrough:16,armor:2,piercing:3,hp:9,organization:55,recovery:.38,reconnaissance:4,suppression:14,weight:.6,combatWidth:2},requirements:{minTechLevel:1},icon:"üöô",color:"#78350f"},carro_armado:{id:"carro_armado",name:"Carro Armado",nameEn:"Gun Truck",category:"motorized",subcategory:"standard",composition:{manpower:800,equipment:{utility_vehicles:160,small_arms:800,light_mg:160,heavy_mg:60,autocannons:20}},costs:{production:1e6,maintenance:5e4},stats:{softAttack:32,hardAttack:5,defense:25,breakthrough:18,armor:3,piercing:4,hp:10,organization:58,recovery:.4,reconnaissance:5,suppression:16,weight:.7,combatWidth:2},requirements:{minTechLevel:2},icon:"üõª",color:"#a16207"},mecanizada_leve_apc:{id:"mecanizada_leve_apc",name:"Infantaria Mecanizada Leve (APC)",nameEn:"Light Mechanized (APC)",category:"mechanized",subcategory:"apc",composition:{manpower:800,equipment:{apc:100,small_arms:800,light_mg:100}},costs:{production:2e6,maintenance:1e5},stats:{softAttack:30,hardAttack:4,defense:35,breakthrough:20,armor:10,piercing:5,hp:12,organization:65,recovery:.42,reconnaissance:3,suppression:14,weight:1.2,combatWidth:2},requirements:{minTechLevel:3},icon:"üöú",color:"#15803d"},mecanizada_ifv:{id:"mecanizada_ifv",name:"Infantaria Mecanizada (IFV)",nameEn:"Mechanized Infantry (IFV)",category:"mechanized",subcategory:"ifv",composition:{manpower:800,equipment:{ifv:100,small_arms:800,autocannons:100,atgm:50}},costs:{production:3e6,maintenance:15e4},stats:{softAttack:38,hardAttack:12,defense:40,breakthrough:25,armor:15,piercing:20,hp:14,organization:68,recovery:.45,reconnaissance:4,suppression:16,weight:1.5,combatWidth:2},requirements:{minTechLevel:4},icon:"üõ°Ô∏è",color:"#166534"},tanque_leve:{id:"tanque_leve",name:"Tanque Leve",nameEn:"Light Tank",category:"armor",subcategory:"light",composition:{manpower:300,equipment:{light_tanks:60}},costs:{production:4e6,maintenance:2e5},stats:{softAttack:25,hardAttack:20,defense:30,breakthrough:35,armor:30,piercing:40,hp:12,organization:50,recovery:.35,reconnaissance:8,suppression:10,weight:2.5,combatWidth:2},requirements:{minTechLevel:3},icon:"üöó",color:"#713f12"},tanque_medio:{id:"tanque_medio",name:"Tanque M√©dio",nameEn:"Medium Tank",category:"armor",subcategory:"medium",composition:{manpower:400,equipment:{medium_tanks:80}},costs:{production:16e5,maintenance:8e4},stats:{softAttack:30,hardAttack:35,defense:40,breakthrough:45,armor:60,piercing:70,hp:15,organization:55,recovery:.38,reconnaissance:6,suppression:12,weight:3.5,combatWidth:2},requirements:{minTechLevel:3},icon:"üöô",color:"#854d0e"},tanque_mbt:{id:"tanque_mbt",name:"Tanque (MBT)",nameEn:"Main Battle Tank",category:"armor",subcategory:"mbt",composition:{manpower:300,equipment:{mbt:60}},costs:{production:6e6,maintenance:3e5},stats:{softAttack:35,hardAttack:50,defense:50,breakthrough:60,armor:90,piercing:100,hp:18,organization:58,recovery:.4,reconnaissance:7,suppression:15,weight:4.5,combatWidth:2},requirements:{minTechLevel:4},icon:"üõ°Ô∏è",color:"#a16207"},tanque_anfibio:{id:"tanque_anfibio",name:"Tanque Anf√≠bio",nameEn:"Amphibious Tank",category:"armor",subcategory:"amphibious",composition:{manpower:400,equipment:{amphibious_tanks:60}},costs:{production:4e6,maintenance:2e5},stats:{softAttack:28,hardAttack:25,defense:35,breakthrough:38,armor:40,piercing:50,hp:14,organization:52,recovery:.37,reconnaissance:7,suppression:11,weight:3,combatWidth:2},requirements:{minTechLevel:3},icon:"üõ∂",color:"#0c4a6e"},bateria_antiaerea:{id:"bateria_antiaerea",name:"Bateria Antia√©rea",nameEn:"Anti-Aircraft Battery",category:"artillery",subcategory:"aa",composition:{manpower:400,equipment:{aa_guns:24,trucks:24}},costs:{production:1e6,maintenance:5e4},stats:{softAttack:5,hardAttack:2,defense:15,breakthrough:5,armor:0,piercing:10,hp:8,organization:45,recovery:.3,reconnaissance:1,suppression:5,weight:.6,combatWidth:1},requirements:{minTechLevel:2},icon:"üéØ",color:"#713f12"},bateria_artilharia:{id:"bateria_artilharia",name:"Bateria de Artilharia",nameEn:"Artillery Battery",category:"artillery",subcategory:"howitzer",composition:{manpower:400,equipment:{artillery:24,trucks:24}},costs:{production:1e6,maintenance:5e4},stats:{softAttack:40,hardAttack:8,defense:12,breakthrough:6,armor:0,piercing:5,hp:8,organization:40,recovery:.3,reconnaissance:1,suppression:8,weight:.8,combatWidth:1},requirements:{minTechLevel:2},icon:"üéØ",color:"#92400e"},lancador_foguete:{id:"lancador_foguete",name:"Lan√ßador de Foguete",nameEn:"Rocket Launcher",category:"artillery",subcategory:"rocket",composition:{manpower:400,equipment:{rocket_launchers:24,trucks:24}},costs:{production:2e6,maintenance:1e5},stats:{softAttack:50,hardAttack:10,defense:10,breakthrough:8,armor:0,piercing:6,hp:7,organization:38,recovery:.28,reconnaissance:1,suppression:10,weight:.9,combatWidth:1},requirements:{minTechLevel:3},icon:"üöÄ",color:"#b45309"},grupo_atcms:{id:"grupo_atcms",name:"Grupo de Armas (ATCMS)",nameEn:"ATGM Group",category:"artillery",subcategory:"atgm",composition:{manpower:400,equipment:{atcms:36,trucks:18}},costs:{production:2e6,maintenance:1e5},stats:{softAttack:15,hardAttack:35,defense:18,breakthrough:10,armor:0,piercing:60,hp:8,organization:42,recovery:.32,reconnaissance:2,suppression:6,weight:.7,combatWidth:1},requirements:{minTechLevel:4},icon:"üéØ",color:"#dc2626"},grupo_manpad:{id:"grupo_manpad",name:"Grupo MANPAD",nameEn:"MANPAD Group",category:"artillery",subcategory:"manpad",composition:{manpower:400,equipment:{manpads:36,trucks:12}},costs:{production:22e5,maintenance:11e4},stats:{softAttack:8,hardAttack:3,defense:16,breakthrough:6,armor:0,piercing:12,hp:7,organization:43,recovery:.31,reconnaissance:2,suppression:5,weight:.5,combatWidth:1},requirements:{minTechLevel:4},icon:"üéØ",color:"#ef4444"},mlrs:{id:"mlrs",name:"MLRS",nameEn:"Multiple Rocket Launch System",category:"artillery",subcategory:"mlrs",composition:{manpower:400,equipment:{mlrs:32}},costs:{production:1e7,maintenance:5e5},stats:{softAttack:80,hardAttack:15,defense:8,breakthrough:10,armor:5,piercing:10,hp:10,organization:35,recovery:.25,reconnaissance:1,suppression:15,weight:2,combatWidth:2},requirements:{minTechLevel:5},icon:"üöÄ",color:"#991b1b"},spg:{id:"spg",name:"Artilharia Autopropulsada (SPG)",nameEn:"Self-Propelled Gun",category:"artillery",subcategory:"spg",composition:{manpower:400,equipment:{spg:32}},costs:{production:6e6,maintenance:3e5},stats:{softAttack:55,hardAttack:12,defense:20,breakthrough:15,armor:20,piercing:15,hp:12,organization:45,recovery:.35,reconnaissance:2,suppression:12,weight:2.5,combatWidth:2},requirements:{minTechLevel:4},icon:"üöú",color:"#a16207"},spaa:{id:"spaa",name:"Artilharia AA Autopropulsada (SPAA)",nameEn:"Self-Propelled Anti-Aircraft",category:"artillery",subcategory:"spaa",composition:{manpower:400,equipment:{spaa:32}},costs:{production:6e6,maintenance:3e5},stats:{softAttack:10,hardAttack:4,defense:25,breakthrough:10,armor:15,piercing:20,hp:11,organization:48,recovery:.36,reconnaissance:2,suppression:8,weight:2.2,combatWidth:2},requirements:{minTechLevel:4},icon:"üéØ",color:"#ca8a04"},tropas_aerotransportadas:{id:"tropas_aerotransportadas",name:"Tropas Aerotransportadas",nameEn:"Air Assault",category:"special",subcategory:"airborne",composition:{manpower:800,equipment:{utility_helicopters:40,small_arms:800,light_mg:80,mortars:16}},costs:{production:6e6,maintenance:3e5},stats:{softAttack:26,hardAttack:4,defense:24,breakthrough:18,armor:0,piercing:2,hp:10,organization:70,recovery:.45,reconnaissance:6,suppression:12,weight:.2,combatWidth:2},requirements:{minTechLevel:4},icon:"üöÅ",color:"#0369a1"},helicoptero_ataque:{id:"helicoptero_ataque",name:"Helic√≥ptero de Ataque",nameEn:"Attack Helicopter",category:"special",subcategory:"attack_heli",composition:{manpower:200,equipment:{attack_helicopters:30}},costs:{production:4e6,maintenance:2e5},stats:{softAttack:35,hardAttack:40,defense:10,breakthrough:25,armor:5,piercing:45,hp:8,organization:40,recovery:.3,reconnaissance:10,suppression:15,weight:.5,combatWidth:1},requirements:{minTechLevel:5},icon:"üöÅ",color:"#be123c"},anfibio_mecanizado:{id:"anfibio_mecanizado",name:"Anf√≠bio Mecanizado",nameEn:"Amphibious Mechanized",category:"amphibious",subcategory:"amtrac",composition:{manpower:800,equipment:{amtrac:60,small_arms:800,light_mg:80}},costs:{production:3e6,maintenance:15e4},stats:{softAttack:28,hardAttack:6,defense:32,breakthrough:18,armor:8,piercing:8,hp:12,organization:62,recovery:.4,reconnaissance:4,suppression:13,weight:1.8,combatWidth:2},requirements:{minTechLevel:3},icon:"üõ∂",color:"#0891b2"}},_={suporte_helicoptero_ataque:{id:"suporte_helicoptero_ataque",name:"Suporte: Helic√≥ptero de Ataque",nameEn:"Support: Attack Helicopter",category:"air_support",composition:{manpower:80,equipment:{attack_helicopters:12}},costs:{production:1e6,maintenance:5e4},divisionBonuses:{softAttack:15,hardAttack:20,piercing:15,reconnaissance:3},requirements:{minTechLevel:5},icon:"üöÅ",color:"#dc2626"},suporte_logistica_aerea:{id:"suporte_logistica_aerea",name:"Suporte: Log√≠stica A√©rea",nameEn:"Support: Air Logistics",category:"air_support",composition:{manpower:1200,equipment:{utility_helicopters:60}},costs:{production:2e6,maintenance:1e5},divisionBonuses:{organization:5,recovery:.05,suppression:3},requirements:{minTechLevel:4},icon:"üöÅ",color:"#0891b2"},suporte_recon_aereo:{id:"suporte_recon_aereo",name:"Suporte: Reconhecimento A√©reo",nameEn:"Support: Air Reconnaissance",category:"air_support",composition:{manpower:80,equipment:{utility_helicopters:12}},costs:{production:1e6,maintenance:5e4},divisionBonuses:{reconnaissance:8,combatWidth:0},requirements:{minTechLevel:4},icon:"üîç",color:"#0369a1"},suporte_evacuacao_medica:{id:"suporte_evacuacao_medica",name:"Suporte: Evacua√ß√£o M√©dica A√©rea",nameEn:"Support: Medical Evacuation",category:"air_support",composition:{manpower:200,equipment:{utility_helicopters:24}},costs:{production:3e6,maintenance:15e4},divisionBonuses:{recovery:.1,organization:3,hp:2},requirements:{minTechLevel:4},icon:"‚öïÔ∏è",color:"#dc2626"},suporte_ifv_aerotrans:{id:"suporte_ifv_aerotrans",name:"Suporte: IFV Aerotransportado",nameEn:"Support: Airborne IFV",category:"airborne_support",composition:{manpower:300,equipment:{ifv:20}},costs:{production:1e6,maintenance:5e4},divisionBonuses:{softAttack:10,hardAttack:8,armor:5,piercing:8},requirements:{minTechLevel:4},icon:"ü™Ç",color:"#16a34a"},suporte_tanque_leve_aerotrans:{id:"suporte_tanque_leve_aerotrans",name:"Suporte: Tanque Leve Aerotransportado",nameEn:"Support: Airborne Light Tank",category:"airborne_support",composition:{manpower:100,equipment:{light_tanks:20}},costs:{production:14e5,maintenance:7e4},divisionBonuses:{hardAttack:12,armor:10,piercing:15,breakthrough:8},requirements:{minTechLevel:4},icon:"ü™Ç",color:"#ca8a04"},suporte_antiaerea:{id:"suporte_antiaerea",name:"Suporte: Antia√©rea",nameEn:"Support: Anti-Aircraft",category:"fire_support",composition:{manpower:200,equipment:{aa_guns:12,trucks:12}},costs:{production:6e5,maintenance:3e4},divisionBonuses:{piercing:5,defense:3},requirements:{minTechLevel:2},icon:"üéØ",color:"#92400e"},suporte_artilharia:{id:"suporte_artilharia",name:"Suporte: Artilharia",nameEn:"Support: Artillery",category:"fire_support",composition:{manpower:200,equipment:{artillery:12,trucks:12}},costs:{production:5e5,maintenance:25e3},divisionBonuses:{softAttack:20,hardAttack:5,defense:5,combatWidth:1},requirements:{minTechLevel:2},icon:"üí•",color:"#b45309"},suporte_atcms:{id:"suporte_atcms",name:"Suporte: ATCMS",nameEn:"Support: ATGM",category:"fire_support",composition:{manpower:20,equipment:{atcms:12}},costs:{production:1e6,maintenance:5e4},divisionBonuses:{hardAttack:15,piercing:25,defense:4},requirements:{minTechLevel:4},icon:"üéØ",color:"#dc2626"},suporte_manpad:{id:"suporte_manpad",name:"Suporte: MANPAD",nameEn:"Support: MANPAD",category:"fire_support",composition:{manpower:20,equipment:{manpads:12}},costs:{production:1e6,maintenance:5e4},divisionBonuses:{piercing:6,defense:4},requirements:{minTechLevel:4},icon:"üöÄ",color:"#ef4444"},suporte_lancador_foguete:{id:"suporte_lancador_foguete",name:"Suporte: Lan√ßadores de Foguete",nameEn:"Support: Rocket Launchers",category:"fire_support",composition:{manpower:200,equipment:{rocket_launchers:12,trucks:12}},costs:{production:1e6,maintenance:5e4},divisionBonuses:{softAttack:25,hardAttack:8,suppression:5,combatWidth:1},requirements:{minTechLevel:3},icon:"üöÄ",color:"#ea580c"},suporte_spg:{id:"suporte_spg",name:"Suporte: Artilharia Autopropulsada",nameEn:"Support: SPG",category:"fire_support",composition:{manpower:200,equipment:{spg:8}},costs:{production:1e6,maintenance:5e4},divisionBonuses:{softAttack:18,hardAttack:6,armor:5,defense:4},requirements:{minTechLevel:4},icon:"üöú",color:"#a16207"},suporte_spaa:{id:"suporte_spaa",name:"Suporte: Artilharia AA Autopropulsada",nameEn:"Support: SPAA",category:"fire_support",composition:{manpower:200,equipment:{spaa:8}},costs:{production:1e6,maintenance:5e4},divisionBonuses:{piercing:8,armor:4,defense:5},requirements:{minTechLevel:4},icon:"üéØ",color:"#eab308"},suporte_recon_mecanizado:{id:"suporte_recon_mecanizado",name:"Suporte: Reconhecimento Mecanizado",nameEn:"Support: Mechanized Recon",category:"reconnaissance",composition:{manpower:200,equipment:{apc:20}},costs:{production:2e6,maintenance:1e5},divisionBonuses:{reconnaissance:10,armor:3,piercing:3},requirements:{minTechLevel:3},icon:"üîç",color:"#15803d"},suporte_recon_tanque_leve:{id:"suporte_recon_tanque_leve",name:"Suporte: Reconhecimento Tanque Leve",nameEn:"Support: Light Tank Recon",category:"reconnaissance",composition:{manpower:100,equipment:{light_tanks:20}},costs:{production:12e5,maintenance:6e4},divisionBonuses:{reconnaissance:12,armor:8,piercing:10,hardAttack:5},requirements:{minTechLevel:3},icon:"üî≠",color:"#ca8a04"},suporte_recon_motorizado:{id:"suporte_recon_motorizado",name:"Suporte: Reconhecimento Motorizado",nameEn:"Support: Motorized Recon",category:"reconnaissance",composition:{manpower:200,equipment:{trucks:20}},costs:{production:4e5,maintenance:2e4},divisionBonuses:{reconnaissance:6},requirements:{minTechLevel:2},icon:"üîç",color:"#92400e"},suporte_recon_desmontado:{id:"suporte_recon_desmontado",name:"Suporte: Reconhecimento Desmontado",nameEn:"Support: Dismounted Recon",category:"reconnaissance",composition:{manpower:200,equipment:{binoculars:200,radios:50}},costs:{production:2e5,maintenance:1e4},divisionBonuses:{reconnaissance:4},requirements:{minTechLevel:1},icon:"üëÅÔ∏è",color:"#65a30d"},suporte_engenheiros:{id:"suporte_engenheiros",name:"Suporte: Engenheiros",nameEn:"Support: Engineers",category:"logistics",composition:{manpower:1400,equipment:{trucks:100,engineering_equipment:500}},costs:{production:2e6,maintenance:1e5},divisionBonuses:{defense:8,recovery:.05,organization:4},requirements:{minTechLevel:2},icon:"üîß",color:"#f59e0b"},suporte_hospital_campo:{id:"suporte_hospital_campo",name:"Suporte: Hospital de Campo",nameEn:"Support: Field Hospital",category:"logistics",composition:{manpower:600,equipment:{trucks:100,medical_equipment:300}},costs:{production:16e5,maintenance:8e4},divisionBonuses:{recovery:.12,hp:3,organization:5},requirements:{minTechLevel:2},icon:"‚öïÔ∏è",color:"#dc2626"},suporte_logistica_admin:{id:"suporte_logistica_admin",name:"Suporte: Log√≠stica e Administra√ß√£o",nameEn:"Support: Logistics & Admin",category:"logistics",composition:{manpower:800,equipment:{trucks:200,radios:100,computers:50}},costs:{production:2e6,maintenance:1e5},divisionBonuses:{organization:8,recovery:.06,suppression:2},requirements:{minTechLevel:2},icon:"üìã",color:"#3b82f6"},suporte_manutencao_reparo:{id:"suporte_manutencao_reparo",name:"Suporte: Manuten√ß√£o e Reparo",nameEn:"Support: Maintenance & Repair",category:"logistics",composition:{manpower:600,equipment:{trucks:200,repair_equipment:400,spare_parts:1e3}},costs:{production:4e6,maintenance:2e5},divisionBonuses:{recovery:.15,organization:6},requirements:{minTechLevel:3},icon:"üîß",color:"#ea580c"},suporte_policia_militar:{id:"suporte_policia_militar",name:"Suporte: Pol√≠cia Militar",nameEn:"Support: Military Police",category:"logistics",composition:{manpower:1e3,equipment:{utility_vehicles:200,dogs:100,small_arms:1e3}},costs:{production:2e6,maintenance:1e5},divisionBonuses:{suppression:15,organization:7,defense:3},requirements:{minTechLevel:2},icon:"üëÆ",color:"#1e40af"},suporte_comunicacao_sinal:{id:"suporte_comunicacao_sinal",name:"Suporte: Comunica√ß√£o e Sinal",nameEn:"Support: Signal",category:"logistics",composition:{manpower:200,equipment:{trucks:80,radios:200,communication_equipment:100}},costs:{production:2e6,maintenance:1e5},divisionBonuses:{reconnaissance:5,organization:5,recovery:.04},requirements:{minTechLevel:2},icon:"üì°",color:"#059669"}};class E{static calculateDivisionStats(e,t,a,n){const s=(n[e.trainingLevel]||n.regular).modifiers;let r={manpower:{combat:0,support:0,total:0},equipment:{},costs:{production:0,maintenance:0},combatStats:{softAttack:0,hardAttack:0,defense:0,breakthrough:0,armor:0,piercing:0,hp:0,organization:0,recovery:0,reconnaissance:0,suppression:0,weight:0,combatWidth:0}};return e.combatUnits&&Array.isArray(e.combatUnits)&&e.combatUnits.forEach(m=>{const d=t[m.unitType];if(!d){console.warn(`Unidade de combate n√£o encontrada: ${m.unitType}`);return}r.manpower.combat+=d.composition.manpower,this.mergeEquipment(r.equipment,d.composition.equipment),r.costs.production+=d.costs.production*s.costs.production,r.costs.maintenance+=d.costs.maintenance*s.costs.maintenance,Object.keys(r.combatStats).forEach(p=>{const g=d.stats[p]||0,l=s.stats[p]||1;r.combatStats[p]+=g*l})}),e.supportUnits&&Array.isArray(e.supportUnits)&&e.supportUnits.forEach(m=>{const d=a[m.unitType];if(!d){console.warn(`Unidade de suporte n√£o encontrada: ${m.unitType}`);return}r.manpower.support+=d.composition.manpower,this.mergeEquipment(r.equipment,d.composition.equipment),r.costs.production+=d.costs.production,r.costs.maintenance+=d.costs.maintenance,d.divisionBonuses&&Object.keys(d.divisionBonuses).forEach(p=>{const g=d.divisionBonuses[p],v=["softAttack","hardAttack","defense","breakthrough","reconnaissance"].includes(p)&&s.stats[p]||1;r.combatStats[p]+=g*v})}),r.manpower.total=r.manpower.combat+r.manpower.support,r=this.roundStats(r),r}static mergeEquipment(e,t){t&&Object.keys(t).forEach(a=>{e[a]=(e[a]||0)+t[a]})}static roundStats(e){return e.manpower.combat=Math.round(e.manpower.combat),e.manpower.support=Math.round(e.manpower.support),e.manpower.total=Math.round(e.manpower.total),Object.keys(e.equipment).forEach(t=>{e.equipment[t]=Math.round(e.equipment[t])}),e.costs.production=Math.round(e.costs.production*100)/100,e.costs.maintenance=Math.round(e.costs.maintenance*100)/100,Object.keys(e.combatStats).forEach(t=>{e.combatStats[t]=Math.round(e.combatStats[t]*10)/10}),e}static categorizeEquipment(e){return{vehicles:{trucks:e.trucks||0,utility_vehicles:e.utility_vehicles||0,apc:e.apc||0,ifv:e.ifv||0,amtrac:e.amtrac||0},tanks:{light_tanks:e.light_tanks||0,medium_tanks:e.medium_tanks||0,mbt:e.mbt||0,amphibious_tanks:e.amphibious_tanks||0},artillery:{artillery:e.artillery||0,aa_guns:e.aa_guns||0,rocket_launchers:e.rocket_launchers||0,spg:e.spg||0,spaa:e.spaa||0,mlrs:e.mlrs||0},missiles:{atcms:e.atcms||0,manpads:e.manpads||0},aircraft:{attack_helicopters:e.attack_helicopters||0,utility_helicopters:e.utility_helicopters||0},infantry:{small_arms:e.small_arms||0,light_mg:e.light_mg||0,heavy_mg:e.heavy_mg||0,mortars:e.mortars||0,autocannons:e.autocannons||0,atgm:e.atgm||0}}}static calculateEffectiveness(e){const t=e.combatStats,a=(t.softAttack+t.hardAttack+t.breakthrough)/3,n=(t.defense+t.armor+t.hp)/3,i=(t.reconnaissance+t.suppression+t.organization)/3,s=a*.4+n*.4+i*.2;return Math.min(100,Math.round(s))}static calculateCostPerManpower(e){return e.manpower.total===0?0:Math.round(e.costs.production/e.manpower.total)}static getWidthClassification(e){const t=e.combatStats.combatWidth;return t<=10?"Muito Estreita":t<=20?"Estreita":t<=30?"M√©dia":t<=40?"Larga":"Muito Larga"}static analyzeDivision(e){const t=e.combatStats,a=[],n=[];return t.softAttack>200?a.push("Alto ataque contra infantaria"):t.softAttack<50&&n.push("Baixo ataque contra infantaria"),t.hardAttack>200?a.push("Alto ataque contra blindados"):t.hardAttack<20&&n.push("Baixo ataque contra blindados"),t.defense>200?a.push("Alta defesa"):t.defense<50&&n.push("Baixa defesa"),t.armor>50?a.push("Boa prote√ß√£o blindada"):t.armor<10&&n.push("Pouca prote√ß√£o blindada"),t.reconnaissance>15?a.push("Excelente reconhecimento"):t.reconnaissance<5&&n.push("Reconhecimento limitado"),t.organization>60?a.push("Alta organiza√ß√£o"):t.organization<40&&n.push("Baixa organiza√ß√£o"),t.combatWidth>40?n.push("Largura de combate muito alta"):t.combatWidth<10&&n.push("Largura de combate muito baixa"),{strengths:a,weaknesses:n,overallRating:this.calculateEffectiveness(e)}}}class b{static validate(e,t,a,n){const i=[],s=[];if(this.validateMetadata(e,i),this.validateCombatUnits(e,t,i,s),this.validateSupportUnits(e,a,i,s),i.length===0){const r=E.calculateDivisionStats(e,t,a,n);this.validateStats(r,i,s)}return{valid:i.length===0,errors:i,warnings:s}}static validateMetadata(e,t){!e.name||typeof e.name!="string"?t.push("Nome da divis√£o √© obrigat√≥rio"):e.name.trim()===""?t.push("Nome da divis√£o n√£o pode ser vazio"):e.name.length>50&&t.push("Nome da divis√£o muito longo (m√°ximo 50 caracteres)"),["conscript","regular","elite"].includes(e.trainingLevel)||t.push("N√≠vel de treinamento inv√°lido")}static validateCombatUnits(e,t,a,n){if(!e.combatUnits||!Array.isArray(e.combatUnits)){a.push("Lista de unidades de combate inv√°lida");return}const i=e.combatUnits;i.length===0&&a.push("A divis√£o deve ter pelo menos uma unidade de combate"),i.length>25&&a.push("M√°ximo de 25 unidades de combate permitidas"),i.forEach((d,p)=>{if(!d.unitType||!d.id){a.push(`Unidade de combate #${p+1} com estrutura inv√°lida`);return}t[d.unitType]||a.push(`Tipo de unidade de combate n√£o encontrado: ${d.unitType}`)}),i.length<5&&n.push("Divis√£o muito pequena (menos de 5 batalh√µes). Considere adicionar mais unidades.");const s=i.map(d=>d.unitType);new Set(s).size/s.length<.3&&i.length>5&&n.push("Pouca variedade de tipos de unidade. Considere diversificar a composi√ß√£o.")}static validateSupportUnits(e,t,a,n){if(!e.supportUnits||!Array.isArray(e.supportUnits)){a.push("Lista de unidades de suporte inv√°lida");return}const i=e.supportUnits;i.length>5&&a.push("M√°ximo de 5 unidades de suporte permitidas"),i.forEach((m,d)=>{if(!m.unitType||!m.id){a.push(`Unidade de suporte #${d+1} com estrutura inv√°lida`);return}t[m.unitType]||a.push(`Tipo de unidade de suporte n√£o encontrado: ${m.unitType}`)});const s=i.map(m=>m.unitType),r=new Set(s);if(s.length>r.size){const m=s.filter((d,p)=>s.indexOf(d)!==p);n.push(`Unidades de suporte duplicadas (${[...new Set(m)].join(", ")}). Duplicatas n√£o fornecem benef√≠cios adicionais.`)}i.length===0&&e.combatUnits&&e.combatUnits.length>5&&n.push("Divis√£o sem unidades de suporte. Considere adicionar suporte para melhorar desempenho.")}static validateStats(e,t,a){const n=e.combatStats;n.combatWidth>40&&a.push(`Largura de combate muito alta (${n.combatWidth}). Divis√µes largas s√£o menos eficientes em terrenos dif√≠ceis. Recomendado: ‚â§40`),n.combatWidth<10&&a.push(`Largura de combate muito baixa (${n.combatWidth}). Divis√µes estreitas podem n√£o aproveitar todo o front. Recomendado: ‚â•10`),n.organization<20&&a.push("Organiza√ß√£o muito baixa (<20). A divis√£o pode quebrar rapidamente em combate."),n.organization<10&&t.push("Organiza√ß√£o cr√≠tica (<10). Divis√£o invi√°vel para combate."),n.hp<5&&t.push("HP muito baixo (<5). Divis√£o n√£o sobreviveria a combate."),n.hp<10&&a.push("HP baixo (<10). Considere adicionar mais unidades ou melhorar treinamento."),n.softAttack<10&&n.hardAttack<10&&a.push("Capacidade ofensiva muito baixa. Divis√£o ter√° dificuldade em causar dano ao inimigo."),n.weight>5&&a.push(`Divis√£o muito pesada (${n.weight.toFixed(1)} ton). Mobilidade reduzida e maior consumo de combust√≠vel.`);const i=E.calculateCostPerManpower(e);i>1e4&&a.push(`Custo por soldado muito alto ($${(i/1e3).toFixed(1)}k). Considere otimizar composi√ß√£o.`),e.manpower.total<500&&a.push("Divis√£o muito pequena (<500 MP). Pode n√£o ser efetiva em combate."),e.manpower.total>25e3&&a.push("Divis√£o muito grande (>25k MP). Dif√≠cil de manter e suprir.")}static validateResources(e,t,a,n,i){if(!a)return;const s=a.Orcamento||0;t.costs.production>s&&n.push(`Custo de produ√ß√£o ($${(t.costs.production/1e6).toFixed(1)}M) excede or√ßamento dispon√≠vel ($${(s/1e6).toFixed(1)}M)`),t.costs.production>s*.8&&i.push(`Custo de produ√ß√£o muito alto (${(t.costs.production/s*100).toFixed(0)}% do or√ßamento)`);const r=a.ManpowerDisponivel||0;t.manpower.total>r&&n.push(`Manpower necess√°rio (${t.manpower.total}) excede dispon√≠vel (${r})`);const m=a.CapacidadeProducaoVeiculos||0;this.estimateEquipmentValue(t.equipment)>m&&i.push("Equipamentos requeridos excedem capacidade de produ√ß√£o militar. Produ√ß√£o pode levar m√∫ltiplos turnos.")}static estimateEquipmentValue(e){const t={mbt:1e5,medium_tanks:2e4,light_tanks:67e3,ifv:3e4,apc:2e4,spg:187500,spaa:187500,mlrs:312500,artillery:41667,aa_guns:41667,attack_helicopters:133333,utility_helicopters:33333};let a=0;return Object.keys(e).forEach(n=>{t[n]&&(a+=e[n]*t[n])}),a}static validateCompatibility(e,t,a,n){const i=e.combatUnits||[],s=e.supportUnits||[],r=i.some(g=>{const l=t[g.unitType];return l&&l.category==="special"&&l.subcategory==="airborne"}),m=s.some(g=>{const l=a[g.unitType];return l&&l.category==="air_support"});r&&!m&&n.push("Divis√£o tem unidades aerotransportadas mas n√£o tem suporte a√©reo. Considere adicionar suporte de helic√≥pteros.");const d=i.filter(g=>{const l=t[g.unitType];return l&&l.category==="armor"}).length,p=s.some(g=>g.unitType==="suporte_manutencao_reparo");d>3&&!p&&n.push("Muitas unidades blindadas sem suporte de manuten√ß√£o. Considere adicionar Suporte: Manuten√ß√£o e Reparo.")}static generateReport(e){let t=[];return e.errors.length>0&&(t.push("‚ùå ERROS:"),e.errors.forEach(a=>{t.push(`  ‚Ä¢ ${a}`)})),e.warnings.length>0&&(t.length>0&&t.push(""),t.push("‚ö†Ô∏è AVISOS:"),e.warnings.forEach(a=>{t.push(`  ‚Ä¢ ${a}`)})),e.valid&&e.warnings.length===0&&t.push("‚úÖ Divis√£o v√°lida e otimizada!"),t.join(`
`)}}let c={id:null,name:"Nova Divis√£o",countryId:null,trainingLevel:"regular",combatUnits:[],supportUnits:[],calculatedStats:null,createdAt:null,updatedAt:null},M=null,k=null;async function re(o){try{console.log("üéñÔ∏è Inicializando Division Designer..."),M=o,await H();const t=new URLSearchParams(window.location.search).get("id");t&&await F(t),await O(),w(),te(),console.log("‚úÖ Division Designer inicializado com sucesso")}catch(e){console.error("‚ùå Erro ao inicializar Division Designer:",e),u("error","Erro ao carregar Division Designer: "+e.message)}}async function H(){try{const{checkPlayerCountry:o,getCountryData:e}=await f(async()=>{const{checkPlayerCountry:a,getCountryData:n}=await import("./firebase-BN3MSMQD.js");return{checkPlayerCountry:a,getCountryData:n}},__vite__mapDeps([0,1,2])),t=await o(M.uid);if(!t)throw new Error("Usu√°rio n√£o est√° vinculado a um pa√≠s");k=await e(t),k.id=t,c.countryId=t,console.log(`‚úÖ Pa√≠s carregado: ${k.Pais}`)}catch(o){throw console.error("Erro ao carregar pa√≠s:",o),o}}async function F(o){try{const{doc:e,getDoc:t}=await f(async()=>{const{doc:s,getDoc:r}=await import("https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js");return{doc:s,getDoc:r}},[]),a=e(window.db,"divisions",o),n=await t(a);if(!n.exists())throw new Error("Divis√£o n√£o encontrada");const i=n.data();c={...c,...i,id:o},console.log(`‚úÖ Divis√£o carregada: ${c.name}`)}catch(e){console.error("Erro ao carregar divis√£o:",e),u("error","Erro ao carregar divis√£o: "+e.message)}}async function O(){T(),x(),A(),Q(),await P()}function T(){const o=document.getElementById("training-selector"),e=[{id:"conscript",...h.conscript},{id:"regular",...h.regular},{id:"elite",...h.elite}];o.innerHTML=e.map(t=>{const a=(t.modifiers.costs.production-1)*100;return`
      <button
        class="training-badge flex-1 px-4 py-3 rounded-lg border-2 transition-all ${c.trainingLevel===t.id?"border-brand-500 bg-brand-500/20 text-brand-400":"border-bg-ring bg-bg hover:border-slate-600"}"
        data-training="${t.id}"
        onclick="window.selectTrainingLevel('${t.id}')"
        title="${V(t)}"
      >
        <div class="text-2xl mb-1">${t.icon}</div>
        <div class="text-xs font-bold mb-1">${t.name}</div>
        <div class="text-xs text-slate-400">${t.modifiers.recruitmentTurns} turno${t.modifiers.recruitmentTurns>1?"s":""}</div>
        <div class="text-xs font-semibold ${a<0?"text-green-400":a>0?"text-red-400":"text-slate-400"}">
          ${a>=0?"+":""}${a.toFixed(0)}% $
        </div>
      </button>
    `}).join("")}function V(o){const e=(o.modifiers.costs.production-1)*100,t=(o.modifiers.stats.softAttack-1)*100,a=o.modifiers.recruitmentTurns;let n=`${o.name}
${o.description}

`;if(n+=`üí∞ Custo: ${e>=0?"+":""}${e.toFixed(0)}%
`,n+=`‚öîÔ∏è Stats: ${t>=0?"+":""}${t.toFixed(0)}%
`,n+=`‚è±Ô∏è Recrutamento: ${a} turno${a>1?"s":""}`,a>1){const i=(o.modifiers.recruitmentProgress*100).toFixed(1);n+=` (${i}% por turno)`}return n}window.selectTrainingLevel=function(o){c.trainingLevel=o,T(),w()};function x(){const o=document.getElementById("support-grid"),e=5;o.innerHTML="";for(let t=0;t<e;t++){const a=c.supportUnits[t],n=z(t,"support",a);o.appendChild(n)}B()}function A(){const o=document.getElementById("combat-grid"),e=25;o.innerHTML="";for(let t=0;t<e;t++){const a=c.combatUnits[t],n=z(t,"combat",a);o.appendChild(n)}B()}function z(o,e,t){const a=document.createElement("div");if(t){const n=e==="combat"?y[t.unitType]:_[t.unitType];a.className="unit-slot filled rounded-lg p-2 cursor-pointer flex flex-col items-center justify-center relative group",a.innerHTML=`
      <div class="text-3xl mb-1">${n.icon}</div>
      <div class="text-[10px] font-medium text-center line-clamp-2 text-slate-300">${n.name.split(" ")[0]}</div>
      <div class="absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity">
        <button
          onclick="window.removeUnit(${o}, '${e}')"
          class="w-5 h-5 rounded-full bg-red-600 hover:bg-red-700 flex items-center justify-center text-white text-xs"
        >√ó</button>
      </div>
    `,a.addEventListener("mouseenter",i=>oe(i,n,e)),a.addEventListener("mouseleave",q),a.addEventListener("click",i=>{i.target.closest("button")||q()})}else a.className="unit-slot empty rounded-lg flex items-center justify-center cursor-pointer hover:border-brand-500",a.innerHTML=`
      <div class="text-2xl text-slate-600 group-hover:text-brand-500 transition-colors">+</div>
    `,a.onclick=()=>N(o,e);return a}window.removeUnit=function(o,e){e==="combat"?(c.combatUnits.splice(o,1),A()):(c.supportUnits.splice(o,1),x()),w()};function N(o,e){const t=e==="combat"?y:_,a=e==="combat"?"Unidade de Combate":"Unidade de Suporte",n=e==="combat"?25:5;if((e==="combat"?c.combatUnits.length:c.supportUnits.length)>=n){u("warning",`M√°ximo de ${n} unidades ${e==="combat"?"de combate":"de suporte"} atingido`);return}const s=`
    <div class="modal-backdrop fixed inset-0 z-50 flex items-center justify-center p-4" onclick="window.closeModal(event)">
      <div class="bg-bg-soft border border-bg-ring rounded-2xl max-w-4xl w-full max-h-[80vh] flex flex-col" onclick="event.stopPropagation()">
        <!-- Header -->
        <div class="border-b border-bg-ring p-6">
          <div class="flex items-center justify-between">
            <h2 class="text-2xl font-bold text-brand-500">Selecionar ${a}</h2>
            <button onclick="window.closeModal()" class="text-slate-400 hover:text-slate-200 text-2xl leading-none">√ó</button>
          </div>
        </div>

        <!-- Filters -->
        <div class="border-b border-bg-ring p-4">
          <div id="category-filters" class="flex gap-2 flex-wrap">
            ${G(t)}
          </div>
        </div>

        <!-- Units List -->
        <div class="flex-1 overflow-y-auto p-6">
          <div id="units-list" class="grid grid-cols-1 md:grid-cols-2 gap-3">
            ${$(t,o,e)}
          </div>
        </div>
      </div>
    </div>
  `,r=document.getElementById("modal-container");r.innerHTML=s,K(t,o,e)}function G(o,e){const t=new Set;return Object.values(o).forEach(n=>t.add(n.category)),["Todas",...Array.from(t)].map(n=>`
    <button
      class="category-filter px-4 py-2 rounded-lg border transition-colors ${n==="Todas"?"border-brand-500 bg-brand-500/20 text-brand-400":"border-bg-ring bg-bg hover:border-slate-600"}"
      data-category="${n}"
    >
      ${n.charAt(0).toUpperCase()+n.slice(1)}
    </button>
  `).join("")}function K(o,e,t){const a=document.querySelectorAll(".category-filter");a.forEach(n=>{n.addEventListener("click",()=>{const i=n.dataset.category;a.forEach(r=>{r.classList.remove("border-brand-500","bg-brand-500/20","text-brand-400"),r.classList.add("border-bg-ring","bg-bg")}),n.classList.add("border-brand-500","bg-brand-500/20","text-brand-400"),n.classList.remove("border-bg-ring","bg-bg");const s=i==="Todas"?o:Object.fromEntries(Object.entries(o).filter(([r,m])=>m.category===i));document.getElementById("units-list").innerHTML=$(s,e,t)})})}function $(o,e,t){return Object.entries(o).map(([a,n])=>`
    <div
      class="unit-card bg-bg border border-bg-ring rounded-lg p-4 hover:shadow-lg transition-all"
      onclick="window.selectUnit('${a}', ${e}, '${t}')"
    >
      <div class="flex items-start gap-3">
        <div class="text-4xl">${n.icon}</div>
        <div class="flex-1 min-w-0">
          <h3 class="font-bold text-slate-100 mb-1">${n.name}</h3>
          <div class="text-xs text-slate-400 space-y-1">
            <div>${n.composition.manpower} MP</div>
            <div class="text-green-400">$${(n.costs.production/1e6).toFixed(1)}M</div>
          </div>
        </div>
        <div class="text-right text-xs text-slate-500">
          <div>${n.category}</div>
        </div>
      </div>
    </div>
  `).join("")}window.selectUnit=function(o,e,t){const a={id:L(),unitType:o,position:e};t==="combat"?(c.combatUnits.push(a),A()):(c.supportUnits.push(a),x()),closeModal(),w()};window.closeModal=function(o){(!o||o.target.classList.contains("modal-backdrop"))&&(document.getElementById("modal-container").innerHTML="")};function B(){document.getElementById("combat-count").textContent=`${c.combatUnits.length}/25`,document.getElementById("support-count").textContent=`${c.supportUnits.length}/5`}function w(){const o=E.calculateDivisionStats(c,y,_,h);c.calculatedStats=o,document.querySelectorAll(".stat-value").forEach(a=>{a.classList.add("stat-updating"),setTimeout(()=>a.classList.remove("stat-updating"),400)});const t=o.combatStats.softAttack+o.combatStats.hardAttack;document.getElementById("stat-firepower").textContent=t.toFixed(0),document.getElementById("stat-defense").textContent=o.combatStats.defense.toFixed(0),document.getElementById("stat-organization").textContent=o.combatStats.organization.toFixed(0),document.getElementById("stat-hp").textContent=o.combatStats.hp.toFixed(0),document.getElementById("stat-width").textContent=o.combatStats.combatWidth.toFixed(0),document.getElementById("stat-manpower").textContent=o.manpower.total.toLocaleString(),document.getElementById("cost-production").textContent="$"+(o.costs.production/1e6).toFixed(2)+"M",document.getElementById("cost-maintenance").textContent="$"+(o.costs.maintenance/1e3).toFixed(0)+"k",J(o.equipment)}function J(o){const e=document.getElementById("equipment-list");if(Object.keys(o).length===0){e.innerHTML='<p class="text-slate-500 text-center py-4">Nenhuma unidade adicionada</p>';return}const t=Object.entries(o).filter(([a,n])=>n>0).sort((a,n)=>n[1]-a[1]).map(([a,n])=>`
      <div class="flex justify-between items-center py-1">
        <span class="text-slate-400">${C(a)}:</span>
        <span class="font-bold text-slate-200">${n}</span>
      </div>
    `).join("");e.innerHTML=t}function C(o){return{trucks:"Caminh√µes",utility_vehicles:"Utilit√°rios",apc:"APC",ifv:"IFV",light_tanks:"Tanques Leves",medium_tanks:"Tanques M√©dios",mbt:"MBT",artillery:"Artilharia",aa_guns:"AA",spg:"SPG",spaa:"SPAA",mlrs:"MLRS",atcms:"ATCMS",manpads:"MANPADS",attack_helicopters:"Helic√≥pteros Ataque",utility_helicopters:"Helic√≥pteros Utilit√°rios",small_arms:"Armas Pequenas",amtrac:"AMTRAC"}[o]||o}function Q(){const o=document.getElementById("division-name");o.value=c.name,o.addEventListener("input",n=>{c.name=n.target.value}),document.getElementById("btn-reset").addEventListener("click",U),document.getElementById("btn-validate").addEventListener("click",I),document.getElementById("btn-save").addEventListener("click",D);const e=document.getElementById("btn-save-template");e&&e.addEventListener("click",Z);const t=document.getElementById("btn-duplicate");t&&t.addEventListener("click",R);const a=document.getElementById("templates-dropdown");a&&a.addEventListener("change",n=>{window.loadTemplate(n.target.value)}),X()}function X(){document.addEventListener("keydown",o=>{(o.ctrlKey||o.metaKey)&&o.key==="s"&&(o.preventDefault(),D(),u("info","üíæ Salvando divis√£o...")),(o.ctrlKey||o.metaKey)&&o.key==="r"&&(o.preventDefault(),U()),(o.ctrlKey||o.metaKey)&&o.key==="v"&&(o.preventDefault(),I()),(o.ctrlKey||o.metaKey)&&o.key==="d"&&(o.preventDefault(),R()),o.key==="Escape"&&window.closeModal(),o.key==="?"&&!o.target.matches("input, textarea")&&(o.preventDefault(),showKeyboardShortcutsHelp())})}window.showKeyboardShortcutsHelp=function(){const o=`
    <div class="modal-backdrop fixed inset-0 z-50 flex items-center justify-center p-4" onclick="window.closeModal(event)">
      <div class="bg-bg-soft border border-bg-ring rounded-2xl max-w-md w-full p-6" onclick="event.stopPropagation()">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-2xl font-bold text-brand-500">‚å®Ô∏è Atalhos de Teclado</h2>
          <button onclick="window.closeModal()" class="text-slate-400 hover:text-slate-200 text-2xl">√ó</button>
        </div>

        <div class="space-y-3 text-sm">
          <div class="flex justify-between items-center py-2 border-b border-bg-ring">
            <span class="text-slate-300">Salvar Divis√£o</span>
            <kbd class="px-2 py-1 bg-bg rounded font-mono text-brand-400">Ctrl + S</kbd>
          </div>
          <div class="flex justify-between items-center py-2 border-b border-bg-ring">
            <span class="text-slate-300">Validar Divis√£o</span>
            <kbd class="px-2 py-1 bg-bg rounded font-mono text-brand-400">Ctrl + V</kbd>
          </div>
          <div class="flex justify-between items-center py-2 border-b border-bg-ring">
            <span class="text-slate-300">Resetar Divis√£o</span>
            <kbd class="px-2 py-1 bg-bg rounded font-mono text-brand-400">Ctrl + R</kbd>
          </div>
          <div class="flex justify-between items-center py-2 border-b border-bg-ring">
            <span class="text-slate-300">Duplicar Divis√£o</span>
            <kbd class="px-2 py-1 bg-bg rounded font-mono text-brand-400">Ctrl + D</kbd>
          </div>
          <div class="flex justify-between items-center py-2 border-b border-bg-ring">
            <span class="text-slate-300">Fechar Modal</span>
            <kbd class="px-2 py-1 bg-bg rounded font-mono text-brand-400">Esc</kbd>
          </div>
          <div class="flex justify-between items-center py-2">
            <span class="text-slate-300">Mostrar Atalhos</span>
            <kbd class="px-2 py-1 bg-bg rounded font-mono text-brand-400">?</kbd>
          </div>
        </div>

        <div class="mt-6 text-center">
          <button onclick="window.closeModal()" class="px-6 py-2 bg-brand-500 hover:bg-brand-600 rounded-lg font-medium transition-colors">
            Entendido
          </button>
        </div>
      </div>
    </div>
  `;document.getElementById("modal-container").innerHTML=o};async function U(){await S("Resetar Divis√£o","Tem certeza que deseja limpar toda a divis√£o?")&&(c.combatUnits=[],c.supportUnits=[],c.name="Nova Divis√£o",c.trainingLevel="regular",document.getElementById("division-name").value="Nova Divis√£o",T(),A(),x(),w(),u("success","Divis√£o resetada"))}function I(){const o=b.validate(c,y,_,h),e=b.generateReport(o),t=document.getElementById("division-name");t.classList.remove("border-red-500","border-yellow-500","border-green-500"),o.valid?o.warnings.length>0?(t.classList.add("border-yellow-500"),u("warning",`Divis√£o v√°lida com avisos:

`+e)):(t.classList.add("border-green-500"),u("success",`Divis√£o v√°lida!

`+e)):(t.classList.add("border-red-500"),u("error",`Divis√£o inv√°lida:

`+e),Y()),setTimeout(()=>{t.classList.remove("border-red-500","border-yellow-500","border-green-500")},3e3)}function Y(o){if(c.calculatedStats){const e=c.calculatedStats.combatStats;if(e.combatWidth>40){const t=document.getElementById("stat-width");t.classList.add("text-red-400","font-bold"),setTimeout(()=>t.classList.remove("text-red-400","font-bold"),3e3)}if(e.organization<20){const t=document.getElementById("stat-organization");t.classList.add("text-red-400","font-bold"),setTimeout(()=>t.classList.remove("text-red-400","font-bold"),3e3)}}}async function D(){const o=document.getElementById("btn-save"),e=o.textContent;try{const t=b.validate(c,y,_,h);if(!t.valid){const l=b.generateReport(t);u("error",`N√£o √© poss√≠vel salvar divis√£o inv√°lida:

`+l);return}if(t.warnings.length>0){const l=b.generateReport(t);if(!await S("Avisos de Valida√ß√£o",l+`

Deseja continuar mesmo assim?`,"Sim, salvar","Cancelar"))return}o.disabled=!0,o.innerHTML=`
      <svg class="animate-spin h-4 w-4 inline-block mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
      </svg>
      Salvando...
    `;const{collection:a,doc:n,setDoc:i,serverTimestamp:s}=await f(async()=>{const{collection:l,doc:v,setDoc:W,serverTimestamp:j}=await import("https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js");return{collection:l,doc:v,setDoc:W,serverTimestamp:j}},[]),r=c.id?n(window.db,"divisions",c.id):n(a(window.db,"divisions")),m=h[c.trainingLevel],d=m.modifiers.recruitmentTurns,p=m.modifiers.recruitmentProgress,g={...c,id:r.id,updatedAt:s(),recruitmentStatus:"recruiting",recruitment:{totalTurns:d,currentTurn:0,progressPerTurn:p,progress:0,startedAt:s(),trainingLevel:c.trainingLevel}};c.id||(g.createdAt=s()),await i(r,g),c.id=r.id,o.innerHTML=`
      <svg class="h-4 w-4 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
      </svg>
      Salvo!
    `,u("success","‚úÖ Divis√£o salva com sucesso!"),setTimeout(()=>{o.disabled=!1,o.textContent=e},2e3)}catch(t){console.error("Erro ao salvar divis√£o:",t),u("error","Erro ao salvar: "+t.message),o.disabled=!1,o.textContent=e}}async function Z(){try{if(!b.validate(c,y,_,h).valid){u("error","N√£o √© poss√≠vel salvar template de divis√£o inv√°lida");return}const e=prompt("Nome do template:",c.name+" (Template)");if(!e)return;const{collection:t,doc:a,setDoc:n,serverTimestamp:i}=await f(async()=>{const{collection:r,doc:m,setDoc:d,serverTimestamp:p}=await import("https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js");return{collection:r,doc:m,setDoc:d,serverTimestamp:p}},[]),s=a(t(window.db,"division_templates"));await n(s,{id:s.id,name:e,countryId:k.id,isPublic:!1,trainingLevel:c.trainingLevel,combatUnits:c.combatUnits.map(r=>({unitType:r.unitType})),supportUnits:c.supportUnits.map(r=>({unitType:r.unitType})),createdAt:i()}),u("success","‚úÖ Template salvo com sucesso!"),await P()}catch(o){console.error("Erro ao salvar template:",o),u("error","Erro ao salvar template: "+o.message)}}async function P(){try{const{collection:o,query:e,where:t,getDocs:a,orderBy:n}=await f(async()=>{const{collection:d,query:p,where:g,getDocs:l,orderBy:v}=await import("https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js");return{collection:d,query:p,where:g,getDocs:l,orderBy:v}},[]),i=o(window.db,"division_templates"),s=e(i,t("countryId","==",k.id),n("createdAt","desc")),r=await a(s),m=[];return r.forEach(d=>{m.push({id:d.id,...d.data()})}),ee(m),m}catch(o){return console.error("Erro ao carregar templates:",o),[]}}function ee(o){const e=document.getElementById("templates-dropdown");if(e){if(o.length===0){e.innerHTML='<option value="">Nenhum template salvo</option>';return}e.innerHTML=`
    <option value="">Selecione um template...</option>
    ${o.map(t=>`<option value="${t.id}">${t.name}</option>`).join("")}
  `}}window.loadTemplate=async function(o){if(o)try{const{doc:e,getDoc:t}=await f(async()=>{const{doc:s,getDoc:r}=await import("https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js");return{doc:s,getDoc:r}},[]),a=e(window.db,"division_templates",o),n=await t(a);if(!n.exists()){u("error","Template n√£o encontrado");return}const i=n.data();c.name=i.name.replace(" (Template)",""),c.trainingLevel=i.trainingLevel,c.combatUnits=i.combatUnits.map((s,r)=>({id:L(),unitType:s.unitType,position:r})),c.supportUnits=i.supportUnits.map((s,r)=>({id:L(),unitType:s.unitType,position:r})),document.getElementById("division-name").value=c.name,T(),A(),x(),w(),u("success","‚úÖ Template carregado!")}catch(e){console.error("Erro ao carregar template:",e),u("error","Erro ao carregar template: "+e.message)}};async function R(){if(c.combatUnits.length===0){u("warning","Adicione unidades antes de duplicar");return}c.id=null,c.name=c.name+" (C√≥pia)",c.createdAt=null,c.updatedAt=null,document.getElementById("division-name").value=c.name,u("success","Divis√£o duplicada! Clique em Salvar para criar uma nova c√≥pia.")}function L(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}function te(){const o=document.getElementById("initial-loading");o&&(o.style.opacity="0",setTimeout(()=>o.style.display="none",500))}function oe(o,e,t){q(!0);const a=document.createElement("div");a.id="unit-tooltip",a.className="fixed z-[100] bg-bg-soft border-2 border-brand-500 rounded-lg p-4 shadow-2xl max-w-sm";let n=`
    <div class="space-y-3">
      <div class="flex items-center gap-3 border-b border-bg-ring pb-2">
        <div class="text-4xl">${e.icon}</div>
        <div>
          <h3 class="font-bold text-brand-400 text-lg">${e.name}</h3>
          <p class="text-xs text-slate-400">${e.category}</p>
        </div>
      </div>

      <div class="grid grid-cols-2 gap-2 text-xs">
        <div class="bg-bg rounded p-2">
          <p class="text-slate-500">Manpower</p>
          <p class="font-bold text-slate-100">${e.composition.manpower.toLocaleString()}</p>
        </div>
        <div class="bg-bg rounded p-2">
          <p class="text-slate-500">Produ√ß√£o</p>
          <p class="font-bold text-green-400">$${(e.costs.production/1e6).toFixed(1)}M</p>
        </div>
      </div>
  `;t==="combat"&&e.stats?n+=`
      <div class="border-t border-bg-ring pt-2">
        <p class="text-xs font-bold text-slate-300 mb-2">Combat Stats:</p>
        <div class="grid grid-cols-2 gap-x-4 gap-y-1 text-xs">
          ${e.stats.softAttack?`<div><span class="text-slate-500">Soft Attack:</span> <span class="text-slate-200">${e.stats.softAttack}</span></div>`:""}
          ${e.stats.hardAttack?`<div><span class="text-slate-500">Hard Attack:</span> <span class="text-slate-200">${e.stats.hardAttack}</span></div>`:""}
          ${e.stats.defense?`<div><span class="text-slate-500">Defense:</span> <span class="text-slate-200">${e.stats.defense}</span></div>`:""}
          ${e.stats.breakthrough?`<div><span class="text-slate-500">Breakthrough:</span> <span class="text-slate-200">${e.stats.breakthrough}</span></div>`:""}
          ${e.stats.organization?`<div><span class="text-slate-500">Organization:</span> <span class="text-slate-200">${e.stats.organization}</span></div>`:""}
          ${e.stats.combatWidth?`<div><span class="text-slate-500">Width:</span> <span class="text-slate-200">${e.stats.combatWidth}</span></div>`:""}
        </div>
      </div>
    `:t==="support"&&e.divisionBonuses&&(n+=`
      <div class="border-t border-bg-ring pt-2">
        <p class="text-xs font-bold text-brand-400 mb-2">Division Bonuses:</p>
        <div class="grid grid-cols-2 gap-x-4 gap-y-1 text-xs">
          ${Object.entries(e.divisionBonuses).map(([d,p])=>`
            <div><span class="text-slate-500">${d}:</span> <span class="text-green-400">+${p}</span></div>
          `).join("")}
        </div>
      </div>
    `),e.composition.equipment&&Object.keys(e.composition.equipment).length>0&&(n+=`
      <div class="border-t border-bg-ring pt-2">
        <p class="text-xs font-bold text-slate-300 mb-2">Equipment:</p>
        <div class="space-y-1 text-xs">
          ${Object.entries(e.composition.equipment).map(([d,p])=>`
            <div class="flex justify-between">
              <span class="text-slate-400">${C(d)}</span>
              <span class="text-slate-200">${p}</span>
            </div>
          `).join("")}
        </div>
      </div>
    `),n+="</div>",a.innerHTML=n,document.body.appendChild(a);const i=o.target.getBoundingClientRect(),s=a.getBoundingClientRect();let r=i.right+10,m=i.top;r+s.width>window.innerWidth&&(r=i.left-s.width-10),m+s.height>window.innerHeight&&(m=window.innerHeight-s.height-10),a.style.left=r+"px",a.style.top=m+"px",a.style.opacity="0",setTimeout(()=>{a.style.transition="opacity 0.2s",a.style.opacity="1"},10)}function q(o=!1){const e=document.getElementById("unit-tooltip");e&&(o?e.remove():(e.style.opacity="0",setTimeout(()=>{e.parentElement&&e.remove()},200)))}export{re as initDivisionCreator};
