import{_ as O}from"./preload-helper-f85Crcwt.js";/* empty css                                 */const E={mbt_light:{name:"Chassi MBT Leve",category:"Main Battle Tank",weight_class:"light",base_weight:6e3,base_cost:85e3,max_weight_capacity:35e3,max_armor_thickness:150,base_speed:52,terrain_mult:{road:1,offroad:.88,mud:.78,snow:.82},maintenance_complexity:.7,fuel_consumption_base:1,crew_comfort:.7,tech_requirement:{year:1945,level:55},reliability:.84,crew_capacity:{min:3,max:4,optimal:3},turret_space:3,internal_volume:45,ground_pressure:.78,variants:["MBT","Tank Destroyer","SPAA","Command"],compatible_engines:["light","medium"],compatible_transmissions:["manual","semi_auto"],compatible_suspensions:["leaf_spring","coil_spring","torsion_bar","christie"],max_main_gun_caliber:105,min_main_gun_caliber:37,compatible_secondary_weapons:["mg_7_62mm","mg_12_7mm","autocannon_20mm"],max_engine_power:650,min_engine_power:180,large_caliber_capable:!1,aa_optimized:!1},mbt_medium:{name:"Chassi MBT Médio",category:"Main Battle Tank",weight_class:"medium",base_weight:13e3,base_cost:11e4,max_weight_capacity:45e3,max_armor_thickness:200,base_speed:48,terrain_mult:{road:1,offroad:.82,mud:.72,snow:.75},maintenance_complexity:.8,fuel_consumption_base:1.2,crew_comfort:.75,tech_requirement:{year:1948,level:62},reliability:.81,crew_capacity:{min:3,max:5,optimal:4},turret_space:3.4,internal_volume:52,ground_pressure:.82,variants:["MBT","Tank Destroyer","Recovery","Bridge Layer"],compatible_engines:["medium","heavy"],compatible_transmissions:["manual","semi_auto","automatic"],compatible_suspensions:["coil_spring","torsion_bar","hydropneumatic","interleaved"],max_main_gun_caliber:125,min_main_gun_caliber:75,compatible_secondary_weapons:["mg_7_62mm","mg_12_7mm","mg_14_5mm","autocannon_20mm","autocannon_25mm"],max_engine_power:900,min_engine_power:400,large_caliber_capable:!1,aa_optimized:!1},mbt_super_heavy:{name:"Chassi MBT Super-Pesado",category:"Super Heavy Tank",weight_class:"super_heavy",base_weight:46e3,base_cost:28e4,max_weight_capacity:75e3,max_armor_thickness:350,base_speed:35,terrain_mult:{road:1,offroad:.65,mud:.45,snow:.55},maintenance_complexity:1.4,fuel_consumption_base:2.2,crew_comfort:.85,tech_requirement:{year:1953,level:85},reliability:.72,crew_capacity:{min:4,max:6,optimal:5},turret_space:4.2,internal_volume:68,ground_pressure:.95,variants:["Heavy MBT","Heavy Tank Destroyer","Breakthrough Tank"]},mbt_heavy:{name:"Chassi MBT Pesado",category:"Main Battle Tank",weight_class:"heavy",base_weight:21e3,base_cost:165e3,max_weight_capacity:65e3,max_armor_thickness:280,base_speed:42,terrain_mult:{road:1,offroad:.75,mud:.58,snow:.65},maintenance_complexity:1,fuel_consumption_base:1.6,crew_comfort:.82,tech_requirement:{year:1950,level:72},reliability:.78,crew_capacity:{min:4,max:5,optimal:4},turret_space:3.8,internal_volume:58,ground_pressure:.95,variants:["MBT","Heavy Tank Destroyer","Assault Gun"]},light_tracked_basic:{name:"Chassi Leve Tracked Básico",category:"Light Tracked",weight_class:"light",base_weight:4500,base_cost:42e3,max_weight_capacity:25e3,max_armor_thickness:35,base_speed:65,terrain_mult:{road:1,offroad:.92,mud:.82,snow:.75},maintenance_complexity:.55,fuel_consumption_base:.75,crew_comfort:.65,tech_requirement:{year:1942,level:45},reliability:.87,crew_capacity:{min:2,max:3,optimal:2},turret_space:1.8,internal_volume:28,ground_pressure:.45,variants:["APC","IFV","Mortar Carrier","Command","Ambulance"],compatible_engines:["light","medium"],compatible_transmissions:["manual","semi_auto"],compatible_suspensions:["coil_spring","torsion_bar"],min_engine_power:120,max_engine_power:450},light_tracked_advanced:{name:"Chassi Leve Tracked Avançado",category:"Light Tracked",weight_class:"light",base_weight:5500,base_cost:58e3,max_weight_capacity:32e3,max_armor_thickness:50,base_speed:68,terrain_mult:{road:1,offroad:.95,mud:.85,snow:.78},maintenance_complexity:.7,fuel_consumption_base:.85,crew_comfort:.72,tech_requirement:{year:1948,level:58},reliability:.85,crew_capacity:{min:2,max:4,optimal:3},turret_space:2.2,internal_volume:35,ground_pressure:.52,variants:["IFV","SPAA","AT Platform","Recon","Engineer"],compatible_engines:["light","medium"],compatible_transmissions:["manual","semi_auto","automatic"],compatible_suspensions:["coil_spring","torsion_bar","hydropneumatic"],min_engine_power:150,max_engine_power:550},heavy_tracked:{name:"Chassi Pesado Tracked",category:"Heavy Tracked",weight_class:"heavy",base_weight:2e4,base_cost:95e3,max_weight_capacity:48e3,max_armor_thickness:120,base_speed:45,terrain_mult:{road:1,offroad:.78,mud:.65,snow:.68},maintenance_complexity:.9,fuel_consumption_base:1.4,crew_comfort:.78,tech_requirement:{year:1946,level:65},reliability:.8,crew_capacity:{min:3,max:6,optimal:4},turret_space:3,internal_volume:48,ground_pressure:.88,variants:["Heavy APC","SPG","Recovery","Engineer"],compatible_engines:["medium","heavy"],compatible_transmissions:["manual","semi_auto","automatic"],compatible_suspensions:["torsion_bar","interleaved","hydropneumatic"],min_engine_power:450,max_engine_power:1e3},wheeled_4x4:{name:"Chassi com Rodas 4x4",category:"Wheeled",weight_class:"light",base_weight:3500,base_cost:32e3,max_weight_capacity:18e3,max_armor_thickness:25,base_speed:95,terrain_mult:{road:1.4,offroad:.65,mud:.35,snow:.45},maintenance_complexity:.45,fuel_consumption_base:.6,crew_comfort:.75,tech_requirement:{year:1940,level:35},reliability:.9,crew_capacity:{min:2,max:4,optimal:2},turret_space:1.2,internal_volume:18,ground_pressure:.68,variants:["Scout","Light APC","Command","AT Platform"],compatible_engines:["light"],compatible_transmissions:["automatic","semi_auto"],compatible_suspensions:["coil_spring"],min_engine_power:100,max_engine_power:300,max_main_gun_caliber:37,large_caliber_capable:!1},wheeled_6x6:{name:"Chassi com Rodas 6x6",category:"Wheeled",weight_class:"medium",base_weight:4500,base_cost:45e3,max_weight_capacity:28e3,max_armor_thickness:35,base_speed:88,terrain_mult:{road:1.3,offroad:.72,mud:.48,snow:.55},maintenance_complexity:.55,fuel_consumption_base:.8,crew_comfort:.78,tech_requirement:{year:1945,level:48},reliability:.88,crew_capacity:{min:2,max:6,optimal:3},turret_space:1.8,internal_volume:32,ground_pressure:.72,variants:["APC","IFV","SPAA","Mortar","Command"],compatible_engines:["light","medium"],compatible_transmissions:["automatic","semi_auto"],compatible_suspensions:["coil_spring","hydropneumatic"],min_engine_power:150,max_engine_power:450,max_main_gun_caliber:57,large_caliber_capable:!1},wheeled_8x8:{name:"Chassi com Rodas 8x8",category:"Wheeled",weight_class:"heavy",base_weight:6e3,base_cost:68e3,max_weight_capacity:38e3,max_armor_thickness:45,base_speed:85,terrain_mult:{road:1.25,offroad:.78,mud:.58,snow:.62},maintenance_complexity:.68,fuel_consumption_base:1,crew_comfort:.82,tech_requirement:{year:1950,level:62},reliability:.85,crew_capacity:{min:3,max:8,optimal:4},turret_space:2.5,internal_volume:42,ground_pressure:.78,variants:["Heavy APC","IFV","Tank Destroyer","Artillery","Recovery"],compatible_engines:["light","medium"],compatible_transmissions:["automatic","semi_auto"],compatible_suspensions:["coil_spring","hydropneumatic"],max_main_gun_caliber:90,min_main_gun_caliber:25,compatible_secondary_weapons:["mg_7_62mm","mg_12_7mm","autocannon_20mm","autocannon_25mm"],max_engine_power:750,min_engine_power:300,large_caliber_capable:!1,aa_optimized:!1,wheeled_restrictions:!0},amphibious_tracked:{name:"Chassi Anfíbio Tracked",category:"Amphibious",weight_class:"medium",base_weight:5e3,base_cost:95e3,max_weight_capacity:35e3,max_armor_thickness:60,base_speed:48,water_speed:8,terrain_mult:{road:1,offroad:.85,mud:.92,snow:.72,water:1},maintenance_complexity:1.1,fuel_consumption_base:1.3,crew_comfort:.68,tech_requirement:{year:1948,level:68},reliability:.78,crew_capacity:{min:3,max:5,optimal:3},turret_space:2.8,internal_volume:38,ground_pressure:.65,variants:["Amphibious Tank","Marine APC","Beach Assault"],special_features:["waterproofed","swimming_capability","bilge_pumps"]},airtransportable:{name:"Chassi Aerotransportável",category:"Airmobile",weight_class:"light",base_weight:3e3,base_cost:52e3,max_weight_capacity:22e3,max_armor_thickness:30,base_speed:62,terrain_mult:{road:1,offroad:.88,mud:.75,snow:.72},maintenance_complexity:.8,fuel_consumption_base:.85,crew_comfort:.65,tech_requirement:{year:1950,level:72},reliability:.82,crew_capacity:{min:2,max:3,optimal:2},turret_space:1.5,internal_volume:22,ground_pressure:.38,variants:["Airborne Tank","Air-Mobile APC","Recon"],special_features:["lightweight_construction","air_droppable","quick_deployment"]},modular_experimental:{name:"Chassi Modular Experimental",category:"Experimental",weight_class:"variable",base_weight:25e3,base_cost:125e3,max_weight_capacity:5e4,max_armor_thickness:120,base_speed:55,terrain_mult:{road:1,offroad:.82,mud:.68,snow:.72},maintenance_complexity:1.6,fuel_consumption_base:1.1,crew_comfort:.85,tech_requirement:{year:1954,level:88},reliability:.75,crew_capacity:{min:2,max:6,optimal:3},turret_space:3.5,internal_volume:55,ground_pressure:.75,variants:["Modular MBT","Multi-Role","Reconfigurable"],special_features:["modular_armor","swappable_components","multi_role"],experimental:!0},spaa_light:{name:"Chassi SPAA Leve",category:"Anti-Aircraft",weight_class:"light",base_weight:12e3,base_cost:58e3,max_weight_capacity:28e3,max_armor_thickness:40,base_speed:65,terrain_mult:{road:1,offroad:.88,mud:.75,snow:.78},maintenance_complexity:.8,fuel_consumption_base:.9,crew_comfort:.7,tech_requirement:{year:1943,level:50},reliability:.85,crew_capacity:{min:3,max:5,optimal:4},turret_space:2.5,internal_volume:32,ground_pressure:.55,variants:["SPAA","Mobile AA"],special_features:["aa_fire_control","radar_compatible","360_traverse"],compatible_engines:["light","medium"],compatible_transmissions:["manual","semi_auto"],compatible_suspensions:["coil_spring","torsion_bar","christie"],max_main_gun_caliber:0,min_main_gun_caliber:0,compatible_secondary_weapons:[],max_engine_power:600,min_engine_power:300,large_caliber_capable:!1,aa_optimized:!0,aa_only:!0,compatible_aa_weapons:["mg_23mm","mg_30mm","mg_37mm","mg_40mm"]},spaa_medium:{name:"Chassi SPAA Médio",category:"Anti-Aircraft",weight_class:"medium",base_weight:18e3,base_cost:85e3,max_weight_capacity:42e3,max_armor_thickness:60,base_speed:55,terrain_mult:{road:1,offroad:.82,mud:.68,snow:.72},maintenance_complexity:.9,fuel_consumption_base:1.2,crew_comfort:.75,tech_requirement:{year:1945,level:60},reliability:.82,crew_capacity:{min:4,max:6,optimal:5},turret_space:3.2,internal_volume:45,ground_pressure:.68,variants:["Heavy SPAA","Multi-Target AA"],special_features:["advanced_fire_control","radar_integrated","ammo_handling"],aa_optimized:!0},spg_chassis:{name:"Chassi SPG/SPH",category:"Self-Propelled Artillery",weight_class:"heavy",base_weight:12e3,base_cost:95e3,max_weight_capacity:52e3,max_armor_thickness:80,base_speed:45,terrain_mult:{road:1,offroad:.75,mud:.62,snow:.68},maintenance_complexity:.9,fuel_consumption_base:1.4,crew_comfort:.65,tech_requirement:{year:1944,level:55},reliability:.8,crew_capacity:{min:4,max:8,optimal:6},turret_space:4.5,internal_volume:55,ground_pressure:.85,variants:["SPG","SPH","Howitzer","Artillery"],special_features:["large_gun_mount","ammo_storage","artillery_systems"],compatible_engines:["heavy","super_heavy"],compatible_transmissions:["manual","automatic","planetary"],compatible_suspensions:["torsion_bar","hydropneumatic","interleaved"],max_main_gun_caliber:180,min_main_gun_caliber:130,compatible_secondary_weapons:["mg_7_62mm","mg_12_7mm"],max_engine_power:1200,min_engine_power:600,large_caliber_capable:!0,aa_optimized:!1,artillery_specialized:!0}},P={gasoline_i4_light:{name:"4 Cilindros Gasolina",category:"light",fuel_type:"gasoline",tech_requirement:{year:1940,level:25},base:{power:180,weight:280,cost:4500,consumption:1,reliability:.92,maintenance_hours:1.5,energy_output:12},tuning:{light:{name_suffix:" (L)",power:-5,weight:-15},medium:{name_suffix:" (M)",power:15,weight:25},heavy:{name_suffix:" (H)",power:35,weight:60}},optimal_chassis:["mbt_light","wheeled_6x6","airtransportable"]},gasoline_v6_light:{name:"V6 Gasolina Leve",category:"light",fuel_type:"gasoline",tech_requirement:{year:1940,level:35},base:{power:320,weight:480,cost:8500,consumption:1.2,reliability:.85,maintenance_hours:2,fire_risk:.18,cold_start:.92,torque_curve:{low:.65,mid:1,high:.85},operational_temp:{min:-15,max:45},energy_output:18},tuning:{light:{name_suffix:" (L)",power:-10,weight:-30},medium:{name_suffix:" (M)",power:20,weight:40},heavy:{name_suffix:" (H)",power:40,weight:80}}},diesel_i4_light:{name:"I4 Diesel Leve",category:"light",fuel_type:"diesel",tech_requirement:{year:1941,level:40},base:{power:280,weight:420,cost:9500,consumption:.8,reliability:.88,maintenance_hours:1.6,fire_risk:.08,cold_start:.72,torque_curve:{low:1.25,mid:1,high:.65},energy_output:16},tuning:{light:{name_suffix:" (L)",power:-10,weight:-20},medium:{name_suffix:" (M)",power:20,weight:35},heavy:{name_suffix:" (H)",power:45,weight:70}},optimal_chassis:["mbt_light","wheeled_6x6","airtransportable"]},gasoline_v8_medium:{name:"V8 Gasolina Médio",category:"medium",fuel_type:"gasoline",tech_requirement:{year:1942,level:42},base:{power:450,weight:650,cost:12e3,consumption:1.35,reliability:.82,maintenance_hours:2.2,fire_risk:.16,cold_start:.94,torque_curve:{low:.72,mid:1,high:.88},energy_output:24},tuning:{light:{name_suffix:" (L)",power:-60,weight:-90},medium:{name_suffix:" (M)",power:0,weight:0},heavy:{name_suffix:" (H)",power:70,weight:110}},optimal_chassis:["mbt_medium","tracked_medium","wheeled_8x8"]},diesel_v6_medium:{name:"V6 Diesel Médio",category:"medium",fuel_type:"diesel",tech_requirement:{year:1943,level:45},base:{power:520,weight:720,cost:15e3,consumption:1.1,reliability:.86,maintenance_hours:2,fire_risk:.07,cold_start:.75,torque_curve:{low:1.2,mid:1,high:.7},energy_output:28},tuning:{light:{name_suffix:" (L)",power:-80,weight:-100},medium:{name_suffix:" (M)",power:0,weight:0},heavy:{name_suffix:" (H)",power:90,weight:140}},optimal_chassis:["mbt_medium","tracked_medium","amphibious_tracked"]},gasoline_v8_supercharged:{name:"V8 Gasolina Supercharger",category:"heavy",fuel_type:"gasoline",tech_requirement:{year:1944,level:58},base:{power:750,weight:890,cost:22e3,consumption:1.8,reliability:.78,maintenance_hours:3.2,fire_risk:.22,cold_start:.85,torque_curve:{low:.85,mid:1,high:.95},energy_output:45},tuning:{light:{name_suffix:" (lim.)",power:-150,weight:-180,reliability:.03},medium:{name_suffix:" (M)",power:-60,weight:-80},heavy:{name_suffix:" (H)",power:0,weight:0}},optimal_chassis:["mbt_heavy","mbt_super_heavy","tracked_heavy"]},gasoline_v12_contextual:{name:"V12 Gasolina (Ajustável)",category:"medium",fuel_type:"gasoline",tech_requirement:{year:1946,level:65},base:{power:800,weight:1100,cost:3e4,consumption:1.9,reliability:.8,maintenance_hours:4,energy_output:50,fire_risk:.2,cold_start:.88,torque_curve:{low:.78,mid:1,high:.92}},tuning:{light:{name_suffix:" (Leve)",power:-150,weight:-250,cost:-4e3,consumption:-.4,reliability:.05},medium:{name_suffix:" (Médio)",power:-50,weight:-100,cost:-2e3,consumption:-.2,reliability:.02},heavy:{name_suffix:" (Pesado)",power:150,weight:180,cost:5e3,consumption:.2,reliability:-.05}}},diesel_v8_heavy:{name:"V8 Diesel Pesado",category:"heavy",fuel_type:"diesel",tech_requirement:{year:1945,level:55},base:{power:820,weight:1050,cost:28e3,consumption:1.4,reliability:.82,maintenance_hours:2.8,fire_risk:.08,cold_start:.68,torque_curve:{low:1.35,mid:1,high:.65},energy_output:54},tuning:{light:{name_suffix:" (L)",power:-160,weight:-180},medium:{name_suffix:" (M)",power:-60,weight:-80},heavy:{name_suffix:" (H)",power:0,weight:0}},optimal_chassis:["mbt_heavy","mbt_super_heavy","spg_chassis"]},diesel_v12_superheavy:{name:"V12 Diesel Super Pesado",category:"super_heavy",fuel_type:"diesel",tech_requirement:{year:1948,level:72},base:{power:1200,weight:1650,cost:48e3,consumption:1.8,reliability:.78,maintenance_hours:3.5,fire_risk:.09,cold_start:.65,torque_curve:{low:1.4,mid:1,high:.6},energy_output:79},tuning:{light:{name_suffix:" (L)",power:-250,weight:-250},medium:{name_suffix:" (M)",power:-120,weight:-140},heavy:{name_suffix:" (H)",power:0,weight:0}},optimal_chassis:["mbt_super_heavy","tracked_heavy"]},gasoline_v16_experimental:{name:"V16 Gasolina Experimental",category:"super_heavy",fuel_type:"gasoline",tech_requirement:{year:1952,level:85},base:{power:1450,weight:1950,cost:65e3,consumption:2.8,reliability:.72,maintenance_hours:5,fire_risk:.25,cold_start:.82,torque_curve:{low:.88,mid:1,high:.98},energy_output:87},tuning:{light:{name_suffix:" (L)",power:-300,weight:-300},medium:{name_suffix:" (M)",power:-150,weight:-160},heavy:{name_suffix:" (H)",power:0,weight:0}},optimal_chassis:["modular_experimental"],experimental:!0}},D={manual_2speed_simple:{name:"Manual Simples 2 Marchas",type:"manual",gears:2,weight:180,cost:2200,efficiency:.72,max_input_torque:800,reliability:.98,maintenance_complexity:.15,driver_skill_required:.95,tech_requirement:{year:1925,level:15},gear_ratios:[6.8,1],reverse_ratio:8.2,shift_time:4.5,max_speed_road:35,max_speed_offroad:22,terrain_performance:{mud:1.15,sand:1.08,snow:1.12},fuel_economy_bonus:.08,description:"Transmissão extremamente simples e robusta, ideal para veículos utilitários",historical_note:"Baseada em designs dos anos 1920-30, muito comum em veículos civis convertidos"},manual_3speed_utility:{name:"Manual Utilitária 3 Marchas",type:"manual",gears:3,weight:240,cost:3200,efficiency:.78,max_input_torque:1100,reliability:.96,maintenance_complexity:.25,driver_skill_required:.88,tech_requirement:{year:1935,level:22},gear_ratios:[5.8,3.2,1],reverse_ratio:6.5,shift_time:3.8,max_speed_road:45,max_speed_offroad:32,terrain_performance:{mud:1.12,sand:1.05,snow:1.08},description:"Transmissão robusta para veículos de apoio e transporte",optimal_applications:["transport","utility","light_armor"]},manual_4speed_combat:{name:"Manual de Combate 4 Marchas",type:"manual",gears:4,weight:310,cost:4800,efficiency:.82,max_input_torque:1450,reliability:.94,maintenance_complexity:.35,driver_skill_required:.82,tech_requirement:{year:1940,level:30},gear_ratios:[4.8,2.9,1.9,1],reverse_ratio:5.4,shift_time:2.8,max_speed_road:58,max_speed_offroad:42,terrain_performance:{mud:1.05,sand:1.02,snow:1.04},description:"Transmissão padrão para tanques médios, equilibrada para combate",optimal_applications:["main_battle_tank","medium_tank","tank_destroyer"]},manual_5speed_advanced:{name:"Manual Avançada 5 Marchas",type:"manual",gears:5,weight:385,cost:7200,efficiency:.85,max_input_torque:1650,reliability:.92,maintenance_complexity:.45,driver_skill_required:.75,tech_requirement:{year:1948,level:42},gear_ratios:[4.5,2.8,1.9,1.3,1],reverse_ratio:5.1,shift_time:2.2,max_speed_road:68,max_speed_offroad:52,terrain_performance:{mud:1.02,sand:.98,snow:1.01},fuel_economy_bonus:.12,description:"Transmissão moderna com marcha extra para economia de combustível",optimal_applications:["reconnaissance","light_tank","wheeled_vehicles"]},manual_6speed_racing:{name:"Manual Esportiva 6 Marchas",type:"manual",gears:6,weight:420,cost:12500,efficiency:.87,max_input_torque:1800,reliability:.89,maintenance_complexity:.65,driver_skill_required:.65,tech_requirement:{year:1952,level:58},gear_ratios:[4.2,2.6,1.8,1.4,1.1,1],reverse_ratio:4.8,shift_time:1.8,max_speed_road:85,max_speed_offroad:62,terrain_performance:{road:1.15,mud:.95,sand:.92,snow:.94},acceleration_bonus:.18,description:"Transmissão de alta performance para veículos leves e rápidos",optimal_applications:["reconnaissance","armored_car","light_tank"],doctrinal_bonus:{NATO:.1,neutral:.05}},semi_auto_preselector:{name:"Semi-Automática Pré-Seletora",type:"semi_auto",gears:4,weight:450,cost:9800,efficiency:.81,max_input_torque:1950,reliability:.87,maintenance_complexity:.75,driver_skill_required:.55,tech_requirement:{year:1943,level:48},gear_ratios:[4.1,2.4,1.6,1],shift_time:1.5,max_speed_road:72,max_speed_offroad:55,pre_selection:!0,clutch_assisted:!0,description:"Sistema britânico de pré-seleção, usado em tanques Cromwell",historical_note:"Tecnologia britânica Wilson, permite mudanças rápidas sem desacelerar",optimal_applications:["british_tanks","fast_tanks"],doctrinal_bonus:{NATO:.15}},semi_auto_synchromesh:{name:"Semi-Automática Sincronizada",type:"semi_auto",gears:5,weight:520,cost:11500,efficiency:.83,max_input_torque:2100,reliability:.85,maintenance_complexity:.85,driver_skill_required:.45,tech_requirement:{year:1947,level:52},gear_ratios:[3.8,2.3,1.5,1.2,1],shift_time:1.2,max_speed_road:78,max_speed_offroad:58,synchromesh:!0,smooth_shifting:!0,description:"Transmissão com sincronizadores, mudanças suaves mesmo em combate",optimal_applications:["medium_tank","main_battle_tank","heavy_tank"]},automatic_torque_converter:{name:"Automática com Conversor de Torque",type:"automatic",gears:3,weight:680,cost:18500,efficiency:.73,max_input_torque:2800,reliability:.82,maintenance_complexity:1.2,driver_skill_required:.15,tech_requirement:{year:1947,level:62},gear_ratios:[3.6,2.2,1],torque_converter:!0,torque_multiplication:2.4,shift_time:.8,max_speed_road:65,max_speed_offroad:42,fuel_penalty:.18,smooth_operation:!0,description:"Primeira geração de transmissões automáticas militares",historical_note:"Baseada em tecnologia da GM Hydra-Matic, adaptada para uso militar",optimal_applications:["heavy_tank","assault_gun","self_propelled_artillery"],crew_fatigue_reduction:.25,energy_consumption:3},automatic_4speed_advanced:{name:"Automática Avançada 4 Marchas",type:"automatic",gears:4,weight:750,cost:24e3,efficiency:.76,max_input_torque:3200,reliability:.79,maintenance_complexity:1.4,driver_skill_required:.12,tech_requirement:{year:1952,level:68},gear_ratios:[3.4,2.1,1.4,1],torque_converter:!0,torque_multiplication:2.8,shift_time:.6,max_speed_road:72,max_speed_offroad:48,fuel_penalty:.15,adaptive_shifting:!0,description:"Transmissão automática de segunda geração, mais eficiente",optimal_applications:["main_battle_tank","command_vehicle","recovery_vehicle"],crew_fatigue_reduction:.35,doctrinal_bonus:{NATO:.12},energy_consumption:3},planetary_differential_steering:{name:"Planetário com Direção Diferencial",type:"planetary",gears:"variable",weight:920,cost:32e3,efficiency:.77,max_input_torque:4800,reliability:.75,maintenance_complexity:1.8,driver_skill_required:.35,tech_requirement:{year:1949,level:72},steering_system:"differential",pivot_turn:!0,max_speed_road:52,max_speed_offroad:38,maneuverability_bonus:.35,description:"Sistema alemão avançado com direção por alavancas",historical_note:"Usado em tanques alemães Panzer IV tardios e Panther",optimal_applications:["heavy_tank","tank_destroyer","assault_gun"],doctrinal_bonus:{Warsaw:.18},terrain_performance:{urban:1.25,forest:1.15},energy_consumption:4},planetary_hydraulic_assist:{name:"Planetário com Assistência Hidráulica",type:"planetary",gears:"variable",weight:1050,cost:42e3,efficiency:.79,max_input_torque:5500,reliability:.72,maintenance_complexity:2.1,driver_skill_required:.28,tech_requirement:{year:1953,level:78},hydraulic_assist:!0,power_steering:!0,pivot_turn:!0,max_speed_road:58,max_speed_offroad:42,maneuverability_bonus:.45,fuel_penalty:.08,description:"Sistema planetário com assistência hidráulica para veículos super-pesados",optimal_applications:["superheavy_tank","heavy_assault_gun","bunker_buster"],crew_fatigue_reduction:.4,doctrinal_bonus:{NATO:.08,Warsaw:.15},energy_consumption:4},cvt_experimental:{name:"CVT Experimental",type:"cvt",gears:"infinite",weight:850,cost:55e3,efficiency:.81,max_input_torque:2200,reliability:.68,maintenance_complexity:2.5,driver_skill_required:.2,tech_requirement:{year:1954,level:85},continuously_variable:!0,optimal_rpm_range:!0,max_speed_road:75,max_speed_offroad:55,fuel_economy_bonus:.22,acceleration_bonus:.15,description:"Transmissão continuamente variável experimental",historical_note:"Tecnologia experimental, apenas para protótipos avançados",optimal_applications:["prototype","experimental_vehicle"],prototype_only:!0,research_cost_multiplier:3.5},electric_single_speed:{name:"Elétrica Velocidade Única",type:"electric",gears:1,weight:120,cost:28e3,efficiency:.94,max_input_torque:3500,reliability:.91,maintenance_complexity:.8,driver_skill_required:.05,tech_requirement:{year:1952,level:82},instant_torque:!0,silent_operation:!0,max_speed_road:45,max_speed_offroad:35,torque_at_zero_rpm:!0,description:"Transmissão elétrica experimental para veículos híbridos",historical_note:"Baseada em experimentos de Ferdinand Porsche com o Elefant",optimal_applications:["experimental_vehicle","stealth_vehicle"],special_requirements:["electric_motor","battery_pack"],stealth_bonus:.6,prototype_only:!0,energy_consumption:8},hydrostatic_infinite:{name:"Hidrostática de Variação Infinita",type:"hydrostatic",gears:"infinite",weight:780,cost:38e3,efficiency:.75,max_input_torque:4200,reliability:.76,maintenance_complexity:2,driver_skill_required:.25,tech_requirement:{year:1953,level:76},hydraulic_pump:!0,hydraulic_motor:!0,infinite_speed_control:!0,max_speed_road:48,max_speed_offroad:38,maneuverability_bonus:.4,precise_control:!0,description:"Sistema hidrostático para controle preciso de velocidade",optimal_applications:["engineering_vehicle","recovery_vehicle","bridge_layer"],special_capabilities:["precise_positioning","variable_speed_pto"],energy_consumption:5}},X={leaf_spring:{name:"Mola de Lâmina",weight:180,cost:2500,comfort_factor:.65,stability_factor:.85,terrain_performance:.75,reliability:.95,maintenance_complexity:.3,tech_requirement:{year:1930,level:20},ground_clearance:.35,description:"Sistema mais simples e confiável, mas pouco confortável"},coil_spring:{name:"Mola Helicoidal",weight:220,cost:4e3,comfort_factor:.78,stability_factor:.88,terrain_performance:.82,reliability:.9,maintenance_complexity:.5,tech_requirement:{year:1940,level:35},ground_clearance:.42,description:"Melhor conforto que mola de lâmina, mais complexa"},torsion_bar:{name:"Barra de Torção",weight:280,cost:6e3,comfort_factor:.85,stability_factor:.9,terrain_performance:.88,reliability:.85,maintenance_complexity:.7,tech_requirement:{year:1942,level:45},ground_clearance:.45,internal_space_savings:.1,description:"Padrão da era moderna, bom equilíbrio"},christie_suspension:{name:"Suspensão Christie",weight:320,cost:8e3,comfort_factor:.82,stability_factor:.95,terrain_performance:.92,speed_bonus:.12,reliability:.78,maintenance_complexity:1,tech_requirement:{year:1938,level:55},ground_clearance:.48,high_speed_stability:!0,description:"Excelente para alta velocidade, manutenção complexa"},hydropneumatic:{name:"Suspensão Hidropneumática",weight:450,cost:15e3,comfort_factor:.95,stability_factor:.92,terrain_performance:.95,reliability:.72,maintenance_complexity:1.8,tech_requirement:{year:1950,level:75},ground_clearance:.55,variable_height:!0,stabilization_bonus:.25,power_requirement:150,description:"Máximo conforto e performance, muito complexa",energy_consumption:2},adaptive_experimental:{name:"Suspensão Adaptativa Experimental",weight:520,cost:25e3,comfort_factor:.98,stability_factor:.96,terrain_performance:.98,reliability:.68,maintenance_complexity:2.1,tech_requirement:{year:1954,level:85},experimental:!0,ground_clearance:.6,variable_height:!0,automatic_adjustment:!0,stabilization_bonus:.35,power_requirement:300,description:"Sistema que se adapta automaticamente ao terreno",energy_consumption:3},interleaved_roadwheels:{name:"Rodas Intercaladas",weight:380,cost:9500,comfort_factor:.88,stability_factor:.94,terrain_performance:.9,reliability:.75,maintenance_complexity:1.4,tech_requirement:{year:1940,level:60},ground_clearance:.52,track_contact_bonus:.15,maintenance_difficulty:!0,description:"Melhor distribuição de peso, manutenção difícil"}},R={mild_steel:{name:"Aço Comum",effectiveness_factor:.75,weight_factor:1,cost_factor:1,weldability:.95,availability:1,tech_requirement:{year:1939,level:20},spall_resistance:.6},rolled_homogeneous_armor:{name:"Aço Laminado Homogêneo (RHA)",effectiveness_factor:1,weight_factor:1,cost_factor:1.4,weldability:.85,availability:.8,tech_requirement:{year:1942,level:50},spall_resistance:.8},face_hardened_armor:{name:"Blindagem Endurecida Superficialmente",effectiveness_factor:1.15,weight_factor:1.05,cost_factor:1.8,weldability:.7,availability:.6,tech_requirement:{year:1944,level:65},spall_resistance:.85},cast_armor:{name:"Blindagem Fundida",effectiveness_factor:.9,weight_factor:1.25,cost_factor:1.2,weldability:.6,availability:.7,tech_requirement:{year:1940,level:45},spall_resistance:.7,complex_shapes:!0},composite_experimental:{name:"Blindagem Composta Experimental",effectiveness_factor:1.35,weight_factor:1.15,cost_factor:3.5,weldability:.4,availability:.2,tech_requirement:{year:1953,level:85},spall_resistance:.95,experimental:!0,heat_resistance:1.5}},ee={sandbags:{name:"Sacos de Areia",type:"improvised",protection_bonus:15,weight:500,cost:200,coverage:["frontal","lateral"],max_thickness:300,tech_requirement:{year:1939,level:0},effectiveness_vs:{ap:.3,he:.7,heat:.2},durability:.4,weather_resistance:.2,description:"Proteção barata e improvisada, absorve fragmentos"},concrete_blocks:{name:"Blocos de Concreto",type:"improvised",protection_bonus:25,weight:800,cost:300,coverage:["frontal"],max_thickness:400,tech_requirement:{year:1940,level:10},effectiveness_vs:{ap:.4,he:.8,heat:.3},durability:.6,weather_resistance:.9,description:"Proteção sólida mas extremamente pesada"},wood_logs:{name:"Toras de Madeira",type:"improvised",protection_bonus:8,weight:300,cost:50,coverage:["lateral","traseira"],max_thickness:200,tech_requirement:{year:1941,level:0},effectiveness_vs:{ap:.1,he:.5,heat:.3},durability:.3,fire_risk:.25,weather_resistance:.1,description:"Proteção improvisada muito barata, risco de incêndio"},spare_tracks:{name:"Esteiras Sobressalentes",type:"field_modification",protection_bonus:12,weight:200,cost:150,coverage:["frontal","lateral"],max_thickness:50,tech_requirement:{year:1942,level:20},effectiveness_vs:{ap:.6,he:.4,heat:.2},durability:.8,mobility_penalty:.02,description:"Proteção usando peças sobressalentes, prática comum"},fuel_drums_empty:{name:"Tambores Vazios",type:"improvised",protection_bonus:5,weight:150,cost:100,coverage:["traseira","lateral"],max_thickness:200,tech_requirement:{year:1940,level:0},effectiveness_vs:{ap:.1,he:.3,heat:.2},durability:.2,description:"Proteção mínima, mais psicológica que real"},welded_plates_light:{name:"Placas Soldadas Leves",type:"welded_addition",protection_bonus:20,weight:400,cost:1800,coverage:["frontal","lateral"],max_thickness:25,tech_requirement:{year:1942,level:35},effectiveness_vs:{ap:.8,he:.7,heat:.6},durability:.9,weld_quality_factor:.85,description:"Placas de aço leve soldadas, solução econômica"},welded_plates_medium:{name:"Placas Soldadas Médias",type:"welded_addition",protection_bonus:35,weight:600,cost:2800,coverage:["frontal","lateral"],max_thickness:40,tech_requirement:{year:1943,level:45},effectiveness_vs:{ap:.9,he:.8,heat:.7},durability:.9,weld_quality_factor:.9,description:"Placas de espessura média, bom equilíbrio"},welded_plates_heavy:{name:"Placas Soldadas Pesadas",type:"welded_addition",protection_bonus:50,weight:900,cost:4200,coverage:["frontal"],max_thickness:80,tech_requirement:{year:1944,level:55},effectiveness_vs:{ap:.95,he:.85,heat:.8},durability:.95,weld_quality_factor:.95,mobility_penalty:.05,description:"Placas pesadas soldadas, máxima proteção"},welded_additional_plates:{name:"Placas Adicionais Soldadas",type:"welded_armor",protection_bonus:35,weight:450,cost:800,coverage:["frontal","lateral"],max_thickness:60,tech_requirement:{year:1943,level:35},effectiveness_vs:{ap:.85,he:.9,heat:.8},durability:.8,availability:.8,description:"Placas de blindagem soldadas nas oficinas, proteção adicional confiável"},sherman_applique:{name:"Blindagem Aplique Sherman",type:"field_modification",protection_bonus:25,weight:500,cost:2e3,coverage:["frontal"],max_thickness:38,tech_requirement:{year:1944,level:40},effectiveness_vs:{ap:.85,he:.75,heat:.7},durability:.88,historical:!0,description:"Kit de blindagem adicional para M4 Sherman"},era_primitive:{name:"ERA Primitiva Experimental",type:"reactive_armor",protection_bonus:80,weight:300,cost:8e3,coverage:["frontal"],max_thickness:15,tech_requirement:{year:1954,level:85},effectiveness_vs:{ap:.6,he:.95,heat:1.2},durability:.7,experimental:!0,reliability:.75,maintenance_complexity:2,description:"Primeira geração de blindagem reativa explosiva",energy_consumption:1},era_advanced_prototype:{name:"ERA Avançada (Protótipo)",type:"reactive_armor",protection_bonus:120,weight:250,cost:15e3,coverage:["frontal","lateral"],max_thickness:12,tech_requirement:{year:1954,level:95},effectiveness_vs:{ap:.8,he:1.1,heat:1.4},durability:.8,experimental:!0,prototype_only:!0,reliability:.65,maintenance_complexity:3,description:"Protótipo avançado de ERA, tecnologia experimental",energy_consumption:2},cage_armor:{name:"Blindagem Gaiola",type:"standoff_armor",protection_bonus:8,weight:120,cost:800,coverage:["lateral","traseira"],max_thickness:200,tech_requirement:{year:1944,level:35},effectiveness_vs:{ap:.1,he:.4,heat:.9},durability:.6,mobility_penalty:.03,description:"Grades metálicas contra granadas HEAT"},spaced_armor:{name:"Blindagem Espaçada",type:"spaced_armor",protection_bonus:30,weight:400,cost:2500,coverage:["frontal","lateral"],max_thickness:20,tech_requirement:{year:1943,level:50},effectiveness_vs:{ap:.7,he:.9,heat:1.1},durability:.8,air_gap:150,description:"Placas com espaçamento de ar, quebra projéteis HEAT"},schurzen:{name:"Schürzen (Saias Laterais)",type:"side_skirts",protection_bonus:15,weight:180,cost:600,coverage:["lateral"],max_thickness:5,tech_requirement:{year:1943,level:30},effectiveness_vs:{ap:.2,he:.8,heat:.6},durability:.5,historical:!0,description:"Saias laterais alemãs, proteção contra projéteis HE"},composite_ceramic:{name:"Compósito Cerâmico Experimental",type:"composite_armor",protection_bonus:90,weight:600,cost:12e3,coverage:["frontal"],max_thickness:60,tech_requirement:{year:1954,level:90},effectiveness_vs:{ap:1.3,he:1,heat:1.1},durability:.85,experimental:!0,prototype_only:!0,heat_resistance:1.5,description:"Blindagem compósita experimental com cerâmica"},laminated_armor:{name:"Blindagem Laminada Experimental",type:"laminated_armor",protection_bonus:70,weight:550,cost:9500,coverage:["frontal","lateral"],max_thickness:50,tech_requirement:{year:1953,level:80},effectiveness_vs:{ap:1.1,he:.95,heat:1},durability:.9,experimental:!0,spall_resistance:1.3,description:"Múltiplas camadas de materiais diferentes"}},k={vertical_90:{name:"Vertical (90°)",angle:90,effectiveness_multiplier:1,internal_space_factor:1,crew_capacity_penalty:0,weight_distribution:1,visibility_penalty:0,description:"Blindagem vertical tradicional"},sloped_75:{name:"Inclinada 75°",angle:75,effectiveness_multiplier:1.1,internal_space_factor:.95,crew_capacity_penalty:0,weight_distribution:1.05,visibility_penalty:.05,description:"Inclinação leve, bom equilíbrio"},sloped_60:{name:"Inclinada 60°",angle:60,effectiveness_multiplier:1.25,internal_space_factor:.9,crew_capacity_penalty:0,weight_distribution:1.1,visibility_penalty:.1,gun_depression_penalty:2,description:"Inclinação moderada, boa proteção"},sloped_45:{name:"Inclinada 45°",angle:45,effectiveness_multiplier:1.41,internal_space_factor:.85,crew_capacity_penalty:0,weight_distribution:1.15,visibility_penalty:.15,gun_depression_penalty:4,description:"Inclinação acentuada, excelente proteção"},sloped_30:{name:"Extremamente Inclinada 30°",angle:30,effectiveness_multiplier:2,internal_space_factor:.75,crew_capacity_penalty:1,weight_distribution:1.25,visibility_penalty:.25,gun_depression_penalty:8,ammo_capacity_penalty:.2,description:"Proteção máxima, severas limitações internas"},pike_nose:{name:"Nariz de Lúcio",angle:55,effectiveness_multiplier:1.35,internal_space_factor:.8,crew_capacity_penalty:0,weight_distribution:1.2,visibility_penalty:.2,gun_depression_penalty:3,complex_manufacturing:!0,cost_multiplier:1.3,description:"Design angulado complexo, como IS-3"},mantlet_heavy:{name:"Mantlet Pesado",angle:85,effectiveness_multiplier:1.4,internal_space_factor:.9,crew_capacity_penalty:0,weight_distribution:1.3,visibility_penalty:.1,turret_only:!0,gun_handling_penalty:.1,description:"Mantlet blindado reforçado"}},be={gun_76mm_m1:{name:"Canhão 76mm M1 (L/52)",caliber:76,barrel_length:52,weight:1200,cost:15e3,penetration_100m:135,penetration_500m:120,penetration_1000m:105,accuracy:.85,rate_of_fire:8,ammunition_weight:6.8,recoil_force:28e3,tech_requirement:{year:1942,level:55},available_ammunition:["ap","apcr","he","smoke"]},gun_85mm_zis:{name:"Canhão 85mm ZiS-S-53 (L/54)",caliber:85,barrel_length:54,weight:1650,cost:18e3,penetration_100m:165,penetration_500m:145,penetration_1000m:125,accuracy:.82,rate_of_fire:6,ammunition_weight:9.2,recoil_force:35e3,tech_requirement:{year:1943,level:60},available_ammunition:["ap","aphe","he","smoke"]},gun_90mm_m3:{name:"Canhão 90mm M3 (L/53)",caliber:90,barrel_length:53,weight:1900,cost:22e3,penetration_100m:180,penetration_500m:160,penetration_1000m:140,accuracy:.88,rate_of_fire:7,ammunition_weight:10.5,recoil_force:42e3,tech_requirement:{year:1944,level:65},available_ammunition:["ap","apcr","hvap","he","smoke"]},gun_105mm_l7:{name:"Canhão 105mm L7 (L/51)",caliber:105,barrel_length:51,weight:2300,cost:35e3,penetration_100m:220,penetration_500m:195,penetration_1000m:170,accuracy:.9,rate_of_fire:5,ammunition_weight:18.6,recoil_force:58e3,tech_requirement:{year:1951,level:75},available_ammunition:["apds","heat","hesh","he","smoke"],advanced:!0},gun_122mm_d25:{name:"Canhão 122mm D-25T (L/43)",caliber:122,barrel_length:43,weight:2800,cost:28e3,penetration_100m:200,penetration_500m:175,penetration_1000m:150,accuracy:.75,rate_of_fire:3,ammunition_weight:25,recoil_force:75e3,tech_requirement:{year:1943,level:70},available_ammunition:["ap","aphe","he","smoke"],heavy_hitting:!0},gun_100mm_d10t:{name:"Canhão D-10T 100mm (L/56)",caliber:100,barrel_length:56,weight:2700,cost:26e3,penetration_100m:175,penetration_500m:155,penetration_1000m:135,accuracy:.87,rate_of_fire:8,ammunition_weight:15.6,recoil_force:48e3,tech_requirement:{year:1947,level:68},available_ammunition:["ap","aphe","apcr","he","hvap"]},gun_57mm_zis2:{name:"Canhão ZiS-2 57mm (L/73)",caliber:57,barrel_length:73,weight:1400,cost:16e3,penetration_100m:145,penetration_500m:125,penetration_1000m:110,accuracy:.92,rate_of_fire:15,ammunition_weight:2.8,recoil_force:24e3,tech_requirement:{year:1941,level:55},available_ammunition:["ap","apcr","he"],high_velocity:!0},gun_120mm_m58:{name:"Canhão M58 120mm (L/44)",caliber:120,barrel_length:44,weight:3200,cost:48e3,penetration_100m:240,penetration_500m:215,penetration_1000m:185,accuracy:.88,rate_of_fire:4,ammunition_weight:22.3,recoil_force:82e3,tech_requirement:{year:1954,level:80},available_ammunition:["apds","heat","hesh","he","smoke"],advanced:!0,experimental:!0},gun_84mm_20pdr:{name:"Canhão 20-pdr 84mm (L/66)",caliber:84,barrel_length:66,weight:2100,cost:3e4,penetration_100m:190,penetration_500m:170,penetration_1000m:145,accuracy:.9,rate_of_fire:6,ammunition_weight:9.1,recoil_force:45e3,tech_requirement:{year:1948,level:72},available_ammunition:["ap","apds","hesh","he","smoke"]}},te={mg_7_62mm:{name:"Metralhadora 7.62mm",caliber:7.62,weight:65,cost:1800,ammunition_weight:.022,ammo_capacity:1500,rate_of_fire:650,effective_range:800,reliability:.9,tech_requirement:{year:1940,level:40},penetration_armor:8,mount_options:["coaxial","hull","pintle"],description:"Metralhadora padrão para uso coaxial e defesa de infantaria"},mg_7_92mm:{name:"Metralhadora 7.92mm",caliber:7.92,weight:70,cost:1950,ammunition_weight:.025,ammo_capacity:1200,rate_of_fire:700,effective_range:900,reliability:.88,tech_requirement:{year:1940,level:42},penetration_armor:10,mount_options:["coaxial","hull","pintle"],description:"Metralhadora de maior calibre, mais poder de parada"},mg_8mm:{name:"Metralhadora 8mm",caliber:8,weight:68,cost:1900,ammunition_weight:.024,ammo_capacity:1300,rate_of_fire:620,effective_range:850,reliability:.89,tech_requirement:{year:1941,level:41},penetration_armor:9,mount_options:["coaxial","hull","pintle"],description:"Metralhadora equilibrada entre poder e economia"},mg_12_7mm:{name:"Metralhadora Pesada 12.7mm",caliber:12.7,weight:85,cost:2800,ammunition_weight:.108,ammo_capacity:500,rate_of_fire:550,effective_range:1500,aa_capable:!0,reliability:.88,tech_requirement:{year:1942,level:45},penetration_armor:20,mount_options:["turret","hull","commander","aa_mount"],description:"Metralhadora antiaérea, eficaz contra veículos leves"},mg_13mm:{name:"Metralhadora Pesada 13mm",caliber:13,weight:95,cost:3200,ammunition_weight:.125,ammo_capacity:450,rate_of_fire:500,effective_range:1600,aa_capable:!0,reliability:.86,tech_requirement:{year:1943,level:47},penetration_armor:24,mount_options:["turret","hull","aa_mount"],description:"Versão mais potente, maior penetração"},mg_14_5mm:{name:"Metralhadora Pesada 14.5mm",caliber:14.5,weight:120,cost:3500,ammunition_weight:.155,ammo_capacity:400,rate_of_fire:450,effective_range:2e3,aa_capable:!0,reliability:.85,tech_requirement:{year:1944,level:50},penetration_armor:32,mount_options:["turret","hull","aa_mount"],description:"Metralhadora antitanque leve, muito eficaz contra blindagem leve"},mg_15mm:{name:"Metralhadora Pesada 15mm",caliber:15,weight:130,cost:3800,ammunition_weight:.17,ammo_capacity:350,rate_of_fire:400,effective_range:2200,aa_capable:!0,reliability:.83,tech_requirement:{year:1944,level:52},penetration_armor:38,mount_options:["turret","aa_mount"],description:"Quase um canhão automático, máxima potência para metralhadora"},autocannon_20mm:{name:"Canhão Automático 20mm",caliber:20,weight:180,cost:5200,ammunition_weight:.12,ammo_capacity:300,rate_of_fire:350,effective_range:2500,aa_capable:!0,reliability:.82,tech_requirement:{year:1943,level:55},penetration_armor:45,mount_options:["turret","aa_mount"],ammunition_types:["AP","HE","HEI"],description:"Canhão automático versátil, excelente contra aeronaves e blindagem leve"},autocannon_20mm_rapid:{name:"Canhão Automático 20mm Rápido",caliber:20,weight:200,cost:6200,ammunition_weight:.12,ammo_capacity:400,rate_of_fire:600,effective_range:2200,aa_capable:!0,reliability:.78,tech_requirement:{year:1944,level:58},penetration_armor:42,mount_options:["turret","aa_mount"],ammunition_types:["AP","HE","HEI"],description:"Versão de alta cadência para defesa antiaérea"},autocannon_23mm:{name:"Canhão Automático 23mm",caliber:23,weight:210,cost:5800,ammunition_weight:.15,ammo_capacity:280,rate_of_fire:320,effective_range:2800,aa_capable:!0,reliability:.8,tech_requirement:{year:1944,level:56},penetration_armor:52,mount_options:["turret","aa_mount"],ammunition_types:["AP","HE","HEI"],description:"Maior poder de fogo, eficaz contra blindagens médias"},autocannon_25mm:{name:"Canhão Automático 25mm",caliber:25,weight:220,cost:6800,ammunition_weight:.18,ammo_capacity:250,rate_of_fire:280,effective_range:3e3,aa_capable:!0,reliability:.8,tech_requirement:{year:1945,level:60},penetration_armor:58,mount_options:["turret","aa_mount"],ammunition_types:["AP","HE","HEI","APCR"],description:"Canhão pesado, capaz de enfrentar tanques médios"},autocannon_30mm:{name:"Canhão Automático 30mm",caliber:30,weight:280,cost:8500,ammunition_weight:.28,ammo_capacity:200,rate_of_fire:200,effective_range:3500,aa_capable:!0,reliability:.77,tech_requirement:{year:1945,level:65},penetration_armor:72,mount_options:["turret","aa_mount"],ammunition_types:["AP","HE","HEI","APCR"],description:"Canhão automático pesado, quase artilharia antitanque"},flamethrower:{name:"Lança-Chamas",caliber:0,weight:150,cost:4500,ammunition_weight:2.5,ammo_capacity:200,rate_of_fire:0,effective_range:150,aa_capable:!1,reliability:.85,tech_requirement:{year:1943,level:45},penetration_armor:0,mount_options:["hull","turret"],special_effects:["bunker_clearing","infantry_terror"],description:"Arma especializada contra fortificações e infantaria"},smoke_launcher:{name:"Lançador de Fumaça",caliber:76,weight:45,cost:800,ammunition_weight:1.2,ammo_capacity:8,rate_of_fire:0,effective_range:400,aa_capable:!1,reliability:.95,tech_requirement:{year:1942,level:35},penetration_armor:0,mount_options:["turret","hull"],special_effects:["smoke_screen","concealment"],description:"Sistema defensivo para criar cortinas de fumaça"}},ae={cannon_20mm:{name:"Canhão AA 20mm",caliber:20,weight:180,cost:8500,rate_of_fire:800,effective_range:2e3,max_elevation:85,traverse_speed:50,ammunition_weight:.12,ammo_capacity:400,tech_requirement:{year:1943,level:50},penetration_armor:25,aa_effectiveness:.7,mount_options:["single","twin","quad"],description:"Canhão automático leve, alta cadência de tiro"},mg_23mm:{name:"Canhão AA 23mm",caliber:23,weight:280,cost:12e3,rate_of_fire:650,effective_range:2500,max_elevation:85,traverse_speed:45,ammunition_weight:.18,ammo_capacity:250,tech_requirement:{year:1945,level:55},penetration_armor:30,aa_effectiveness:.75,mount_options:["single","twin","quad"],description:"Canhão automático médio, equilibrado"},cannon_25mm:{name:"Canhão AA 25mm",caliber:25,weight:320,cost:14e3,rate_of_fire:550,effective_range:2800,max_elevation:85,traverse_speed:42,ammunition_weight:.22,ammo_capacity:220,tech_requirement:{year:1944,level:52},penetration_armor:35,aa_effectiveness:.78,mount_options:["single","twin","triple"],description:"Canhão automático versátil, boa penetração"},cannon_30mm:{name:"Canhão AA 30mm",caliber:30,weight:420,cost:18e3,rate_of_fire:450,effective_range:3e3,max_elevation:85,traverse_speed:40,ammunition_weight:.35,ammo_capacity:200,tech_requirement:{year:1946,level:60},penetration_armor:45,aa_effectiveness:.85,mount_options:["single","twin"],description:"Canhão pesado, alto poder de parada"},cannon_37mm:{name:"Canhão AA 37mm",caliber:37,weight:580,cost:22e3,rate_of_fire:180,effective_range:3500,max_elevation:85,traverse_speed:35,ammunition_weight:.68,ammo_capacity:150,tech_requirement:{year:1943,level:58},penetration_armor:55,aa_effectiveness:.82,mount_options:["single","twin"],description:"Canhão de calibre médio, boa precisão"},bofors_40mm:{name:"Canhão AA 40mm",caliber:40,weight:650,cost:25e3,rate_of_fire:120,effective_range:4e3,max_elevation:90,traverse_speed:35,ammunition_weight:.95,ammo_capacity:160,tech_requirement:{year:1943,level:65},penetration_armor:65,aa_effectiveness:.9,mount_options:["single","twin","quad"],description:"Canhão padrão NATO, excelente eficácia"},cannon_57mm:{name:"Canhão AA 57mm",caliber:57,weight:980,cost:35e3,rate_of_fire:90,effective_range:5e3,max_elevation:85,traverse_speed:28,ammunition_weight:2.8,ammo_capacity:100,tech_requirement:{year:1944,level:68},penetration_armor:85,aa_effectiveness:.88,dual_purpose:!0,mount_options:["single","twin"],description:"Canhão dual-purpose, eficaz contra terra e ar"},flak_88mm:{name:"Canhão AA 88mm",caliber:88,weight:1800,cost:45e3,rate_of_fire:15,effective_range:8e3,max_elevation:85,traverse_speed:20,ammunition_weight:9.5,ammo_capacity:80,tech_requirement:{year:1944,level:70},penetration_armor:180,aa_effectiveness:.95,dual_purpose:!0,mount_options:["single"],description:"Canhão pesado dual-purpose, lendária eficácia"}},we={optical_sight:{name:"Mira Óptica Básica",type:"optical",weight:25,cost:800,tech_requirement:{year:1940,level:30},accuracy_bonus:.1,night_capable:!1,weather_penalty:.3,description:"Mira óptica simples, operação manual"},mechanical_computer:{name:"Computador Mecânico",type:"mechanical",weight:180,cost:5e3,tech_requirement:{year:1943,level:55},accuracy_bonus:.25,night_capable:!1,weather_penalty:.2,lead_calculation:!0,description:"Sistema mecânico para cálculo de tiro avançado"},radar_tracking:{name:"Radar de Rastreamento",type:"radar",weight:450,cost:15e3,tech_requirement:{year:1944,level:68},accuracy_bonus:.4,night_capable:!0,weather_penalty:.1,lead_calculation:!0,automatic_tracking:!0,detection_range:15e3,description:"Sistema de radar primitivo para rastreamento de alvos",energy_consumption:3},early_computer:{name:"Computador Eletrônico Primitivo",type:"electronic",weight:280,cost:25e3,tech_requirement:{year:1945,level:75},accuracy_bonus:.5,night_capable:!0,weather_penalty:.05,lead_calculation:!0,automatic_tracking:!0,multiple_targets:2,description:"Sistema eletrônico avançado, múltiplos alvos"}},ve={single:{name:"Montagem Única",gun_count:1,weight_multiplier:1,cost_multiplier:1,ammo_multiplier:1,accuracy_bonus:.1,description:"Uma arma, máxima precisão"},twin:{name:"Montagem Dupla",gun_count:2,weight_multiplier:1.8,cost_multiplier:1.7,ammo_multiplier:2,accuracy_bonus:0,firepower_multiplier:1.9,description:"Duas armas, bom equilíbrio"},triple:{name:"Montagem Tripla",gun_count:3,weight_multiplier:2.6,cost_multiplier:2.4,ammo_multiplier:3,accuracy_penalty:-.1,firepower_multiplier:2.7,description:"Três armas, alto poder de fogo"},quad:{name:"Montagem Quádrupla",gun_count:4,weight_multiplier:3.2,cost_multiplier:3,ammo_multiplier:4,accuracy_penalty:-.2,firepower_multiplier:3.4,description:"Quatro armas, máximo poder de fogo"}},ie={basic_periscope:{name:"Periscópio Básico",weight:15,cost:800,magnification:"1x",field_of_view:60,accuracy_bonus:0,range_estimation:0,tech_requirement:{year:1935,level:25},night_vision:!1,reliability:.95,energy_consumption:1},telescopic_sight:{name:"Mira Telescópica 4x",weight:35,cost:2500,magnification:"4x",field_of_view:15,accuracy_bonus:.15,range_estimation:.1,tech_requirement:{year:1940,level:40},night_vision:!1,reliability:.9,energy_consumption:1},coincidence_rangefinder:{name:"Telêmetro de Coincidência",weight:85,cost:8e3,magnification:"8x",field_of_view:8,accuracy_bonus:.25,range_estimation:.3,max_range:3e3,tech_requirement:{year:1942,level:55},night_vision:!1,reliability:.85,requires_training:!0,energy_consumption:1},stereoscopic_rangefinder:{name:"Telêmetro Estereoscópico",weight:120,cost:15e3,magnification:"10x",field_of_view:6,accuracy_bonus:.3,range_estimation:.45,max_range:4e3,tech_requirement:{year:1945,level:65},night_vision:!1,reliability:.82,requires_training:!0,energy_consumption:1},infrared_sight_basic:{name:"Mira Infravermelha Básica",weight:150,cost:25e3,magnification:"3x",field_of_view:20,accuracy_bonus:.1,range_estimation:.05,effective_range:800,tech_requirement:{year:1943,level:70},night_vision:!0,reliability:.75,power_consumption:800,operational_time:4,energy_consumption:4},infrared_sight_advanced:{name:"Sistema IV Avançado",weight:200,cost:45e3,magnification:"6x",field_of_view:12,accuracy_bonus:.2,range_estimation:.15,effective_range:1200,tech_requirement:{year:1950,level:80},night_vision:!0,reliability:.78,power_consumption:1200,operational_time:6,experimental:!0,energy_consumption:4}},ne={signal_flags:{name:"Bandeiras de Sinalização",weight:5,cost:100,range:2,reliability:.95,weather_resistance:.3,tech_requirement:{year:1900,level:10},requires_training:!1,energy_consumption:0},radio_basic:{name:"Rádio Básico",weight:25,cost:2500,range:5,reliability:.8,weather_resistance:.7,tech_requirement:{year:1940,level:35},power_consumption:50,frequency_bands:1,energy_consumption:3},radio_advanced:{name:"Rádio Avançado",weight:35,cost:5e3,range:15,reliability:.85,weather_resistance:.8,tech_requirement:{year:1944,level:50},power_consumption:80,frequency_bands:3,encryption_capable:!1,energy_consumption:6},radio_fm:{name:"Rádio FM Militar",weight:45,cost:8500,range:25,reliability:.9,weather_resistance:.9,tech_requirement:{year:1948,level:65},power_consumption:120,frequency_bands:10,encryption_capable:!0,energy_consumption:7},radio_command:{name:"Estação de Comando",weight:80,cost:15e3,range:50,reliability:.87,weather_resistance:.85,tech_requirement:{year:1945,level:60},power_consumption:200,frequency_bands:5,encryption_capable:!0,command_bonus:2,special:"artillery_coordination",energy_consumption:8}},oe={spall_liner:{name:"Revestimento Anti-Fragmentos",weight:200,cost:8e3,crew_survival_bonus:.25,internal_damage_reduction:.2,tech_requirement:{year:1943,level:50},installation_complexity:.6,space_required:.3,energy_consumption:1},wet_ammunition_storage:{name:"Armazenamento Úmido de Munição",weight:150,cost:6e3,explosion_resistance:.4,ammo_capacity_reduction:.15,fire_suppression_bonus:.5,tech_requirement:{year:1944,level:55},maintenance_complexity:.3,energy_consumption:1},fire_suppression_system:{name:"Sistema Supressão Automática",weight:80,cost:12e3,fire_suppression_bonus:.75,power_consumption:100,activation_time:2,tech_requirement:{year:1950,level:70},reliability:.88,refill_cost:500,energy_consumption:1},escape_hatches:{name:"Escotilhas de Emergência",weight:120,cost:3e3,crew_survival_bonus:.15,escape_time_reduction:.4,armor_integrity_reduction:.05,tech_requirement:{year:1940,level:30},energy_consumption:1},commanders_cupola:{name:"Cúpula do Comandante",weight:180,cost:5500,visibility_bonus:.3,command_efficiency:.2,armor_thickness:25,rotating:!0,tech_requirement:{year:1942,level:45},vulnerability_increase:.1,energy_consumption:1},periscope_array:{name:"Array de Periscópios",weight:45,cost:3200,visibility_bonus:.15,blind_spot_reduction:.25,tech_requirement:{year:1940,level:40},fragility_factor:1.3,energy_consumption:1},searchlight_infrared:{name:"Holofote Infravermelho",weight:60,cost:8e3,night_combat_bonus:.35,detection_range:600,power_consumption:500,tech_requirement:{year:1945,level:65},gives_away_position:!0,energy_consumption:6},extra_fuel_tanks_external:{name:"Tanques Externos de Combustível",weight:300,cost:3e3,range_bonus:.5,fire_vulnerability:.25,jettison_capable:!0,armor_reduction_sides:.1,tech_requirement:{year:1940,level:25},energy_consumption:1},extra_fuel_tanks_internal:{name:"Tanques Internos Extras",weight:400,cost:4500,range_bonus:.35,fire_vulnerability:.1,internal_space_reduction:.15,tech_requirement:{year:1942,level:35},energy_consumption:1},deep_wading_kit:{name:"Kit Vadeamento Profundo",weight:250,cost:6e3,water_crossing_depth:4,installation_time:2,speed_reduction_water:.6,tech_requirement:{year:1943,level:50},available_to:["NATO","Warsaw"],energy_consumption:1},mine_roller:{name:"Rolos Detectores de Mina",weight:800,cost:8500,mine_clearance_capability:!0,speed_reduction:.3,ground_pressure_increase:.25,detachable:!0,tech_requirement:{year:1942,level:45},energy_consumption:1},dozer_blade:{name:"Lâmina Bulldozer",weight:600,cost:7500,earthwork_capability:!0,obstacle_clearing:!0,speed_reduction:.2,frontal_protection_bonus:.15,tech_requirement:{year:1944,level:40},energy_consumption:1},camouflage_nets:{name:"Redes de Camuflagem",weight:50,cost:800,concealment_bonus:.2,setup_time:15,air_detection_reduction:.25,tech_requirement:{year:1940,level:20},weather_degradation:!0,energy_consumption:1},smoke_dispensers:{name:"Lança-fumígenos",weight:80,cost:5e3,smoke_deployment_range:50,concealment_duration:3,reload_time:30,tech_requirement:{year:1943,level:40},ammo_capacity:12,energy_consumption:1},exhaust_smoke_system:{name:"Sistema Fumígeno por Escape",weight:35,cost:3500,continuous_smoke:!0,fuel_consumption_increase:.15,engine_performance_reduction:.08,tech_requirement:{year:1941,level:35},available_to:["Warsaw"],energy_consumption:1},radio_jammer:{name:"Jammer de Rádio",weight:120,cost:18e3,enemy_communication_disruption:.6,jamming_range:10,power_consumption:300,tech_requirement:{year:1952,level:80},experimental:!0,energy_consumption:9},radar_detector:{name:"Detector de Radar",weight:45,cost:15e3,radar_warning:!0,detection_range:25,power_consumption:80,tech_requirement:{year:1954,level:85},experimental:!0,energy_consumption:12},improved_ventilation:{name:"Ventilação Melhorada",weight:90,cost:2500,crew_endurance_bonus:.15,nbc_protection_bonus:.2,power_consumption:150,tech_requirement:{year:1948,level:45},energy_consumption:1},crew_heater:{name:"Aquecedor da Tripulação",weight:35,cost:1800,cold_weather_performance:.25,crew_comfort_bonus:.2,power_consumption:200,fuel_consumption_increase:.05,tech_requirement:{year:1942,level:30},energy_consumption:1},improved_seats:{name:"Assentos Ergonômicos",weight:60,cost:2200,crew_fatigue_reduction:.18,accuracy_bonus_long_missions:.08,tech_requirement:{year:1945,level:35},available_to:["NATO"],energy_consumption:1},field_repair_kit:{name:"Kit Reparos de Campo",weight:150,cost:4500,field_repair_capability:.3,maintenance_time_reduction:.2,consumable_cost_per_use:200,tech_requirement:{year:1940,level:40},energy_consumption:1},spare_parts_storage:{name:"Compartimento Peças Sobressalente",weight:200,cost:3e3,reliability_bonus:.12,maintenance_interval_extension:.15,internal_space_reduction:.1,tech_requirement:{year:1941,level:35},energy_consumption:1},diagnostic_equipment:{name:"Equipamento Diagnóstico",weight:80,cost:12e3,fault_detection_speed:.5,preventive_maintenance_bonus:.25,power_consumption:100,tech_requirement:{year:1950,level:75},requires_training:!0,energy_consumption:1}},re={basic_optical:{name:"Mira Óptica Básica",weight:25,cost:2e3,type:"optical",accuracy_bonus:0,range_bonus:0,night_fighting:.1,tech_requirement:{year:1940,level:30},energy_consumption:0},coincidence_rangefinder:{name:"Telêmetro de Coincidência",weight:85,cost:8e3,type:"optical",accuracy_bonus:.15,range_bonus:.2,night_fighting:.1,tech_requirement:{year:1944,level:55},energy_consumption:1},stereoscopic_rangefinder:{name:"Telêmetro Estereoscópico",weight:120,cost:15e3,type:"optical",accuracy_bonus:.25,range_bonus:.35,night_fighting:.15,tech_requirement:{year:1948,level:65},available_to:["NATO","neutral"],energy_consumption:2},early_ballistic_computer:{name:"Computador Balístico Primitivo",weight:200,cost:45e3,type:"electronic",accuracy_bonus:.35,range_bonus:.5,night_fighting:.2,first_hit_probability:.4,tech_requirement:{year:1952,level:80},experimental:!0,power_consumption:500}},xe={mbt_standard:{name:"Tanque de Batalha Padrão",role:"main_battle_tank",priority_components:{main_gun:{min_penetration:160,weight_factor:.25},armor:{min_effectiveness:120,weight_factor:.3},mobility:{min_power_to_weight:12,weight_factor:.2},reliability:{min_reliability:.8,weight_factor:.25}},recommended_equipment:["spall_liner","wet_ammunition_storage","commanders_cupola"],crew_size:4,doctrine_variants:{NATO:{accuracy_focus:!0,advanced_optics:!0},Warsaw:{armor_focus:!0,simplified_systems:!0},neutral:{balanced_approach:!0,cost_effective:!0}}},mbt_heavy:{name:"Tanque Pesado de Batalha",role:"heavy_battle_tank",priority_components:{main_gun:{min_penetration:200,weight_factor:.3},armor:{min_effectiveness:180,weight_factor:.4},mobility:{min_power_to_weight:8,weight_factor:.15},reliability:{min_reliability:.75,weight_factor:.15}},recommended_equipment:["spall_liner","fire_suppression_system","extra_fuel_tanks_internal"],crew_size:5,weight_class:"heavy"},tank_destroyer_mobile:{name:"Caça-Tanques Móvel",role:"tank_destroyer",priority_components:{main_gun:{min_penetration:180,weight_factor:.35},mobility:{min_power_to_weight:15,weight_factor:.3},concealment:{stealth_focus:!0,weight_factor:.2},reliability:{min_reliability:.85,weight_factor:.15}},recommended_equipment:["camouflage_nets","smoke_dispensers","improved_optics"],crew_size:4,armor_philosophy:"minimal_frontal_only"},tank_destroyer_assault:{name:"Caça-Tanques de Assalto",role:"assault_tank_destroyer",priority_components:{main_gun:{min_penetration:220,weight_factor:.3},armor:{min_effectiveness:150,weight_factor:.35},mobility:{min_power_to_weight:10,weight_factor:.2},reliability:{min_reliability:.78,weight_factor:.15}},recommended_equipment:["spall_liner","extra_ammunition","dozer_blade"],crew_size:4,armor_philosophy:"heavy_frontal_casemate"},spaa_light:{name:"Antiaérea Autopropulsada Leve",role:"self_propelled_anti_aircraft",priority_components:{main_gun:{aa_capability:!0,weight_factor:.3},mobility:{min_power_to_weight:18,weight_factor:.35},detection:{radar_capable:!0,weight_factor:.2},reliability:{min_reliability:.85,weight_factor:.15}},recommended_equipment:["radio_advanced","radar_detector","quad_maxim"],crew_size:3,armor_philosophy:"light_protection_only",special_requirements:["open_turret","high_elevation_gun"]},apc_standard:{name:"Transporte Blindado de Pessoal",role:"armored_personnel_carrier",priority_components:{mobility:{min_power_to_weight:15,weight_factor:.3},troop_capacity:{min_troops:8,weight_factor:.25},protection:{min_armor:25,weight_factor:.25},reliability:{min_reliability:.88,weight_factor:.2}},recommended_equipment:["improved_ventilation","radio_basic","periscope_array"],crew_size:3,troop_capacity:10,armor_philosophy:"all_around_light_protection"},recovery_vehicle:{name:"Veículo de Recuperação",role:"armored_recovery_vehicle",priority_components:{mobility:{min_power_to_weight:12,weight_factor:.25},reliability:{min_reliability:.9,weight_factor:.3},utility:{recovery_capability:!0,weight_factor:.35},protection:{min_armor:40,weight_factor:.1}},recommended_equipment:["field_repair_kit","spare_parts_storage","diagnostic_equipment"],crew_size:4,special_requirements:["winch_system","crane_capability","welding_equipment"],armor_philosophy:"basic_protection"},self_propelled_artillery:{name:"Artilharia Autopropulsada",role:"self_propelled_artillery",priority_components:{main_gun:{indirect_fire:!0,weight_factor:.35},mobility:{min_power_to_weight:10,weight_factor:.25},communication:{long_range_radio:!0,weight_factor:.25},reliability:{min_reliability:.82,weight_factor:.15}},recommended_equipment:["radio_command","extra_fuel_tanks_internal","camouflage_nets"],crew_size:5,armor_philosophy:"minimal_protection",special_requirements:["high_elevation_gun","large_ammunition_storage"]},command_vehicle:{name:"Veículo de Comando",role:"command_vehicle",priority_components:{communication:{advanced_radio:!0,weight_factor:.4},mobility:{min_power_to_weight:14,weight_factor:.25},protection:{min_armor:60,weight_factor:.2},reliability:{min_reliability:.88,weight_factor:.15}},recommended_equipment:["radio_command","improved_ventilation","commanders_cupola","periscope_array"],crew_size:6,special_requirements:["multiple_radios","map_table","extended_range_antennas"],armor_philosophy:"medium_protection"},engineer_vehicle:{name:"Veículo de Engenharia",role:"engineer_vehicle",priority_components:{utility:{engineering_capability:!0,weight_factor:.35},mobility:{min_power_to_weight:12,weight_factor:.3},protection:{min_armor:50,weight_factor:.2},reliability:{min_reliability:.85,weight_factor:.15}},recommended_equipment:["dozer_blade","mine_roller","field_repair_kit","deep_wading_kit"],crew_size:4,special_requirements:["engineering_tools","obstacle_clearing"],armor_philosophy:"frontal_protection_focus"},flamethrower_tank:{name:"Tanque Lança-Chamas",role:"flamethrower_tank",priority_components:{special_weapon:{flamethrower:!0,weight_factor:.35},protection:{min_armor:80,weight_factor:.3},mobility:{min_power_to_weight:11,weight_factor:.2},reliability:{min_reliability:.8,weight_factor:.15}},recommended_equipment:["fire_suppression_system","spall_liner","escape_hatches"],crew_size:4,special_requirements:["flame_fuel_tank","protective_equipment"],armor_philosophy:"heavy_all_around",high_risk_role:!0}};let se=null,o={name:"",type:null,chassis:null,engine:null,transmission:null,suspension:null,armorMaterial:"rolled_homogeneous_armor",armorThickness:0,crewSize:3,trainingLevel:"standard",armor_material:null,armor_thickness:80,additional_armor:[],armorAngle:"vertical_90",main_gun_caliber:75,main_gun_length_ratio:40,ammo_view:"AP",secondary_weapons:[],aa_gun:null,ammunition:{},optics:null,communication:null,fcs:null,special_equipment:[],crew_positions:[],crew_training:"regular",crew_specialization:"none",crew_ergonomics:"basic",quantity:1};const w={chassis:E,engines:P,transmissions:D,suspensions:X,armor_materials:R,additional_armor:ee,armor_angles:k,main_guns:be,secondary_weapons:te,aa_guns:ae,aa_fire_control:we,aa_mount_configs:ve,optics_systems:ie,communication:ne,special_equipment:oe,fire_control:re,vehicle_templates:xe};async function ce(){try{const{getFirestore:e}=await O(async()=>{const{getFirestore:i}=await import("https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js");return{getFirestore:i}},[]),{getApps:t,getApp:a}=await O(async()=>{const{getApps:i,getApp:r}=await import("https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js");return{getApps:i,getApp:r}},[]),n=t().length?a():null;n&&(se=e(n),await Ce())}catch(e){console.error("Error initializing Firebase:",e),de()}}async function Ce(){try{const{collection:e,getDocs:t}=await O(async()=>{const{collection:i,getDocs:r}=await import("https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js");return{collection:i,getDocs:r}},[]),a=await t(e(se,"paises")),n={};a.forEach(i=>{const r=i.data(),s=qe(i.id);n[i.id]={name:i.id,industry:r.Industria||50,vehicles:r.Veiculos||50,steel_production:r.CapacidadeProducaoAco||0,vehicle_production:r.CapacidadeProducaoVeiculos||0,budget:r.Orcamento||0,doctrine:s,tech_level:Ae(r),year:1954,available_materials:Ee(s,r),research_points:r.PontosP||0}}),window.gameCountries=n,me()}catch(e){console.error("Error loading countries:",e),de()}}function qe(e){const t=["EUA","Reino Unido","França","Alemanha Ocidental","Canadá","Itália","Holanda","Bélgica"],a=["URSS","Alemanha Oriental","Polônia","Checoslováquia","Hungria","Romênia","Bulgária","China"];return t.includes(e)?"NATO":a.includes(e)?"Warsaw":"neutral"}function Ae(e){const t=e.Tecnologia||50,a=(e.Veiculos||50)*.3,n=(e.Industria||50)*.2;return Math.min(100,t+a+n)}function Ee(e,t){const a=["mild_steel","rolled_homogeneous_armor"],n=t.Industria||50,i=t.Tecnologia||50;return n>=70&&i>=60&&a.push("face_hardened_armor"),e==="NATO"&&i>=75&&a.push("composite_experimental"),a}function u(e,t){if(!e||!t||!w[e])return null;const a=w[e][t];if(!a)return null;if(!a.base||!a.tuning)return{...a};const n=window.currentVehicle.chassis;if(!n)return{...a.base,name:a.name};const r=w.chassis[n]?.weight_class||"medium",s=a.tuning[r];let c={...a.base};if(c.name=a.name,s)for(const[m,l]of Object.entries(s))m==="name_suffix"?c.name+=l:typeof c[m]=="number"?c[m]+=l:c[m]=l;return c}function U(e,t){const a=w[e]?.[t];if(!a)return{compatible:!1,reason:"Componente não encontrado"};const n=u(e,t);if(!n)return{compatible:!1,reason:"Falha ao resolver componente"};const i=le();if(!i)return{compatible:!0};const r=a.tech_requirement||n.tech_requirement;if(r&&i.tech_level<r.level)return{compatible:!1,reason:`Tecnologia insuficiente. Necessário: ${r.level}%`};if(r&&i.year<r.year)return{compatible:!1,reason:`Não disponível em ${i.year}`};if((a.experimental||n.experimental)&&i.research_points<100)return{compatible:!1,reason:"Requer 100+ pontos de P&D"};if(!o.chassis)return{compatible:!0};const s=w.chassis[o.chassis];if(!s)return{compatible:!0};if(e==="engines"){if(s.compatible_engines&&!s.compatible_engines.includes(a.category))return{compatible:!1,reason:`Chassi não suporta motores da categoria '${a.category}'`};if(s.max_engine_power&&n.power>s.max_engine_power)return{compatible:!1,reason:`Potência excede o limite de ${s.max_engine_power}hp`};if(s.min_engine_power&&n.power<s.min_engine_power)return{compatible:!1,reason:`Potência abaixo do mínimo de ${s.min_engine_power}hp`}}return e==="transmissions"&&s.compatible_transmissions&&!s.compatible_transmissions.includes(n.type)?{compatible:!1,reason:`Chassi não suporta transmissão do tipo '${n.type}'`}:e==="suspensions"&&s.compatible_suspensions&&!s.compatible_suspensions.includes(t)?{compatible:!1,reason:"Suspensão não compatível com este chassi"}:e==="secondary_weapons"&&s.compatible_secondary_weapons&&!s.compatible_secondary_weapons.includes(t)?{compatible:!1,reason:"Arma secundária não compatível"}:{compatible:!0}}function G(){if(!o.chassis||!o.engine)return{error:"Chassi e motor são obrigatórios"};const e=u("chassis",o.chassis),t=u("engines",o.engine),a=u("transmissions",o.transmission),n=u("main_guns",o.mainGun);let i=e.base_weight+t.weight;if(a&&(i+=a.weight),n&&(i+=n.weight),o.armorThickness&&o.armorMaterial){const x=u("armor_materials",o.armorMaterial);if(x){const C=e.weight_class==="light"?25:e.weight_class==="medium"?35:50,z=o.armorThickness*.001*C*7850*x.weight_factor;i+=z}}let r=o.crewSize||3;const s=u("armor_angles",o.armorAngle||"vertical_90");s?.crew_capacity_penalty&&(r=Math.max(1,r-s.crew_capacity_penalty));const c=r*80;i+=c;const m=o.special_equipment||[];Array.isArray(m)&&m.forEach(x=>{const C=u("special_equipment",x);C&&(i+=C.weight)});const l=i>e.max_weight_capacity,p=(i-e.max_weight_capacity)/e.max_weight_capacity*100,g=t.power/(i/1e3),y=a?a.efficiency:.85,f=e.base_speed,b=Math.min(1.5,g/15),q=i>e.max_weight_capacity*.8?.85:1,d={road:Math.round(f*b*y*q*e.terrain_mult.road),offroad:Math.round(f*b*y*q*e.terrain_mult.offroad),mud:Math.round(f*b*y*q*e.terrain_mult.mud),snow:Math.round(f*b*y*q*e.terrain_mult.snow)},h=t.consumption,S=e.fuel_consumption_base,J=i>e.base_weight*1.5?1.3:1,N=h*S*J;let K=0;if(o.armorThickness&&o.armorMaterial){const x=u("armor_materials",o.armorMaterial),C=u("armor_angles",o.armorAngle||"vertical_90"),z=o.additionalArmor||[];if(x){let T=o.armorThickness;T*=x.effectiveness_factor||1,C?.effectiveness_multiplier&&(T*=C.effectiveness_multiplier),z.forEach(ye=>{const H=u("additional_armor",ye);H?.protection_bonus&&(T+=H.protection_bonus*(H.effectiveness_vs?.ap||1))}),K=Math.round(T)}}let v=(t.reliability+e.reliability)/2;a&&(v=(v*2+a.reliability)/3);const he={rookie:-.15,standard:0,veteran:.1,elite:.2}[o.trainingLevel]||0;v+=he,l&&(v*=.9),t.experimental&&(v*=.85),o.special_equipment?.length>3&&(v*=.95);const fe=Math.round(Math.min(100,Math.max(0,v*100)));return{totalWeight:Math.round(i),powerToWeight:Math.round(g*10)/10,topSpeed:d,fuelConsumption:Math.round(N*10)/10,armorProtection:K,reliability:fe,crewSize:r,effectiveCrewSize:r,trainingLevel:o.trainingLevel||"standard",overweight:l,overweightPercent:l?Math.round(p):0,armorAnglePenalties:s?{crewPenalty:s.crew_capacity_penalty||0,gunDepressionPenalty:s.gun_depression_penalty||0}:null,warnings:Se(i,e,t,g,s)}}function Se(e,t,a,n,i){const r=[];return e>t.max_weight_capacity&&r.push({level:"error",message:`Veículo ${Math.round((e-t.max_weight_capacity)/t.max_weight_capacity*100)}% acima do limite de peso do chassi`}),n<10&&r.push({level:"warning",message:"Relação potência/peso baixa. Veículo será lento e com dificuldades em terrenos difíceis"}),n>25&&r.push({level:"warning",message:"Relação potência/peso muito alta. Pode causar problemas de controle e confiabilidade"}),a.experimental&&r.push({level:"info",message:"Motor experimental: maior potência, mas menor confiabilidade e custos de manutenção elevados"}),a.fuel_type==="kerosene"&&r.push({level:"warning",message:"Combustível especial (querosene): logística complexa e consumo elevado"}),i&&(i.crew_capacity_penalty>0&&r.push({level:"warning",message:`Blindagem extremamente inclinada reduz tripulação em ${i.crew_capacity_penalty} membros`}),i.gun_depression_penalty>5&&r.push({level:"warning",message:`Ângulo da blindagem limita depressão do canhão em ${i.gun_depression_penalty}°`})),r}function W(){let e=0,t=0,a=0;const n=le();if(!n)return{error:"País não identificado"};if(o.chassis){const d=u("chassis",o.chassis);e+=d.base_cost,t+=d.base_cost*.001*d.maintenance_complexity}if(o.engine){const d=u("engines",o.engine);e+=d.cost,t+=d.maintenance_hours*50;const h=d.fuel_type==="kerosene"?2.5:d.fuel_type==="diesel"?1.2:1;a+=d.consumption*1e3*h}if(o.transmission){const d=u("transmissions",o.transmission);e+=d.cost,t+=d.cost*8e-4*d.maintenance_complexity}if(o.mainGun){const d=u("main_guns",o.mainGun);e+=d.cost,t+=25}if(o.armorThickness&&o.armorMaterial){const d=u("armor_materials",o.armorMaterial),h=u("chassis",o.chassis);if(d&&h){const S=h.weight_class==="light"?25:h.weight_class==="medium"?35:50,N=o.armorThickness*.001*S*7850*2*d.cost_factor;e+=N}}const i={rookie:5e3,standard:8e3,veteran:15e3,elite:25e3},r=o.crewSize||3,s=o.trainingLevel||"standard",c=i[s]*r;e+=c;const m=o.special_equipment||[];if(Array.isArray(m)&&m.forEach(d=>{const h=u("special_equipment",d);h&&(e+=h.cost,h.power_consumption&&(a+=h.power_consumption*.15*8760))}),o.fcs){const d=u("fire_control",o.fcs);d&&(e+=d.cost,d.power_consumption&&(a+=d.power_consumption*.15*8760))}const p={NATO:1.25,Warsaw:.85,neutral:1.1}[n.doctrine]||1;e*=p;let g=0;[o.engine,o.mainGun,o.fcs].forEach(d=>{if(d){const h=u(Object.keys(w).find(S=>w[S][d]),d);h&&h.experimental&&(g+=e*.15)}});const y=e+g,f=y*o.quantity;ke();const b=n.vehicle_production||1e5,q=Math.max(1,Math.ceil(f/b*12));return{unitCost:Math.round(y),totalCost:Math.round(f),maintenanceCostPerHour:Math.round(t),annualOperatingCost:Math.round(a),researchCost:Math.round(g),crewTrainingCost:Math.round(c),productionTimeMonths:q,affordability:f<=n.budget?"affordable":"expensive",budgetPercentage:Math.round(f/n.budget*100)}}function ke(){let e=1;if(o.engine){const t=u("engines",o.engine);t.experimental&&(e+=.5),t.fuel_type==="kerosene"&&(e+=.3)}if(o.transmission){const t=u("transmissions",o.transmission);e+=t.maintenance_complexity*.2}return e}function le(){const e=localStorage.getItem("loggedCountry")||localStorage.getItem("currentCountry")||localStorage.getItem("selectedCountry")||localStorage.getItem("playerCountry");return e&&window.gameCountries&&window.gameCountries[e]?window.gameCountries[e]:{name:"Default Country",doctrine:"NATO",budget:1e9,vehicle_production:5e4}}function Me(){console.log("Setting up advanced UI...")}function me(){console.log("Countries loaded:",Object.keys(window.gameCountries||{}))}function de(){window.gameCountries={EUA:{name:"EUA",doctrine:"NATO",tech_level:85,budget:1e9},URSS:{name:"URSS",doctrine:"Warsaw",tech_level:80,budget:8e8},Brasil:{name:"Brasil",doctrine:"neutral",tech_level:45,budget:5e7}},me()}document.addEventListener("DOMContentLoaded",function(){console.log("Initializing Advanced Vehicle Creator..."),ce(),Me()});function _(){console.log("🔄 Iniciando atualização completa dos cálculos..."),console.log("🔍 Estado atual do currentVehicle:",o);try{if(window.currentVehicle){const e=new Set(Array.isArray(window.currentVehicle.additionalArmor)?window.currentVehicle.additionalArmor:[]),t=new Set(Array.isArray(window.currentVehicle.additional_armor)?window.currentVehicle.additional_armor:[]),a=Array.from(new Set([...e,...t]));window.currentVehicle.additionalArmor=a,window.currentVehicle.additional_armor=a}}catch(e){console.error("❌ Erro na sincronização de blindagem adicional:",e)}if(!o?.chassis){console.log("⚠️ Nenhum chassi selecionado - atualizações limitadas");try{$(),I(),M(),console.log("✅ Atualizações básicas concluídas sem chassi")}catch(e){console.error("❌ Erro nas atualizações básicas:",e)}return}try{console.log("🔧 Iniciando cálculo de física...");const e=G();if(console.log("🔧 Física calculada:",e),e.error){console.error("❌ Erro na física:",e.error);return}console.log("💰 Iniciando cálculo de custos...");const t=window.CostSystem?window.CostSystem.calculateCosts(o):W();console.log("💰 Custos calculados:",t),t.error&&console.error("❌ Erro nos custos:",t.error),console.log("📱 Atualizando displays..."),Pe(e,t),console.log("⚡ Atualizando energia..."),$(),console.log("🏃 Atualizando performance..."),I(),console.log("💰 Atualizando custos..."),M(),console.log("📊 Atualizando gráfico..."),window.updatePerformanceChart&&window.updatePerformanceChart(e),console.log("✅ Todos os cálculos foram atualizados com sucesso")}catch(e){console.error("❌ Erro ao atualizar cálculos do veículo:",e),console.error("❌ Stack trace:",e.stack)}}function Pe(e,t){const a=document.getElementById("total-weight");a&&e.totalWeight&&(a.textContent=e.totalWeight+"kg");const n=document.getElementById("armor-protection");n&&e.armorProtection&&(n.innerHTML=`<span class="text-brand-400">${e.armorProtection}mm efetivos</span>`);const i=document.getElementById("crew-size");if(i&&e.effectiveCrewSize){const s=e.effectiveCrewSize<(o.crewSize||3)?`${e.effectiveCrewSize}/${o.crewSize||3} (reduzida)`:e.effectiveCrewSize.toString();i.textContent=s}const r=document.getElementById("power-to-weight");r&&e.powerToWeight&&(r.textContent=e.powerToWeight+" hp/ton")}window.initFirebase=ce;window.VEHICLE_COMPONENTS=w;window.currentVehicle=o;window.checkComponentCompatibility=U;window.calculateVehiclePhysics=G;window.calculateVehicleCosts=W;window.updateVehicleCalculations=_;window.getResolvedComponent=u;document.addEventListener("DOMContentLoaded",function(){setTimeout(()=>{window.CostSystem?(console.log("✅ CostSystem initialized with components"),M()):console.warn("⚠️ CostSystem not found - cost calculations may not work")},100)});function Le(e){if(!window.currentVehicle?.chassis||!window.VEHICLE_COMPONENTS)return{compatible:!0};const t=u("chassis",window.currentVehicle.chassis);return t?t.aa_only&&e>0?{compatible:!1,reason:"Chassis SPAA não permite canhão principal. Use apenas armas AA."}:t.artillery_specialized&&e<t.min_main_gun_caliber?{compatible:!1,reason:`Chassis SPG requer calibres de pelo menos ${t.min_main_gun_caliber}mm`}:t.max_main_gun_caliber&&e>t.max_main_gun_caliber?{compatible:!1,reason:`Calibre muito grande (${e}mm). Chassis suporta até ${t.max_main_gun_caliber}mm`}:e>130&&!t.large_caliber_capable?{compatible:!1,reason:"Calibres >130mm só são permitidos em chassis SPG especializados"}:{compatible:!0}:{compatible:!0}}function Te(){!window.currentVehicle?.chassis||!window.VEHICLE_COMPONENTS||u("chassis",window.currentVehicle.chassis)}window.checkMainGunCaliber=Le;window.updateChassisLimits=Te;window.filterCompatibleComponents=function(e){if(!window.VEHICLE_COMPONENTS||!window.currentVehicle?.chassis)return window.VEHICLE_COMPONENTS?.[e]||{};const t=window.VEHICLE_COMPONENTS[e],a={};for(const n in t)window.checkComponentCompatibility(e,n).compatible&&(a[n]=t[n]);return a};window.selectChassis=function(e){if(!window.VEHICLE_COMPONENTS?.chassis[e]){console.error("Chassis not found:",e);return}window.currentVehicle.chassis=e,console.log("Selected chassis:",e),window.currentVehicle.engine&&(U("engines",window.currentVehicle.engine).compatible||(window.currentVehicle.engine=null)),window.currentVehicle.transmission&&(U("transmissions",window.currentVehicle.transmission).compatible||(window.currentVehicle.transmission=null)),document.querySelectorAll(".chassis-card").forEach(a=>{a.classList.remove("ring-2","ring-brand-500","bg-brand-500/10")});const t=document.querySelector(`[onclick="selectChassis('${e}')"]`);t&&t.classList.add("ring-2","ring-brand-500","bg-brand-500/10"),window.vehicleCreatorApp&&window.vehicleCreatorApp.loadTabContent(window.vehicleCreatorApp.currentTab),_()};window.selectEngine=function(e){if(!window.VEHICLE_COMPONENTS?.engines[e]){console.error("Engine not found:",e);return}window.currentVehicle.engine=e,console.log("Selected engine:",e),document.querySelectorAll(".component-card").forEach(a=>{a.onclick&&a.onclick.toString().includes("selectEngine")&&(a.classList.remove("selected","bg-brand-900/30","border-brand-400","shadow-brand-500/20","shadow-lg"),a.classList.add("bg-slate-800/40","border-slate-700/50"))});const t=document.querySelector(`[onclick="selectEngine('${e}')"]`);t&&(t.classList.remove("bg-slate-800/40","border-slate-700/50"),t.classList.add("selected","bg-brand-900/30","border-brand-400","shadow-brand-500/20","shadow-lg")),_()};window.selectTransmission=function(e){if(!window.VEHICLE_COMPONENTS?.transmissions[e]){console.error("Transmission not found:",e);return}window.currentVehicle.transmission=e,console.log("Selected transmission:",e),document.querySelectorAll(".transmission-card").forEach(a=>{a.classList.remove("ring-2","ring-brand-500","bg-brand-500/10")});const t=document.querySelector(`[onclick="selectTransmission('${e}')"]`);t&&t.classList.add("ring-2","ring-brand-500","bg-brand-500/10"),_()};window.selectSuspension=function(e){if(!window.VEHICLE_COMPONENTS?.suspensions[e]){console.error("Suspension not found:",e);return}window.currentVehicle.suspension=e,console.log("Selected suspension:",e),document.querySelectorAll(".suspension-card").forEach(a=>{a.classList.remove("ring-2","ring-brand-500","bg-brand-500/10")});const t=document.querySelector(`[onclick="selectSuspension('${e}')"]`);t&&t.classList.add("ring-2","ring-brand-500","bg-brand-500/10"),_()};function Y(){if(!window.currentVehicle?.chassis||!window.currentVehicle?.engine){window.vehicleCreatorApp?.performanceChart&&(window.vehicleCreatorApp.performanceChart.data.datasets[0].data=[0,0,0,0,0,0],window.vehicleCreatorApp.performanceChart.update());return}const e=G(),t=window.CostSystem?window.CostSystem.calculateCosts(window.currentVehicle):W(),a={speed:Math.min(100,e.topSpeed.road/80*100),armor:Math.min(100,e.armorProtection/250*100),power:Math.min(100,e.powerToWeight/20*100),reliability:e.reliability,economy:Math.max(0,100-e.fuelConsumption/100*100),maintenance:Math.max(0,100-t.maintenanceCostPerHour/500*100)};window.vehicleCreatorApp?.performanceChart&&(window.vehicleCreatorApp.performanceChart.data.datasets[0].data=[a.speed,a.armor,a.power,a.reliability,a.economy,a.maintenance],window.vehicleCreatorApp.performanceChart.update()),$(),I(),M()}function $(){if(!window.EnergySystem||!window.currentVehicle)return;const e=document.getElementById("energy-analysis");if(e){const t=window.EnergySystem.renderEnergyDisplay(window.currentVehicle);e.innerHTML=t}}function I(){if(!window.PerformanceSystem||!window.currentVehicle)return;const e=document.getElementById("performance-analysis");if(e){const t=window.PerformanceSystem.renderPerformanceDisplay(window.currentVehicle);e.innerHTML=t}}function M(){if(!window.CostSystem||!o)return;const e=document.getElementById("cost-breakdown");if(e){const t=window.CostSystem.renderCostDisplay(o);e.innerHTML=t}}document.addEventListener("DOMContentLoaded",function(){setTimeout(()=>{$(),I(),M()},1e3)});window.updateMainGunCaliber=function(e){const t=parseInt(e);if(window.currentVehicle){const a=window.currentVehicle?.chassis?window.VEHICLE_COMPONENTS?.chassis?.[window.currentVehicle.chassis]:null,n=a?.min_main_gun_caliber??20,i=a?.max_main_gun_caliber??180,r=Math.max(n,Math.min(i,t));window.currentVehicle.main_gun_caliber=r;const s=document.getElementById("main-gun-caliber-display"),c=document.getElementById("main-gun-header-caliber"),m=document.getElementById("summary-main-gun-caliber"),l=document.getElementById("main-gun-caliber-slider");l&&(l.min=String(n),l.max=String(i),l.value=String(r)),s&&(s.textContent=r+"mm"),c&&(c.textContent=r+" mm"),m&&(m.textContent=r+"mm"),B(),L(),console.log("Main gun caliber updated:",r),typeof _=="function"?_():typeof Y=="function"&&Y()}};window.updateMainGunLength=function(e){const t=parseInt(e);window.currentVehicle&&t>=30&&t<=70&&(window.currentVehicle.main_gun_length_ratio=t,console.log("Main gun length updated:",t),ue(t),B(),L(),typeof _=="function"&&_())};window.updateMainGunAmmo=function(e){const t=["AP","HE","APCR","HEAT","APDS"];window.currentVehicle&&t.includes(e)&&(window.currentVehicle.ammo_view=e,console.log("Main gun ammo type updated:",e),_e(e),B(),L(),typeof _=="function"&&_())};window.toggleAAGun=function(e){if(!window.currentVehicle)return;window.currentVehicle.aa_guns||(window.currentVehicle.aa_guns=[]);const t=window.currentVehicle.aa_guns.indexOf(e);t>-1?(window.currentVehicle.aa_guns.splice(t,1),console.log("AA gun removed:",e)):(window.currentVehicle.aa_guns.push(e),console.log("AA gun added:",e)),B(),typeof _=="function"&&_(),setTimeout(()=>{window.tabLoaders&&typeof window.tabLoaders.loadWeaponsTab=="function"&&window.tabLoaders.loadWeaponsTab()},100)};function ue(e){document.querySelectorAll('[onclick^="updateMainGunLength("]').forEach(n=>{n.classList.remove("bg-brand-600","text-white"),n.classList.add("bg-slate-700","text-slate-300")});const a=document.querySelector(`[onclick="updateMainGunLength(${e})"]`);a&&(a.classList.remove("bg-slate-700","text-slate-300"),a.classList.add("bg-brand-600","text-white"))}function _e(e){document.querySelectorAll('[onclick^="updateMainGunAmmo("]').forEach(n=>{n.classList.remove("bg-brand-600","text-white"),n.classList.add("bg-slate-700","text-slate-300")});const a=document.querySelector(`[onclick="updateMainGunAmmo('${e}')"]`);a&&(a.classList.remove("bg-slate-700","text-slate-300"),a.classList.add("bg-brand-600","text-white"))}function B(){const e=window.currentVehicle||{},t=e.main_gun_caliber||0,a=e.main_gun_length_ratio||40,n=e.ammo_view||"AP",i=document.getElementById("main-gun-header-caliber");i&&t>0&&(i.textContent=t+" mm");const r=document.getElementById("summary-main-gun-caliber");r&&t>0&&(r.textContent=t+" mm");const s=t*a/25,m=Math.round(s*({AP:1,APCR:1.4,APDS:1.8,HEAT:1.6,HE:.15}[n]||1)),l=document.getElementById("summary-penetration");l&&(l.textContent=m+" mm");const p=document.getElementById("main-gun-penetration");if(p&&(p.textContent=m+" mm",console.log("Updated main gun penetration to:",m+"mm","for ammo type:",n)),ue(a),_e(n),window.tabLoaders&&typeof window.tabLoaders.calculateGunPenetration=="function"){const g=window.tabLoaders.calculateGunPenetration(t,a),y=window.tabLoaders.calculateGunCost(t,a),f=document.getElementById("main-gun-penetration");f&&(f.textContent=g+" mm");const b=document.getElementById("main-gun-cost");b&&(b.textContent="$"+y+"K")}}window.calculateEstimatedPenetration=function(e,t,a){const n=Math.max(1,Number(e)||0),i=Math.max(10,Number(t)||40),r=.85+.15*(i/40),s=(a||"AP").toUpperCase();let c;switch(s){case"AP":c=n*3*r;break;case"APCR":c=n*3.6*r;break;case"APDS":c=n*5*r;break;case"APHE":c=n*2.6*r;break;case"HEAT":c=n*4.2*(.95+.05*(i/40));break;case"HE":c=0;break;default:c=n*3*r}return Math.round(c)};window.updateGunLength=function(e){const t=parseInt(e);window.currentVehicle&&(window.currentVehicle.main_gun_length_ratio=t,j(),typeof _=="function"&&_())};window.setAmmoView=function(e){window.currentVehicle&&(window.currentVehicle.ammo_view=String(e||"AP").toUpperCase(),j())};function j(){const e=window.currentVehicle||{},t=(e.ammo_view||"AP").toUpperCase(),a=window.calculateEstimatedPenetration(e.main_gun_caliber||0,e.main_gun_length_ratio||40,t),n=document.getElementById("gun-penetration-estimate");n&&(n.textContent=`${a} mm`);try{document.querySelectorAll("[data-ammo-chip]").forEach(i=>{i.getAttribute("data-ammo-chip")===t?(i.classList.add("selected","bg-brand-900/30","border-brand-400"),i.classList.remove("bg-slate-700/30","border-slate-700/50")):(i.classList.remove("selected","bg-brand-900/30","border-brand-400"),i.classList.add("bg-slate-700/30","border-slate-700/50"))}),document.querySelectorAll("[data-length-chip]").forEach(i=>{parseInt(i.getAttribute("data-length-chip"))===(e.main_gun_length_ratio||40)?(i.classList.add("selected","bg-brand-900/30","border-brand-400"),i.classList.remove("bg-slate-700/30","border-slate-700/50")):(i.classList.remove("selected","bg-brand-900/30","border-brand-400"),i.classList.add("bg-slate-700/30","border-slate-700/50"))})}catch{}}window.updateGunPreview=j;window.selectSecondaryWeapon=function(e){};window.toggleSecondaryWeapon=function(e){if(!window.currentVehicle)return;Array.isArray(window.currentVehicle.secondary_weapons)||(window.currentVehicle.secondary_weapons=[]);const t=window.currentVehicle.secondary_weapons.indexOf(e);t>=0?window.currentVehicle.secondary_weapons.splice(t,1):window.currentVehicle.secondary_weapons.push(e);try{const a=document.querySelector(`[onclick="toggleSecondaryWeapon('${e}')"]`);a&&(window.currentVehicle.secondary_weapons.includes(e)?(a.classList.add("selected","bg-brand-900/30","border-brand-400"),a.classList.remove("bg-slate-800/40","border-slate-700/50")):(a.classList.remove("selected","bg-brand-900/30","border-brand-400"),a.classList.add("bg-slate-800/40","border-slate-700/50")))}catch{}_(),L()};window.selectFireControl=function(e){if(window.currentVehicle){window.currentVehicle.fcs=e;try{document.querySelectorAll(".component-card").forEach(a=>{a.onclick&&a.onclick.toString().includes("selectFireControl")&&(a.classList.remove("selected","bg-brand-900/30","border-brand-400"),a.classList.add("bg-slate-800/40","border-slate-700/50"))});const t=document.querySelector(`[onclick="selectFireControl('${e}')"]`);t&&(t.classList.add("selected","bg-brand-900/30","border-brand-400"),t.classList.remove("bg-slate-800/40","border-slate-700/50"))}catch{}_()}};window.selectOptics=function(e){if(window.currentVehicle){window.currentVehicle.optics=e;try{document.querySelectorAll(".component-card").forEach(a=>{a.onclick&&a.onclick.toString().includes("selectOptics")&&(a.classList.remove("selected","bg-brand-900/30","border-brand-400"),a.classList.add("bg-slate-800/40","border-slate-700/50"))});const t=document.querySelector(`[onclick="selectOptics('${e}')"]`);t&&(t.classList.add("selected","bg-brand-900/30","border-brand-400"),t.classList.remove("bg-slate-800/40","border-slate-700/50"))}catch{}_()}};window.selectCommunication=function(e){if(window.currentVehicle){window.currentVehicle.communication=e;try{document.querySelectorAll(".component-card").forEach(a=>{a.onclick&&a.onclick.toString().includes("selectCommunication")&&(a.classList.remove("selected","bg-brand-900/30","border-brand-400"),a.classList.add("bg-slate-800/40","border-slate-700/50"))});const t=document.querySelector(`[onclick="selectCommunication('${e}')"]`);t&&(t.classList.add("selected","bg-brand-900/30","border-brand-400"),t.classList.remove("bg-slate-800/40","border-slate-700/50"))}catch{}_()}};window.updateCrewSize=function(e){if(!window.currentVehicle)return;const t=parseInt(e);if(Number.isFinite(t)){window.currentVehicle.crewSize=t;try{const a=document.getElementById("crew-size-display");a&&(a.textContent=String(t)),Ve(t)}catch{}_()}};function Ve(e){const t={2:["Motorista","Gunner"],3:["Motorista","Gunner","Comandante"],4:["Motorista","Gunner","Comandante","Carregador"],5:["Motorista","Gunner","Comandante","Carregador","Operador de Rádio"]},n=(t[e]||t[3]).map((r,s)=>`
        <div class="flex items-center gap-2 px-3 py-2 rounded-lg bg-slate-800/60 border border-slate-700/50">
            <span class="w-6 h-6 flex items-center justify-center text-xs font-bold bg-brand-900/50 text-brand-300 rounded-full">${s+1}</span>
            <span class="text-slate-200 text-sm">${r}</span>
        </div>
    `).join("");let i=document.getElementById("crew-roles-container");if(!i){const r=document.getElementById("crew-size-slider"),s=r?r.closest(".rounded-xl.p-6")||r.closest(".p-6"):null,c=document.createElement("div");c.className="bg-slate-800/40 border border-slate-700/50 rounded-xl p-6",c.innerHTML=`
            <h3 class="text-lg font-semibold text-slate-100 mb-4">Funções da Tripulação</h3>
            <div id="crew-roles-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3">${n}</div>
        `,s&&s.parentElement?s.parentElement.insertBefore(c,s.nextSibling):document.getElementById("tab-content")?.appendChild(c),i=c.querySelector("#crew-roles-container")}i&&(i.innerHTML=n)}window.updateCrewTraining=function(e){window.currentVehicle&&(window.currentVehicle.trainingLevel=e,_())};window.selectTrainingLevel=function(e){if(window.currentVehicle){window.currentVehicle.trainingLevel=e;try{document.querySelectorAll('[onclick^="selectTrainingLevel("]').forEach(a=>{a.classList.remove("selected","bg-brand-900/30","border-brand-400"),a.classList.add("bg-slate-700/30","border-slate-700/50")});const t=document.querySelector(`[onclick="selectTrainingLevel('${e}')"]`);t&&(t.classList.add("selected","bg-brand-900/30","border-brand-400"),t.classList.remove("bg-slate-700/30","border-slate-700/50"))}catch{}_()}};window.selectAAGun=function(e){if(window.currentVehicle){window.currentVehicle.aa_gun=e;try{document.querySelectorAll('[onclick^="selectAAGun("]').forEach(a=>{a.classList.remove("selected","bg-brand-900/30","border-brand-400"),a.classList.add("bg-slate-800/40","border-slate-700/50")});const t=document.querySelector(`[onclick="selectAAGun('${e}')"]`);t&&(t.classList.add("selected","bg-brand-900/30","border-brand-400"),t.classList.remove("bg-slate-800/40","border-slate-700/50"))}catch{}_(),L()}};window.toggleSpecialEquipment=function(e){if(!window.currentVehicle)return;Array.isArray(window.currentVehicle.special_equipment)||(window.currentVehicle.special_equipment=[]);const t=window.currentVehicle.special_equipment.indexOf(e);t>=0?window.currentVehicle.special_equipment.splice(t,1):window.currentVehicle.special_equipment.push(e);try{const a=document.querySelector(`[onclick="toggleSpecialEquipment('${e}')"]`);a&&(window.currentVehicle.special_equipment.includes(e)?(a.classList.add("selected","bg-brand-900/30","border-brand-400"),a.classList.remove("bg-slate-800/40","border-slate-700/50")):(a.classList.remove("selected","bg-brand-900/30","border-brand-400"),a.classList.add("bg-slate-800/40","border-slate-700/50")))}catch{}_()};window.showVehicleSummaryModal=function(){const e=document.getElementById("vehicle-summary-modal");e&&(Re(),e.classList.remove("hidden"),document.body.style.overflow="hidden")};window.hideVehicleSummaryModal=function(){const e=document.getElementById("vehicle-summary-modal");e&&(e.classList.add("hidden"),document.body.style.overflow="")};function $e(){if(!o.chassis)return'<div class="text-slate-400 text-sm">Nenhum chassi selecionado</div>';const e=E[o.chassis];return e?`
        <div class="space-y-3">
            <h4 class="text-lg font-semibold text-slate-200">Chassi</h4>
            <div class="bg-slate-900/40 border border-slate-700/30 rounded-lg p-3">
                <div class="text-sm font-medium text-slate-300 mb-2">${e.name}</div>
                <div class="grid grid-cols-2 gap-2 text-xs text-slate-400">
                    <div>Classe: ${e.weight_class||"N/A"}</div>
                    <div>Peso Base: ${(e.base_weight/1e3).toFixed(1)}t</div>
                    <div>Velocidade Base: ${e.base_speed||"N/A"} km/h</div>
                    <div>Tripulação: ${e.crew_capacity||"N/A"}</div>
                </div>
            </div>
        </div>
    `:'<div class="text-slate-400 text-sm">Chassi não encontrado</div>'}function Ie(){let e='<h4 class="text-lg font-semibold text-slate-200">Sistema de Propulsão</h4>';if(o.engine){const t=P[o.engine];if(t){const a=u("engines",o.engine);e+=`
                <div class="bg-slate-900/40 border border-slate-700/30 rounded-lg p-3">
                    <div class="text-sm font-medium text-slate-300 mb-2">🔧 ${t.name}</div>
                    <div class="grid grid-cols-2 gap-2 text-xs text-slate-400">
                        <div>Potência: ${a?.power||t.max_power||"N/A"} hp</div>
                        <div>Combustível: ${a?.fuel_type||t.fuel_type||"N/A"}</div>
                        <div>Consumo: ${a?.consumption||t.consumption||"N/A"} L/h</div>
                        <div>Peso: ${a?.weight||t.weight||"N/A"} kg</div>
                    </div>
                </div>
            `}}if(o.transmission){const t=D[o.transmission];t&&(e+=`
                <div class="bg-slate-900/40 border border-slate-700/30 rounded-lg p-3">
                    <div class="text-sm font-medium text-slate-300 mb-2">⚙️ ${t.name}</div>
                    <div class="grid grid-cols-2 gap-2 text-xs text-slate-400">
                        <div>Tipo: ${t.type||"N/A"}</div>
                        <div>Marchas: ${t.gears||"N/A"}</div>
                        <div>Eficiência: ${Math.round((t.efficiency||.85)*100)}%</div>
                        <div>Peso: ${t.weight||"N/A"} kg</div>
                    </div>
                </div>
            `)}if(o.suspension){const t=X[o.suspension];t&&(e+=`
                <div class="bg-slate-900/40 border border-slate-700/30 rounded-lg p-3">
                    <div class="text-sm font-medium text-slate-300 mb-2">🚗 ${t.name}</div>
                    <div class="grid grid-cols-2 gap-2 text-xs text-slate-400">
                        <div>Tipo: ${t.type||"N/A"}</div>
                        <div>Curso: ${t.travel||"N/A"} mm</div>
                        <div>Conforto: ${t.comfort_rating||"N/A"}/5</div>
                        <div>Peso: ${t.weight||"N/A"} kg</div>
                    </div>
                </div>
            `)}return e}function De(){let e="";if(o.main_gun_caliber&&o.main_gun_caliber>0){const t=o.main_gun_caliber,a=o.main_gun_length_ratio||40,n=o.ammo_view||"AP",i=pe();e+=`
            <div class="bg-slate-900/40 border border-slate-700/30 rounded-lg p-3">
                <div class="text-sm font-medium text-slate-300 mb-2">🎯 Canhão Principal</div>
                <div class="space-y-1 text-xs text-slate-400">
                    <div>Calibre: ${t}mm</div>
                    <div>Comprimento: L/${a}</div>
                    <div>Munição: ${n}</div>
                    <div>Penetração: ${i}mm</div>
                </div>
            </div>
        `}if(o.secondary_weapons&&o.secondary_weapons.length>0&&o.secondary_weapons.forEach(t=>{const a=te[t];a&&(e+=`
                    <div class="bg-slate-900/40 border border-slate-700/30 rounded-lg p-3">
                        <div class="text-sm font-medium text-slate-300 mb-2">🔫 ${a.name}</div>
                        <div class="space-y-1 text-xs text-slate-400">
                            <div>Calibre: ${a.caliber||"N/A"}mm</div>
                            <div>ROF: ${a.rate_of_fire||"N/A"} rpm</div>
                            <div>Munição: ${a.ammo_capacity||"N/A"}</div>
                        </div>
                    </div>
                `)}),o.aa_gun){const t=ae[o.aa_gun];t&&(e+=`
                <div class="bg-slate-900/40 border border-slate-700/30 rounded-lg p-3">
                    <div class="text-sm font-medium text-slate-300 mb-2">🎯 ${t.name}</div>
                    <div class="space-y-1 text-xs text-slate-400">
                        <div>Calibre: ${t.caliber}mm</div>
                        <div>ROF: ${t.rate_of_fire} rpm</div>
                        <div>Alcance: ${t.effective_range}m</div>
                    </div>
                </div>
            `)}return e||(e='<div class="text-slate-400 text-sm col-span-3">Nenhum armamento selecionado</div>'),e}function Be(){let e='<div class="space-y-3">';e+='<h4 class="text-lg font-semibold text-slate-200">Blindagem Principal</h4>';const t=o.armorThickness||o.armor_thickness||0,a=o.armorMaterial||o.armor_material,n=o.armorAngle;if(t>0){let r="Aço Padrão";a&&R[a]&&(r=R[a].name);let s="Vertical (90°)";n&&k[n]&&(s=k[n].name),e+=`
            <div class="bg-slate-900/40 border border-slate-700/30 rounded-lg p-3">
                <div class="grid grid-cols-2 gap-2 text-xs text-slate-400">
                    <div>Espessura: ${t}mm</div>
                    <div>Material: ${r}</div>
                    <div>Ângulo: ${s}</div>
                    <div>Proteção Efetiva: ${Oe()}mm</div>
                </div>
            </div>
        `}else e+='<div class="text-slate-400 text-sm">Blindagem não configurada</div>';e+="</div>";const i=o.additional_armor||o.additionalArmor||[];return i.length>0&&(e+='<div class="space-y-3">',e+='<h4 class="text-lg font-semibold text-slate-200">Blindagem Adicional</h4>',i.forEach(r=>{const s=ee[r];s&&(e+=`
                    <div class="bg-slate-900/40 border border-slate-700/30 rounded-lg p-3">
                        <div class="text-sm font-medium text-slate-300 mb-2">${s.name}</div>
                        <div class="grid grid-cols-2 gap-2 text-xs text-slate-400">
                            <div>Proteção: +${s.protection_bonus||0}mm</div>
                            <div>Peso: +${s.weight_penalty||0}kg</div>
                        </div>
                    </div>
                `)}),e+="</div>"),e}function Ne(){let e="";if(o.fcs){const t=re[o.fcs];t&&(e+=`
                <div class="bg-slate-900/40 border border-slate-700/30 rounded-lg p-3">
                    <div class="text-sm font-medium text-slate-300 mb-2">🎯 Controle de Tiro</div>
                    <div class="text-xs text-slate-200 mb-1">${t.name}</div>
                    <div class="space-y-1 text-xs text-slate-400">
                        <div>Tipo: ${t.type||"N/A"}</div>
                        <div>Precisão: +${t.accuracy_bonus||0}%</div>
                        <div>Consumo: ${t.power_consumption||0}kW</div>
                    </div>
                </div>
            `)}if(o.optics){const t=ie[o.optics];t&&(e+=`
                <div class="bg-slate-900/40 border border-slate-700/30 rounded-lg p-3">
                    <div class="text-sm font-medium text-slate-300 mb-2">👁️ Sistema Ótico</div>
                    <div class="text-xs text-slate-200 mb-1">${t.name}</div>
                    <div class="space-y-1 text-xs text-slate-400">
                        <div>Zoom: ${t.magnification||"N/A"}x</div>
                        <div>Visão Noturna: ${t.night_vision?"Sim":"Não"}</div>
                        <div>Termal: ${t.thermal?"Sim":"Não"}</div>
                    </div>
                </div>
            `)}if(o.communication){const t=ne[o.communication];t&&(e+=`
                <div class="bg-slate-900/40 border border-slate-700/30 rounded-lg p-3">
                    <div class="text-sm font-medium text-slate-300 mb-2">📡 Comunicação</div>
                    <div class="text-xs text-slate-200 mb-1">${t.name}</div>
                    <div class="space-y-1 text-xs text-slate-400">
                        <div>Alcance: ${t.range||"N/A"}km</div>
                        <div>Canais: ${t.channels||"N/A"}</div>
                        <div>Criptografia: ${t.encrypted?"Sim":"Não"}</div>
                    </div>
                </div>
            `)}return e||(e='<div class="text-slate-400 text-sm col-span-3">Nenhum sistema eletrônico selecionado</div>'),e}function ze(){const e=o.crewSize||3,t=o.trainingLevel||"standard",a={rookie:"Recruta",standard:"Padrão",veteran:"Veterano",elite:"Elite"},n={2:["Motorista","Artilheiro"],3:["Motorista","Artilheiro","Comandante"],4:["Motorista","Artilheiro","Comandante","Carregador"],5:["Motorista","Artilheiro","Comandante","Carregador","Operador de Rádio"]};let i=`
        <div class="space-y-3">
            <h4 class="text-lg font-semibold text-slate-200">Composição</h4>
            <div class="bg-slate-900/40 border border-slate-700/30 rounded-lg p-3">
                <div class="grid grid-cols-2 gap-2 text-xs text-slate-400 mb-3">
                    <div>Tamanho: ${e} membros</div>
                    <div>Treinamento: ${a[t]}</div>
                </div>
                <div class="space-y-1">
                    ${(n[e]||n[3]).map((c,m)=>`<div class="flex items-center gap-2 text-xs text-slate-300">
                            <span class="w-5 h-5 bg-brand-900/50 text-brand-300 rounded-full flex items-center justify-center text-xs font-bold">${m+1}</span>
                            ${c}
                        </div>`).join("")}
                </div>
            </div>
        </div>
    `;const s={rookie:{accuracy:-10,reload:-15,mobility:-5},standard:{accuracy:0,reload:0,mobility:0},veteran:{accuracy:10,reload:15,mobility:5},elite:{accuracy:20,reload:25,mobility:10}}[t];return i+=`
        <div class="space-y-3">
            <h4 class="text-lg font-semibold text-slate-200">Impacto no Desempenho</h4>
            <div class="bg-slate-900/40 border border-slate-700/30 rounded-lg p-3">
                <div class="space-y-1 text-xs">
                    <div class="flex justify-between">
                        <span class="text-slate-400">Precisão:</span>
                        <span class="${s.accuracy>=0?"text-green-400":"text-red-400"}">
                            ${s.accuracy>0?"+":""}${s.accuracy}%
                        </span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-slate-400">Recarga:</span>
                        <span class="${s.reload>=0?"text-green-400":"text-red-400"}">
                            ${s.reload>0?"+":""}${s.reload}%
                        </span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-slate-400">Mobilidade:</span>
                        <span class="${s.mobility>=0?"text-green-400":"text-red-400"}">
                            ${s.mobility>0?"+":""}${s.mobility}%
                        </span>
                    </div>
                </div>
            </div>
        </div>
    `,i}function He(){const e=o.special_equipment||o.specialEquipment||[];if(!e||e.length===0)return"";let t=`
        <div class="bg-slate-800/40 border border-slate-700 rounded-xl p-6">
            <h3 class="text-xl font-bold text-white mb-4 flex items-center gap-3">
                <span class="text-2xl">🛠️</span>
                Equipamentos Especiais
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
    `;return e.forEach(a=>{const n=oe[a];n&&(t+=`
                <div class="bg-slate-900/40 border border-slate-700/30 rounded-lg p-3">
                    <div class="text-sm font-medium text-slate-300 mb-2">${n.name}</div>
                    <div class="text-xs text-slate-400 mb-2">${n.description||""}</div>
                    <div class="space-y-1 text-xs text-slate-400">
                        <div>Peso: ${n.weight||0}kg</div>
                        <div>Consumo: ${n.energy_consumption||0}kW</div>
                        <div>Custo: $${(n.cost||0).toLocaleString()}</div>
                    </div>
                </div>
            `)}),t+="</div></div>",t}function Oe(){const e=o.armorThickness||o.armor_thickness||0,t=o.armorAngle;let a=e;return t&&k[t]&&(a*=k[t].effectiveness_multiplier||1),Math.round(a)}function Re(){const e=document.getElementById("vehicle-summary-content");if(!e)return;const a=1954+(window.gameState?.currentTurn||0),n=o.name||`Veículo Experimental ${Math.floor(Math.random()*1e3)}`,i=Ge(),r=We(),s=Qe();e.innerHTML=`
        <div class="space-y-8">
            <!-- Header Info -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-400 mb-2">Nome do Veículo</label>
                        <input 
                            type="text" 
                            id="vehicle-name-input"
                            value="${n}"
                            class="w-full px-4 py-3 bg-slate-800/60 border border-slate-700 rounded-lg text-white focus:ring-2 focus:ring-brand-500 focus:border-transparent"
                            placeholder="Nome do seu veículo"
                        >
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-slate-400 mb-2">Ano de Desenvolvimento</label>
                            <div class="px-4 py-3 bg-slate-800/40 border border-slate-700 rounded-lg text-brand-300 font-semibold">
                                ${a}
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-slate-400 mb-2">Tipo</label>
                            <div class="px-4 py-3 bg-slate-800/40 border border-slate-700 rounded-lg text-brand-300 font-semibold">
                                ${Ue()}
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Vehicle Image Upload -->
                <div class="relative">
                    <div id="vehicle-image-container" class="flex items-center justify-center bg-slate-800/40 border-2 border-dashed border-slate-600 rounded-xl p-8 transition-all duration-200 hover:border-brand-500 hover:bg-slate-800/60 cursor-pointer min-h-[200px]" onclick="triggerImageUpload()">
                        <div class="text-center">
                            <div id="vehicle-image-preview" class="hidden">
                                <img id="uploaded-vehicle-image" class="max-w-full max-h-48 rounded-lg object-contain mx-auto mb-4" alt="Imagem do Veículo">
                            </div>
                            <div id="vehicle-image-placeholder">
                                <div class="text-6xl mb-4">${Fe()}</div>
                                <p class="text-slate-400 mb-2">Clique para adicionar imagem do veículo</p>
                                <p class="text-xs text-slate-500">PNG, JPG ou GIF até 5MB</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Hidden file input -->
                    <input 
                        type="file" 
                        id="vehicle-image-input" 
                        class="hidden" 
                        accept="image/*" 
                        onchange="handleImageUpload(event)"
                    >
                    
                    <!-- Remove image button (shown when image is uploaded) -->
                    <button 
                        id="remove-image-btn" 
                        onclick="removeVehicleImage()" 
                        class="hidden absolute top-2 right-2 w-8 h-8 bg-red-600 hover:bg-red-700 text-white rounded-full flex items-center justify-center transition-colors"
                        title="Remover imagem"
                    >
                        <span class="text-sm">×</span>
                    </button>
                </div>
            </div>
            
            <!-- Technical Specifications -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Performance Stats -->
                <div class="bg-slate-800/40 border border-slate-700 rounded-xl p-6">
                    <h3 class="text-xl font-bold text-white mb-4 flex items-center gap-3">
                        <span class="text-2xl">⚡</span>
                        Desempenho
                    </h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center py-2 border-b border-slate-700/50">
                            <span class="text-slate-300">Velocidade Máxima</span>
                            <span class="font-semibold text-brand-300">${i.maxSpeed||0} km/h</span>
                        </div>
                        <div class="flex justify-between items-center py-2 border-b border-slate-700/50">
                            <span class="text-slate-300">Aceleração</span>
                            <span class="font-semibold text-brand-300">${i.acceleration||0} km/h/s</span>
                        </div>
                        <div class="flex justify-between items-center py-2 border-b border-slate-700/50">
                            <span class="text-slate-300">Peso Total</span>
                            <span class="font-semibold text-brand-300">${i.totalWeight||0} tons</span>
                        </div>
                        <div class="flex justify-between items-center py-2">
                            <span class="text-slate-300">Potência Específica</span>
                            <span class="font-semibold text-brand-300">${i.powerToWeight||0} hp/ton</span>
                        </div>
                    </div>
                </div>
                
                <!-- Combat Stats -->
                <div class="bg-slate-800/40 border border-slate-700 rounded-xl p-6">
                    <h3 class="text-xl font-bold text-white mb-4 flex items-center gap-3">
                        <span class="text-2xl">💥</span>
                        Capacidade de Combate
                    </h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center py-2 border-b border-slate-700/50">
                            <span class="text-slate-300">Armamento Principal</span>
                            <span class="font-semibold text-brand-300">${o.main_gun_caliber||0}mm</span>
                        </div>
                        <div class="flex justify-between items-center py-2 border-b border-slate-700/50">
                            <span class="text-slate-300">Penetração</span>
                            <span class="font-semibold text-brand-300">${pe()}mm</span>
                        </div>
                        <div class="flex justify-between items-center py-2 border-b border-slate-700/50">
                            <span class="text-slate-300">Blindagem Frontal</span>
                            <span class="font-semibold text-brand-300">${o.armorThickness||0}mm</span>
                        </div>
                        <div class="flex justify-between items-center py-2">
                            <span class="text-slate-300">Tripulação</span>
                            <span class="font-semibold text-brand-300">${o.crewSize||3} membros</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Detailed Components Sections -->
            
            <!-- Chassis & Drivetrain -->
            <div class="bg-slate-800/40 border border-slate-700 rounded-xl p-6">
                <h3 class="text-xl font-bold text-white mb-4 flex items-center gap-3">
                    <span class="text-2xl">🏗️</span>
                    Chassi e Sistema de Propulsão
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-3">
                        ${$e()}
                    </div>
                    <div class="space-y-3">
                        ${Ie()}
                    </div>
                </div>
            </div>
            
            <!-- Armaments -->
            <div class="bg-slate-800/40 border border-slate-700 rounded-xl p-6">
                <h3 class="text-xl font-bold text-white mb-4 flex items-center gap-3">
                    <span class="text-2xl">🔫</span>
                    Sistema de Armamento
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    ${De()}
                </div>
            </div>
            
            <!-- Armor System -->
            <div class="bg-slate-800/40 border border-slate-700 rounded-xl p-6">
                <h3 class="text-xl font-bold text-white mb-4 flex items-center gap-3">
                    <span class="text-2xl">🛡️</span>
                    Sistema de Blindagem
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    ${Be()}
                </div>
            </div>
            
            <!-- Electronics & Systems -->
            <div class="bg-slate-800/40 border border-slate-700 rounded-xl p-6">
                <h3 class="text-xl font-bold text-white mb-4 flex items-center gap-3">
                    <span class="text-2xl">📡</span>
                    Sistemas Eletrônicos
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    ${Ne()}
                </div>
            </div>
            
            <!-- Crew -->
            <div class="bg-slate-800/40 border border-slate-700 rounded-xl p-6">
                <h3 class="text-xl font-bold text-white mb-4 flex items-center gap-3">
                    <span class="text-2xl">👥</span>
                    Tripulação
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    ${ze()}
                </div>
            </div>
            
            <!-- Special Equipment -->
            ${He()}
            
            <!-- Cost & Energy -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-slate-800/40 border border-slate-700 rounded-xl p-6">
                    <h3 class="text-xl font-bold text-white mb-4 flex items-center gap-3">
                        <span class="text-2xl">💰</span>
                        Custos
                    </h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center py-2 border-b border-slate-700/50">
                            <span class="text-slate-300">Custo por Unidade</span>
                            <span class="font-semibold text-green-400">$${((r.perUnit||0)/1e3).toFixed(0)}K</span>
                        </div>
                        <div class="flex justify-between items-center py-2">
                            <span class="text-slate-300">Manutenção por Unidade/Ano</span>
                            <span class="font-semibold text-yellow-400">$${je().toFixed(0)}K</span>
                        </div>
                    </div>
                </div>
                
                <div class="bg-slate-800/40 border border-slate-700 rounded-xl p-6">
                    <h3 class="text-xl font-bold text-white mb-4 flex items-center gap-3">
                        <span class="text-2xl">⚡</span>
                        Energia
                    </h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center py-2 border-b border-slate-700/50">
                            <span class="text-slate-300">Consumo Total</span>
                            <span class="font-semibold text-blue-400">${s.total||0} kW</span>
                        </div>
                        <div class="flex justify-between items-center py-2">
                            <span class="text-slate-300">Eficiência</span>
                            <span class="font-semibold text-blue-400">${s.efficiency||0}%</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `,setTimeout(()=>{setupImageDragDrop(),o.vehicleImage&&Q(o.vehicleImage),et()},100)}function Ue(){if(!o.chassis)return"Não Selecionado";const e=E[o.chassis];return e?e.name:"Chassi Personalizado"}function Fe(){if(!o.chassis)return"🚗";const e=E[o.chassis];if(!e)return"🚗";switch(e.weight_class){case"light":return"🚙";case"medium":return"🚚";case"heavy":return"🚛";case"super_heavy":return"🏗️";default:return"🚗"}}function pe(){const e=o.main_gun_caliber||75,t=o.main_gun_length_ratio||40,a=o.ammo_view||"AP",n=e*t/25;return Math.round(n*({AP:1,APCR:1.4,APDS:1.8,HEAT:1.6,HE:.15}[a]||1))}window.exportVehicleToPDF=function(){const e=document.getElementById("vehicle-name-input")?.value||"Veiculo",t=document.createElement("div");t.innerHTML=document.getElementById("vehicle-summary-content").innerHTML;let a="";o.vehicleImage&&(a=`
            <div style="text-align: center; margin: 20px 0;">
                <img src="${o.vehicleImage}" 
                     style="max-width: 300px; max-height: 300px; border-radius: 8px; border: 1px solid #dee2e6;" 
                     alt="Imagem do Veículo">
            </div>
        `);const n=window.open("","_blank");n.document.write(`
        <!DOCTYPE html>
        <html>
        <head>
            <title>Ficha do Veículo - ${e}</title>
            <style>
                body { font-family: Arial, sans-serif; margin: 20px; color: #333; line-height: 1.4; }
                .space-y-8 > * { margin-bottom: 2rem; }
                .grid { display: grid; gap: 1rem; }
                .grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
                .grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
                .bg-slate-800 { background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 1rem; border-radius: 8px; }
                .text-xl { font-size: 1.25rem; font-weight: bold; margin-bottom: 1rem; }
                .font-semibold { font-weight: 600; }
                .text-brand-300 { color: #3b82f6; }
                .text-yellow-400 { color: #f59e0b; }
                .text-blue-400 { color: #60a5fa; }
                .text-green-400 { color: #10b981; }
                input { border: 1px solid #ccc; padding: 8px; border-radius: 4px; }
                h1 { color: #1f2937; border-bottom: 2px solid #e5e7eb; padding-bottom: 10px; }
                .hidden { display: none !important; }
                @media print {
                    body { margin: 0; }
                    .no-print { display: none !important; }
                }
            </style>
        </head>
        <body>
            <h1>📋 Ficha Completa do Veículo - ${e}</h1>
            ${a}
            ${t.innerHTML}
            <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #dee2e6; text-align: center; color: #6b7280; font-size: 12px;">
                Gerado automaticamente pelo Sistema de Criação de Veículos War1954
            </div>
        </body>
        </html>
    `),n.document.close(),n.focus(),n.print(),n.close()};function L(){if(!o)return;const e=Array.isArray(o.secondary_weapons)?o.secondary_weapons.length:0,t=document.getElementById("summary-secondary-dps");t&&(t.textContent=e+".0");const a=o.aa_gun?1:0,n=document.getElementById("summary-aa-dps");n&&(n.textContent=a+".0")}function Ge(){if(!o)return{maxSpeed:0,acceleration:0,totalWeight:0,powerToWeight:0};const e=o.chassis?E[o.chassis]:null,t=o.engine?P[o.engine]:null,a=o.transmission?D[o.transmission]:null,n=(e?.base_weight||2e4)/1e3,i=(o.armorThickness||80)*.05,r=(t?.weight||2e3)/1e3,s=Math.round((n+i+r)*10)/10,c=t?.max_power||300,m=Math.round(c/s*10)/10,l=a?.efficiency||.85,p=Math.round(Math.min(e?.base_speed||50,m*2.5*l)),g=Math.round(m*l*.08*100)/100;return{maxSpeed:p,acceleration:g,totalWeight:s,powerToWeight:m}}function We(){if(!o)return{total:0,perUnit:0};if(window.CostSystem&&typeof window.CostSystem.calculateCosts=="function"){const e=window.CostSystem.calculateCosts(o);return{total:Math.round(e.production),perUnit:Math.round(e.production)}}return console.warn("CostSystem não disponível, usando cálculo simplificado"),{total:0,perUnit:0}}function je(){return o&&window.CostSystem&&typeof window.CostSystem.calculateCosts=="function"?(window.CostSystem.calculateCosts(o).maintenance||0)/1e3:0}function Qe(){if(!o)return{total:0,efficiency:0};const t=(o.engine?P[o.engine]:null)?.max_power||300,a=Math.round(t*.8),n=(o.optics_system?15:0)+(o.communication_system?10:0)+(o.fcs?20:0)+(o.special_equipment?.length||0)*5,i=a+n,s=((o.transmission?D[o.transmission]:null)?.efficiency||.85)*100,c=Math.round(s*.9);return{total:i,efficiency:c}}window.triggerImageUpload=function(){document.getElementById("vehicle-image-input").click()};window.handleImageUpload=function(e){const t=e.target.files[0];if(!t||!ge(t))return;const a=new FileReader;a.onload=function(n){const i=n.target.result;o.vehicleImage=i,Q(i),console.log("Imagem do veículo carregada com sucesso")},a.readAsDataURL(t)};function ge(e){return["image/jpeg","image/png","image/gif","image/webp"].includes(e.type)?e.size>5242880?(Z("Imagem muito grande. Máximo 5MB."),!1):!0:(Z("Formato não suportado. Use PNG, JPG, GIF ou WebP."),!1)}function Q(e){const t=document.getElementById("vehicle-image-placeholder"),a=document.getElementById("vehicle-image-preview"),n=document.getElementById("uploaded-vehicle-image"),i=document.getElementById("remove-image-btn"),r=document.getElementById("vehicle-image-container");t&&a&&n&&i&&r&&(t.classList.add("hidden"),a.classList.remove("hidden"),i.classList.remove("hidden"),n.src=e,r.classList.remove("border-dashed","cursor-pointer"),r.classList.add("border-solid"),r.onclick=null)}window.removeVehicleImage=function(){const e=document.getElementById("vehicle-image-placeholder"),t=document.getElementById("vehicle-image-preview"),a=document.getElementById("uploaded-vehicle-image"),n=document.getElementById("remove-image-btn"),i=document.getElementById("vehicle-image-container"),r=document.getElementById("vehicle-image-input");e&&t&&a&&n&&i&&r&&(t.classList.add("hidden"),e.classList.remove("hidden"),n.classList.add("hidden"),a.src="",r.value="",delete o.vehicleImage,i.classList.add("border-dashed","cursor-pointer"),i.classList.remove("border-solid"),i.onclick=triggerImageUpload,console.log("Imagem do veículo removida"))};function Z(e){const t=document.getElementById("vehicle-image-container");if(t){const a=document.createElement("div");a.className="absolute top-2 left-2 right-2 bg-red-600 text-white text-xs px-3 py-2 rounded-lg z-10",a.textContent=e,t.appendChild(a),setTimeout(()=>{t.contains(a)&&t.removeChild(a)},3e3)}}window.setupImageDragDrop=function(){const e=document.getElementById("vehicle-image-container");e&&(e.addEventListener("dragover",function(t){t.preventDefault(),e.classList.add("border-brand-500","bg-slate-800/80")}),e.addEventListener("dragleave",function(t){t.preventDefault(),e.classList.remove("border-brand-500","bg-slate-800/80")}),e.addEventListener("drop",function(t){t.preventDefault(),e.classList.remove("border-brand-500","bg-slate-800/80");const a=t.dataTransfer.files;if(a.length>0){const n=a[0];if(ge(n)){const i=new FileReader;i.onload=function(r){const s=r.target.result;o.vehicleImage=s,Q(s),console.log("Imagem arrastada e carregada com sucesso")},i.readAsDataURL(n)}}}))};window.submitForApproval=async function(){const e=document.getElementById("vehicle-name-input")?.value,t=parseInt(document.getElementById("vehicle-quantity-input")?.value)||50,a=document.getElementById("submit-approval-btn");if(document.getElementById("submission-status"),!e||e.trim().length<3){A("❌ Nome do veículo deve ter pelo menos 3 caracteres","error");return}if(t<1||t>1e3){A("❌ Quantidade deve estar entre 1 e 1000 unidades","error");return}if(!o.chassis||!o.engine){A("❌ Chassi e Motor são obrigatórios","error");return}o.name=e.trim(),a&&(a.disabled=!0,a.innerHTML='<span class="flex items-center gap-2"><span class="animate-spin">⏳</span><span>Enviando...</span></span>');try{const n=Je(o),i=window.firebase?.auth()?.currentUser;if(!i)throw new Error("Usuário não está logado");let r;try{r=await Ze(i.uid),console.log("🏁 País detectado:",r)}catch(l){throw console.error("Erro ao detectar país:",l),new Error("Erro ao detectar país do usuário: "+l.message)}if(!r)throw new Error("Usuário não está vinculado a um país. Contate o administrador.");if(r.id==="admin-manual"){const l=document.getElementById("vehicle-target-country")?.value;if(l&&l!==""){console.log("🎯 Admin selecionou país:",l);try{const g=await window.firebase.firestore().collection("paises").doc(l).get();if(g.exists){const y=g.data();r={id:l,name:y.Pais||"País Selecionado"},console.log("✅ País resolvido:",r)}else r={id:l,name:l},console.log("⚠️ País não encontrado, usando ID:",r)}catch(p){console.log("💥 Erro ao buscar dados do país selecionado:",p),r={id:l,name:l}}}else throw new Error("Admin/Narrador deve selecionar um país de destino.")}const c={vehicleData:F({...o,submissionId:Ye(),version:"1.0"}),playerId:i.uid,playerName:i.displayName||i.email||"Usuário Desconhecido",playerEmail:i.email||"",countryId:r.id,countryName:r.name,quantity:t,category:n,status:"pending",submittedAt:window.firebase.firestore.Timestamp.now(),lastUpdated:window.firebase.firestore.Timestamp.now(),reviewedBy:null,reviewedAt:null,reviewComments:"",approvedQuantity:0};console.log("📸 Gerando captura da ficha técnica...");const m=await tt(c);m&&typeof m=="object"?(c.imageUrl=m.pngUrl,c.vehicleSheetImageUrl=m.htmlUrl||m.pngUrl,c.hasVisualSheet=!!m.pngUrl):(c.vehicleSheetImageUrl=m,c.hasVisualSheet=m&&m.startsWith("http")),console.log("🧹 Dados limpos para envio:",c),console.log("📊 Tamanho dos dados:",JSON.stringify(c).length,"caracteres"),await Xe(c),A(`✅ Veículo "${e}" enviado para aprovação! (${t} unidades)`,"success"),setTimeout(()=>{a&&(a.disabled=!1,a.innerHTML='<span class="flex items-center gap-2"><span>📋</span><span>Enviar para Aprovação</span></span>')},3e3)}catch(n){console.error("💥 Erro ao enviar para aprovação:",n),console.error("🔍 Detalhes do erro:",{code:n.code,message:n.message,details:n.details||n.stack});let i=n.message;n.code==="invalid-argument"?i="Dados do veículo inválidos. Verifique se todos os campos estão preenchidos corretamente.":n.code==="permission-denied"&&(i="Permissão negada. Verifique suas credenciais."),A(`❌ Erro: ${i}`,"error"),a&&(a.disabled=!1,a.innerHTML='<span class="flex items-center gap-2"><span>📋</span><span>Enviar para Aprovação</span></span>')}};function A(e,t){const a=document.getElementById("submission-status");if(!a)return;const n=t==="success"?"bg-green-600/20 border-green-500/50 text-green-300":"bg-red-600/20 border-red-500/50 text-red-300";a.className=`mt-3 rounded-lg p-3 text-sm border ${n}`,a.textContent=e,a.classList.remove("hidden"),setTimeout(()=>{a.classList.add("hidden")},5e3)}function Je(e){const t=Ke(e),a=(e.main_gun_caliber||0)>0,n=e.main_gun_caliber||0;return a&&n>=100&&t>40?"MBT":a&&n>=70&&t>20?"Medium Tank":a&&t<20?"Light Tank":e.secondary_weapons?.length>0?"IFV":"APC"}function Ke(e){const t=E[e.chassis],a=P[e.engine],n=t?.base_weight||2e4,i=a?.weight||1e3,r=(e.armorThickness||50)*100;return(n+i+r)/1e3}function Ye(){return"VEH-"+Date.now()+"-"+Math.random().toString(36).substr(2,5)}function F(e,t=0){if(t>10)return console.warn("⚠️ Máxima profundidade atingida, truncando objeto"),null;if(e==null||typeof e=="function"||typeof e=="symbol")return null;if(typeof e!="object")return typeof e=="number"?isFinite(e)?Math.round(e*1e3)/1e3:0:typeof e=="string"&&e.length>1e4?e.substring(0,1e4)+"...":e;if(e instanceof Date)return e.toISOString();if(e.nodeType||e instanceof Element||e instanceof HTMLElement)return null;try{JSON.stringify(e)}catch(i){return console.warn("⚠️ Objeto com referências circulares detectado, convertendo para string:",i.message),e.toString()}if(Array.isArray(e)){const i=[];for(let r=0;r<e.length&&r<100;r++){const s=F(e[r],t+1);s!=null&&i.push(s)}return i}const a={};let n=0;for(const[i,r]of Object.entries(e)){if(n>=50){console.warn("⚠️ Muitas propriedades, truncando objeto");break}if(i.startsWith("_")||i.startsWith("$")||i.includes("constructor")||i.includes("prototype")||i.includes("__")||typeof i!="string"||i.length>100)continue;const s=F(r,t+1);if(s!=null){if(typeof s=="object"&&!Array.isArray(s)){const c=JSON.stringify(s).length;c>1e3?a[i]={type:"complex_object",summary:Object.keys(s).slice(0,10),size:c}:a[i]=s}else a[i]=s;n++}}return a}async function Ze(e){try{if(console.log("🔍 Buscando país para usuário:",e),!window.firebase||!window.firebase.firestore)throw new Error("Firebase não está disponível");const t=window.firebase.firestore();console.log("📋 Verificando documento do usuário...");const a=await t.collection("usuarios").doc(e).get();if(a.exists){const i=a.data();if(console.log("👤 Dados do usuário:",i),i.papel==="admin"||i.papel==="narrador")return console.log("🔑 Usuário é admin/narrador - permitindo seleção manual"),{id:"admin-manual",name:"Admin/Narrador (Seleção Manual)"};if(i.paisId){console.log("🌍 PaisId encontrado no usuário:",i.paisId);try{const r=await t.collection("paises").doc(i.paisId).get();if(r.exists){const s=r.data();return console.log("✅ Dados do país:",s),{id:i.paisId,name:s.Pais||"País Desconhecido"}}}catch(r){console.log("⚠️ Erro ao buscar dados do país:",r.message)}return{id:i.paisId,name:`País: ${i.paisId}`}}}console.log("🔎 Buscando na coleção países...");const n=await t.collection("paises").where("Player","==",e).limit(1).get();if(!n.empty){const i=n.docs[0],r=i.data();return console.log("🎯 País encontrado via busca:",i.id,r),{id:i.id,name:r.Pais||"País Desconhecido"}}return console.log("❌ Nenhum país encontrado para o usuário"),null}catch(t){throw console.error("💥 Erro ao buscar país do usuário:",t),t}}async function Xe(e){if(!window.firebase||!window.firebase.firestore)throw new Error("Firebase não inicializado");const t=window.firebase.firestore();console.log("📤 Enviando dados para Firebase:",e);const a=await t.collection("vehicles_pending").add(e);return console.log("✅ Veículo enviado para aprovação com ID:",a.id),a.id}async function et(){try{console.log("⚙️ Configurando seleção de país...");const e=window.firebase?.auth()?.currentUser;if(!e){console.log("❌ Usuário não logado");return}const t=document.getElementById("admin-country-selection"),a=document.getElementById("vehicle-target-country");if(!t||!a){console.log("❌ Elementos não encontrados");return}const n=window.firebase.firestore(),i=await n.collection("usuarios").doc(e.uid).get();if(!i.exists){console.log("❌ Documento do usuário não existe");return}const r=i.data();if(console.log("👤 Papel do usuário:",r.papel),r.papel==="admin"||r.papel==="narrador"){console.log("✅ Mostrando seleção de país para admin/narrador"),t.classList.remove("hidden"),console.log("📋 Carregando países...");const c=await n.collection("paises").get();a.innerHTML='<option value="">Selecione um país...</option>',c.docs.forEach(l=>{const p=l.data(),g=document.createElement("option");g.value=l.id,g.textContent=p.Pais||l.id,a.appendChild(g)}),console.log(`📊 ${c.docs.length} países carregados`);const m=document.body.textContent?.match(/pais_\d+_\d+/)?.[0];if(m){const l=Array.from(a.options).find(p=>p.value===m);l&&(l.selected=!0,console.log("🎯 País do cabeçalho pré-selecionado:",m))}else{const l=Array.from(a.options).find(p=>p.textContent.toLowerCase().includes("urss")||p.textContent.toLowerCase().includes("união soviética")||p.textContent.toLowerCase().includes("soviet"));l&&(l.selected=!0,console.log("🎯 URSS pré-selecionada"))}}else console.log("🔒 Ocultando seleção para jogador normal"),t.classList.add("hidden")}catch(e){console.error("💥 Erro ao configurar seleção de país:",e);const t=document.getElementById("vehicle-target-country");t&&(t.innerHTML='<option value="">Erro ao carregar países</option>')}}async function tt(e){try{console.log("🚀 === INICIANDO CAPTURA DE FICHA ==="),console.log("📋 Dados da submissão:",e);const t=document.getElementById("vehicle-summary-content");if(console.log("🎯 Elemento da ficha encontrado:",!!t),!t)throw new Error("Elemento da ficha não encontrado");if(console.log("🖼️ html2canvas disponível:",typeof html2canvas<"u"),typeof html2canvas>"u")return console.log("⚠️ html2canvas não disponível, usando método alternativo"),{pngUrl:null,htmlUrl:await V(e)};if(console.log("🔥 Firebase disponível:",!!window.firebase),console.log("☁️ Storage disponível:",!!window.firebase?.storage),!window.firebase?.storage)return console.error("❌ Firebase Storage não disponível!"),{pngUrl:null,htmlUrl:await V(e)};const a={backgroundColor:"#1e293b",width:1200,height:Math.max(t.scrollHeight,800),useCORS:!0,scale:2,logging:!1};console.log("🖼️ Capturando imagem da ficha...");const n=await html2canvas(t,a);console.log("✅ Canvas capturado:",n.width+"x"+n.height),console.log("💾 Convertendo para arquivo...");const i=await new Promise(c=>{n.toBlob(c,"image/png",.9)});if(console.log("✅ Blob criado:",i?.size,"bytes"),!i)throw new Error("Falha ao criar blob da imagem");console.log("☁️ Fazendo upload para Firebase Storage...");const r=await at(i,e);console.log("✅ Imagem PNG da ficha enviada:",r),console.log("🔗 URL completa:",r);const s=await V(e);return{pngUrl:r,htmlUrl:s}}catch(t){console.error("💥 Erro ao capturar ficha PNG:",t);try{return console.log("🔄 Tentando método alternativo (HTML apenas)..."),{pngUrl:null,htmlUrl:await V(e)}}catch(a){return console.error("💥 Erro no método alternativo:",a),null}}}async function at(e,t){if(console.log("🔥 === INICIANDO UPLOAD PARA FIREBASE STORAGE ==="),!window.firebase)throw new Error("Firebase não inicializado");let a;try{if(console.log("🔍 Tentando acessar Firebase Storage..."),window.firebase.storage)a=window.firebase.storage(),console.log("✅ Storage acessado via window.firebase.storage()");else if(window.firebase.app&&window.firebase.app().storage)a=window.firebase.app().storage(),console.log("✅ Storage acessado via window.firebase.app().storage()");else throw new Error("Firebase Storage não encontrado")}catch(r){throw console.error("💥 Erro ao acessar Firebase Storage:",r),new Error("Firebase Storage não está configurado corretamente")}const n=new Date().toISOString().replace(/[:.]/g,"-"),i=`vehicle-sheets/${t.countryId}/${t.vehicleData.name||"vehicle"}-${n}.png`;console.log("📁 Nome do arquivo:",i),console.log("💾 Tamanho do blob:",e.size,"bytes");try{console.log("📂 Criando referência do storage...");const r=a.ref(i);console.log("✅ Referência criada:",r.fullPath),console.log("⬆️ Iniciando upload...");const s=await r.put(e,{contentType:"image/png",customMetadata:{vehicleName:t.vehicleData.name||"Unknown",countryId:t.countryId,submissionId:t.vehicleData.submissionId,uploadedAt:new Date().toISOString()}});console.log("✅ Upload concluído:",s.state),console.log("🔗 Obtendo URL de download...");const c=await s.ref.getDownloadURL();return console.log("✅ URL obtida:",c),c}catch(r){throw console.error("💥 Erro durante upload:",r),console.error("🔍 Detalhes do erro:",r.code,r.message),r}}async function V(e){console.log("📝 Gerando ficha em formato texto...");const t=e.vehicleData,a=`
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Ficha Técnica - ${t.name}</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #1e293b; color: white; }
        .header { text-align: center; border-bottom: 2px solid #3b82f6; padding-bottom: 10px; margin-bottom: 20px; }
        .section { margin-bottom: 20px; padding: 15px; background: #334155; border-radius: 8px; }
        .section h3 { color: #3b82f6; margin-top: 0; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .info-row { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px solid #475569; }
    </style>
</head>
<body>
    <div class="header">
        <h1>📋 Ficha Técnica do Veículo</h1>
        <h2>${t.name||"Veículo Experimental"}</h2>
        <p>Submetido para aprovação em ${new Date().toLocaleDateString("pt-BR")}</p>
        <p>País: ${e.countryName} | Quantidade: ${e.quantity} unidades</p>
    </div>
    
    <div class="section">
        <h3>🏗️ Especificações Básicas</h3>
        <div class="info-row"><span>Chassi:</span><span>${t.chassis||"N/A"}</span></div>
        <div class="info-row"><span>Motor:</span><span>${t.engine||"N/A"}</span></div>
        <div class="info-row"><span>Transmissão:</span><span>${t.transmission||"N/A"}</span></div>
        <div class="info-row"><span>Suspensão:</span><span>${t.suspension||"N/A"}</span></div>
    </div>
    
    <div class="section">
        <h3>🔫 Armamento</h3>
        <div class="info-row"><span>Canhão Principal:</span><span>${t.main_gun_caliber||0}mm</span></div>
        <div class="info-row"><span>Blindagem:</span><span>${t.armorThickness||t.armor_thickness||0}mm</span></div>
    </div>
    
    <div class="section">
        <h3>📊 Informações da Submissão</h3>
        <div class="info-row"><span>ID:</span><span>${t.submissionId}</span></div>
        <div class="info-row"><span>Categoria:</span><span>${e.category}</span></div>
        <div class="info-row"><span>Status:</span><span>Pendente de Aprovação</span></div>
    </div>
    
    <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #475569; color: #94a3b8; font-size: 12px;">
        Gerado automaticamente pelo Sistema de Criação de Veículos War1954
    </div>
</body>
</html>
    `,n="data:text/html;charset=utf-8,"+encodeURIComponent(a);return console.log("✅ Ficha em formato HTML gerada como Data URI"),n}window.saveVehicleToFirebase=function(){A('⚠️ Use o botão "Enviar para Aprovação" para submeter o veículo',"error")};
